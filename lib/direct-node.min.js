!function(a){"use strict";function b(a,b){function c(){}c.prototype=a;var d=new c;for(var e in b)d[e]=b[e];return b.toString!==Object.prototype.toString&&(d.toString=b.toString),d}function c(a){return a instanceof Array?function(){return i.iter(a)}:"function"==typeof a.iterator?d(a,a.iterator):a.iterator}function d(a,b){if(null==b)return null;null==b.__id__&&(b.__id__=B++);var c;return null==a.hx__closures__?a.hx__closures__={}:c=a.hx__closures__[b.__id__],null==c&&(c=function(){return c.method.apply(c.scope,arguments)},c.scope=a,c.method=b,a.hx__closures__[b.__id__]=c),c}a.albero=a.albero||{};var e={},f=function(){return w.Boot.__string_rec(this,"")},g=a.DirectAPI=function(){this.eventEmitter=new D,w.Node.require("unorm")};e.DirectAPI=g,g.__name__=["DirectAPI"],g.getInstance=function(){return null==g.instance&&(g.instance=new g),g.instance},g.main=function(){},g.prototype={setOptions:function(a){null!=a?(C.host=a.host,C.endpoint=a.endpoint,C.accessToken=a.access_token,C.proxyURL=a.proxyURL,C.account=a.account,C.$name=a.name,C.storagePath=a.storage_path):x._e(x.dateStr(),"Not enough parameters provided. I need a access token","","","","")},announce:function(a,b){var c,d=a.room;if(null!=d){var e=v.Int64Helper.idStrToInt64(d);if(null==e||null==b)return;var f=this.data.getTalk(e);if(null==f)return;c=f.domainId}else c=v.Int64Helper.idStrToInt64(a.id);null!=c&&this.sendQueue.sendAnnouncement(c,b)},send:function(a,b){var c=a.room,d=v.Int64Helper.idStrToInt64(c);null!=d&&null!=b&&this.sendQueue.sendMessage(d,b)},topic:function(a,b){var c=a.room,d=v.Int64Helper.idStrToInt64(c);this.facade.sendNotification("Talk",v.command.TalkAction.UPDATE(d,null,b))},download:function(a,b,c){var d,e=null,f=null;return"string"==typeof b?d=b:(d=b.url,e=b.path,f=b.name),null==d?void c(null):(null==f&&(f=w.Node.require("path").basename(d)),null==e&&(e=w.Node.require("path").join(w.Node.require("os").tmpdir(),f)),void this.facade.sendNotification("File",v.command.FileAction.DOWNLOAD_PATH(d,e,c)))},leave:function(a,b){var c,d=this,e=a.room,f=v.Int64Helper.idStrToInt64(e);c=null==b?null:v.Int64Helper.idStrToInt64(b.id),z.Timer.delay(function(){d.facade.sendNotification("Talk",v.command.TalkAction.DELETE(f,null,c))},500)},userForId:function(a){return this.hubotObject.userObjectByIdStr(null,a)},userObjects:function(){return this.hubotObject.userObjects(null)},talkObjects:function(){return this.hubotObject.talkObjects()},domainObjects:function(){return this.hubotObject.domainObjects()},parseInt64:function(a){return v.Int64Helper.parse(a)},stringifyInt64:function(a){return a.toString()},listen:function(){this.facade=v.AppFacade.getInstance(),this.api=w.Boot.__cast(this.facade.retrieveProxy("api"),v.proxy.AlberoServiceProxy),this.data=w.Boot.__cast(this.facade.retrieveProxy("dataStore"),v.proxy.DataStoreProxy),this.hubotObject=w.Boot.__cast(this.facade.retrieveProxy("hubotObject"),y.proxy.HubotObjectProxy),this.sendQueue=w.Boot.__cast(this.facade.retrieveProxy("sendQueue"),y.proxy.SendQueueProxy),this.facade.startup()},emit:function(a,b,c,d){this.eventEmitter.emit(a,b,c,d)},on:function(a,b){return this.eventEmitter.on(a,b)},__class__:g};var h=function(a,b){b=b.split("u").join(""),this.r=new RegExp(a,b)};e.EReg=h,h.__name__=["EReg"],h.prototype={match:function(a){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(a),this.r.s=a,null!=this.r.m},matched:function(a){if(null!=this.r.m&&a>=0&&a<this.r.m.length)return this.r.m[a];throw"EReg::matched"},split:function(a){var b="#__delim__#";return a.replace(this.r,b).split(b)},replace:function(a,b){return a.replace(this.r,b)},__class__:h};var i=function(){};e.HxOverrides=i,i.__name__=["HxOverrides"],i.dateStr=function(a){var b=a.getMonth()+1,c=a.getDate(),d=a.getHours(),e=a.getMinutes(),f=a.getSeconds();return a.getFullYear()+"-"+(10>b?"0"+b:""+b)+"-"+(10>c?"0"+c:""+c)+" "+(10>d?"0"+d:""+d)+":"+(10>e?"0"+e:""+e)+":"+(10>f?"0"+f:""+f)},i.strDate=function(a){var b=a.length;switch(b){case 8:var c=a.split(":"),d=new Date;return d.setTime(0),d.setUTCHours(c[0]),d.setUTCMinutes(c[1]),d.setUTCSeconds(c[2]),d;case 10:var e=a.split("-");return new Date(e[0],e[1]-1,e[2],0,0,0);case 19:var f=a.split(" "),g=f[0].split("-"),h=f[1].split(":");return new Date(g[0],g[1]-1,g[2],h[0],h[1],h[2]);default:throw"Invalid date format : "+a}},i.cca=function(a,b){var c=a.charCodeAt(b);return c!=c?void 0:c},i.substr=function(a,b,c){return null!=b&&0!=b&&null!=c&&0>c?"":(null==c&&(c=a.length),0>b?(b=a.length+b,0>b&&(b=0)):0>c&&(c=a.length+c-b),a.substr(b,c))},i.indexOf=function(a,b,c){var d=a.length;for(0>c&&(c+=d,0>c&&(c=0));d>c;){if(a[c]===b)return c;c++}return-1},i.remove=function(a,b){var c=i.indexOf(a,b,0);return-1==c?!1:(a.splice(c,1),!0)},i.iter=function(a){return{cur:0,arr:a,hasNext:function(){return this.cur<this.arr.length},next:function(){return this.arr[this.cur++]}}};var j=function(){};e.Lambda=j,j.__name__=["Lambda"],j.array=function(a){for(var b=new Array,d=c(a)();d.hasNext();){var e=d.next();b.push(e)}return b},j.exists=function(a,b){for(var d=c(a)();d.hasNext();){var e=d.next();if(b(e))return!0}return!1},j.fold=function(a,b,d){for(var e=c(a)();e.hasNext();){var f=e.next();d=b(f,d)}return d},j.count=function(a,b){var d=0;if(null==b)for(var e=c(a)();e.hasNext();){e.next();d++}else for(var f=c(a)();f.hasNext();){var g=f.next();b(g)&&d++}return d},j.find=function(a,b){for(var d=c(a)();d.hasNext();){var e=d.next();if(b(e))return e}return null};var k=function(){this.length=0};e.List=k,k.__name__=["List"],k.prototype={add:function(a){var b=[a];null==this.h?this.h=b:this.q[1]=b,this.q=b,this.length++},isEmpty:function(){return null==this.h},remove:function(a){for(var b=null,c=this.h;null!=c;){if(c[0]==a)return null==b?this.h=c[1]:b[1]=c[1],this.q==c&&(this.q=b),this.length--,!0;b=c,c=c[1]}return!1},iterator:function(){return{h:this.h,hasNext:function(){return null!=this.h},next:function(){if(null==this.h)return null;var a=this.h[0];return this.h=this.h[1],a}}},__class__:k};var l=function(){};e.IMap=l,l.__name__=["IMap"],Math.__name__=["Math"];var m=function(){};e.ObjectHelper=m,m.__name__=["ObjectHelper"],m.deepCopy=function(a){return null==a?null:JSON.parse(JSON.stringify(a))};var n=function(){};e.Reflect=n,n.__name__=["Reflect"],n.field=function(a,b){try{return a[b]}catch(c){return null}},n.setField=function(a,b,c){a[b]=c},n.fields=function(a){var b=[];if(null!=a){var c=Object.prototype.hasOwnProperty;for(var d in a)"__id__"!=d&&"hx__closures__"!=d&&c.call(a,d)&&b.push(d)}return b},n.isFunction=function(a){return"function"==typeof a&&!(a.__name__||a.__ename__)},n.isObject=function(a){if(null==a)return!1;var b=typeof a;return"string"==b||"object"==b&&null==a.__enum__||"function"==b&&null!=(a.__name__||a.__ename__)},n.deleteField=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)?(delete a[b],!0):!1};var o=function(){};e.Std=o,o.__name__=["Std"],o.string=function(a){return w.Boot.__string_rec(a,"")},o["int"]=function(a){return 0|a},o.parseInt=function(a){var b=parseInt(a,10);return 0!=b||120!=i.cca(a,1)&&88!=i.cca(a,1)||(b=parseInt(a)),isNaN(b)?null:b},o.parseFloat=function(a){return parseFloat(a)};var p=function(){this.b=""};e.StringBuf=p,p.__name__=["StringBuf"],p.prototype={add:function(a){this.b+=o.string(a)},toString:function(){return this.b},__class__:p};var q=function(){};e.StringTools=q,q.__name__=["StringTools"],q.urlEncode=function(a){return encodeURIComponent(a)},q.htmlEscape=function(a,b){return a=a.split("&").join("&amp;").split("<").join("&lt;").split(">").join("&gt;"),b?a.split('"').join("&quot;").split("'").join("&#039;"):a},q.startsWith=function(a,b){return a.length>=b.length&&i.substr(a,0,b.length)==b},q.endsWith=function(a,b){var c=b.length,d=a.length;return d>=c&&i.substr(a,d-c,c)==b},q.replace=function(a,b,c){return a.split(b).join(c)},q.hex=function(a,b){var c="",d="0123456789ABCDEF";do c=d.charAt(15&a)+c,a>>>=4;while(a>0);if(null!=b)for(;c.length<b;)c="0"+c;return c},q.fastCodeAt=function(a,b){return a.charCodeAt(b)};var r=function(){};e.TextHelper=r,r.__name__=["TextHelper"],r.slice=function(a,b){for(var c=new Array,d=function(a){for(;a.length>b;)c.push(i.substr(a,0,b)),a=i.substr(a,b,null);a.length>0&&c.push(a)},e="",f=a.split("\n");f.length>0;){var g=f.shift();e.length+g.length>b&&(d(e),e=""),e.length>0&&(e+="\n"),e+=g}return d(e),c};var s=e.ValueType={__ename__:["ValueType"],__constructs__:["TNull","TInt","TFloat","TBool","TObject","TFunction","TClass","TEnum","TUnknown"]};s.TNull=["TNull",0],s.TNull.toString=f,s.TNull.__enum__=s,s.TInt=["TInt",1],s.TInt.toString=f,s.TInt.__enum__=s,s.TFloat=["TFloat",2],s.TFloat.toString=f,s.TFloat.__enum__=s,s.TBool=["TBool",3],s.TBool.toString=f,s.TBool.__enum__=s,s.TObject=["TObject",4],s.TObject.toString=f,s.TObject.__enum__=s,s.TFunction=["TFunction",5],s.TFunction.toString=f,s.TFunction.__enum__=s,s.TClass=function(a){var b=["TClass",6,a];return b.__enum__=s,b.toString=f,b},s.TEnum=function(a){var b=["TEnum",7,a];return b.__enum__=s,b.toString=f,b},s.TUnknown=["TUnknown",8],s.TUnknown.toString=f,s.TUnknown.__enum__=s;var t=function(){};e.Type=t,t.__name__=["Type"],t.getClass=function(a){return null==a?null:a instanceof Array&&null==a.__enum__?Array:a.__class__},t.getClassName=function(a){var b=a.__name__;return b.join(".")},t.getEnumName=function(a){var b=a.__ename__;return b.join(".")},t.resolveClass=function(a){var b=e[a];return null!=b&&b.__name__?b:null},t.resolveEnum=function(a){var b=e[a];return null!=b&&b.__ename__?b:null},t.createInstance=function(a,b){var c=b.length;switch(c){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6]);case 8:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7]);default:throw"Too many arguments"}return null},t.createEmptyInstance=function(a){function b(){}return b.prototype=a.prototype,new b},t.createEnum=function(a,b,c){var d=n.field(a,b);if(null==d)throw"No such constructor "+b;if(n.isFunction(d)){if(null==c)throw"Constructor "+b+" need parameters";return d.apply(a,c)}if(null!=c&&0!=c.length)throw"Constructor "+b+" does not need parameters";return d},t.getEnumConstructs=function(a){var b=a.__constructs__;return b.slice()},t["typeof"]=function(a){var b=typeof a;switch(b){case"boolean":return s.TBool;case"string":return s.TClass(String);case"number":return Math.ceil(a)==a%2147483648?s.TInt:s.TFloat;case"object":if(null==a)return s.TNull;var c=a.__enum__;if(null!=c)return s.TEnum(c);var d;return d=a instanceof Array&&null==a.__enum__?Array:a.__class__,null!=d?s.TClass(d):s.TObject;case"function":return a.__name__||a.__ename__?s.TObject:s.TFunction;case"undefined":return s.TNull;default:return s.TUnknown}},t.enumEq=function(a,b){if(a==b)return!0;try{if(a[0]!=b[0])return!1;for(var c=2,d=a.length;d>c;){var e=c++;if(!t.enumEq(a[e],b[e]))return!1}var f=a.__enum__;if(f!=b.__enum__||null==f)return!1}catch(g){return!1}return!0};var u={};u.interfaces={},u.interfaces.IFacade=function(){},e["puremvc.interfaces.IFacade"]=u.interfaces.IFacade,u.interfaces.IFacade.__name__=["puremvc","interfaces","IFacade"],u.interfaces.IFacade.prototype={__class__:u.interfaces.IFacade},u.patterns={},u.patterns.facade={},u.patterns.facade.Facade=function(){u.patterns.facade.Facade.instance=this,this.initializeFacade()},e["puremvc.patterns.facade.Facade"]=u.patterns.facade.Facade,u.patterns.facade.Facade.__name__=["puremvc","patterns","facade","Facade"],u.patterns.facade.Facade.__interfaces__=[u.interfaces.IFacade],u.patterns.facade.Facade.getInstance=function(){return null==u.patterns.facade.Facade.instance&&(u.patterns.facade.Facade.instance=new u.patterns.facade.Facade),u.patterns.facade.Facade.instance},u.patterns.facade.Facade.prototype={initializeFacade:function(){this.initializeModel(),this.initializeController(),this.initializeView()},initializeController:function(){null==this.controller&&(this.controller=u.core.Controller.getInstance())},initializeModel:function(){null==this.model&&(this.model=u.core.Model.getInstance())},initializeView:function(){null==this.view&&(this.view=u.core.View.getInstance())},registerCommand:function(a,b){this.controller.registerCommand(a,b)},removeCommand:function(a){this.controller.removeCommand(a)},hasCommand:function(a){return this.controller.hasCommand(a)},registerProxy:function(a){this.model.registerProxy(a)},retrieveProxy:function(a){return this.model.retrieveProxy(a)},removeProxy:function(a){var b=null;return null!=this.model&&(b=this.model.removeProxy(a)),b},hasProxy:function(a){return this.model.hasProxy(a)},registerMediator:function(a){null!=this.view&&this.view.registerMediator(a)},retrieveMediator:function(a){return this.view.retrieveMediator(a)},removeMediator:function(a){var b=null;return null!=this.view&&(b=this.view.removeMediator(a)),b},hasMediator:function(a){return this.view.hasMediator(a)},sendNotification:function(a,b,c){this.notifyObservers(new u.patterns.observer.Notification(a,b,c))},notifyObservers:function(a){null!=this.view&&this.view.notifyObservers(a)},__class__:u.patterns.facade.Facade};var v={};v.AppFacade=function(){u.patterns.facade.Facade.call(this)},e["albero.AppFacade"]=v.AppFacade,v.AppFacade.__name__=["albero","AppFacade"],v.AppFacade.getInstance=function(){return null==u.patterns.facade.Facade.instance&&(u.patterns.facade.Facade.instance=new v.AppFacade),w.Boot.__cast(u.patterns.facade.Facade.instance,v.AppFacade)},v.AppFacade.__super__=u.patterns.facade.Facade,v.AppFacade.prototype=b(u.patterns.facade.Facade.prototype,{initializeModel:function(){u.patterns.facade.Facade.prototype.initializeModel.call(this);var a=[new y.proxy.HubotObjectProxy,new y.proxy.SendQueueProxy,new y.proxy.MessageEventProxy,new v.proxy.AppStateProxy,new v.proxy.DataStoreProxy,new v.proxy.SettingsProxy,new v.proxy.MsgPackRpcProxy,new v.proxy.AlberoBroadcastProxy,new v.proxy.AlberoServiceProxy,new v.proxy.FileServiceProxy,new v.proxy.FormatterProxy,new v.proxy.RoutingProxy,new v.proxy.StagedFileInfoStoreProxy,new v.proxy.SearchServiceProxy];a.push(v.proxy.AccountLoaderProxyFactory.newInstance());for(var b=0;b<a.length;){var c=a[b];++b,this.registerProxy(c)}for(var d=0;d<a.length;){var e=a[d];++d,this.autoBind(e)}},initializeView:function(){u.patterns.facade.Facade.prototype.initializeView.call(this);for(var a=[new y.mediator.CommandLineMediator],b=0;b<a.length;){var c=a[b];++b,this.registerMediator(c)}},initializeController:function(){u.patterns.facade.Facade.prototype.initializeController.call(this);for(var a=[v.command.DomainCommand,v.command.SignInCommand,v.command.SignOutCommand,v.command.ReloadDataCommand,v.command.SendCommand,v.command.TalkCommand,v.command.ManageFriendsCommand,v.command.ReadCommand,v.command.LoadStampSetCommand,v.command.LoadSolutionsCommand,v.command.FileCommand,v.command.SelectTalkCommand,v.command.UpdateUserCommand,v.command.UpdateProfileCommand,v.command.UrlCommand,v.command.SearchCommand,v.command.AccountControlRequestCommand,v.command.DeviceCommand],b=0;b<a.length;){var c=a[b];++b;var d=q.replace(t.getClassName(c).split(".").pop(),"Command","");this.registerCommand(d,c)}},registerMediator:function(a){this.autoBind(a),u.patterns.facade.Facade.prototype.registerMediator.call(this,a)},autoBind:function(a){for(var b=z.rtti.Meta.getFields(t.getClass(a)),c=0,d=n.fields(b);c<d.length;){var e=d[c];++c;var f=n.field(b,e);if(Object.prototype.hasOwnProperty.call(f,"inject")){var g=this.retrieveProxy(e);null==g||(a[e]=g)}}},startup:function(){w.Boot.__cast(this.retrieveProxy("appState"),v.proxy.AppStateProxy).start()},__class__:v.AppFacade}),v.AppState=e["albero.AppState"]={__ename__:["albero","AppState"],__constructs__:["Active","Inactive"]},v.AppState.Active=["Active",0],v.AppState.Active.toString=f,v.AppState.Active.__enum__=v.AppState,v.AppState.Inactive=["Inactive",1],v.AppState.Inactive.toString=f,v.AppState.Inactive.__enum__=v.AppState,v.ConnectionStatus=e["albero.ConnectionStatus"]={__ename__:["albero","ConnectionStatus"],__constructs__:["Ok","Error","ConcurrentAccessError","ForcibliyClosedError"]},v.ConnectionStatus.Ok=["Ok",0],v.ConnectionStatus.Ok.toString=f,v.ConnectionStatus.Ok.__enum__=v.ConnectionStatus,v.ConnectionStatus.Error=["Error",1],v.ConnectionStatus.Error.toString=f,v.ConnectionStatus.Error.__enum__=v.ConnectionStatus,v.ConnectionStatus.ConcurrentAccessError=["ConcurrentAccessError",2],v.ConnectionStatus.ConcurrentAccessError.toString=f,v.ConnectionStatus.ConcurrentAccessError.__enum__=v.ConnectionStatus,v.ConnectionStatus.ForcibliyClosedError=["ForcibliyClosedError",3],v.ConnectionStatus.ForcibliyClosedError.toString=f,v.ConnectionStatus.ForcibliyClosedError.__enum__=v.ConnectionStatus,v.DateHelper=function(){},e["albero.DateHelper"]=v.DateHelper,v.DateHelper.__name__=["albero","DateHelper"],v.DateHelper.isSameDate=function(a,b){return a.getFullYear()==b.getFullYear()&&a.getMonth()==b.getMonth()&&a.getDate()==b.getDate()},v.DateHelper.dateString=function(a,b){var c=new Date,d="";return a.getFullYear()!=c.getFullYear()&&(d+=a.getFullYear()+"/"),d+=a.getMonth()+1+"/"+a.getDate(),b&&(d+=" ("+v.DateHelper.dayOfWeekString(a)+")"),d},v.DateHelper.dayOfWeekString=function(a){var b=a.getDay();switch(b){case 0:return"日";case 1:return"月";case 2:return"火";case 3:return"水";case 4:return"木";case 5:return"金";default:return"土"}},v.DateHelper.getDateStringForFile=function(){var a=new Date,b=a.getFullYear(),c=v.DateHelper.toDoubleDigits(a.getMonth()+1),d=v.DateHelper.toDoubleDigits(a.getDate()),e=v.DateHelper.toDoubleDigits(a.getHours()),f=v.DateHelper.toDoubleDigits(a.getMinutes()),g=v.DateHelper.toDoubleDigits(a.getSeconds());return b+c+d+"_"+e+f+g},v.DateHelper.getTimeStringForVoice=function(a){var b=v.DateHelper.toDoubleDigits(a/60|0),c=v.DateHelper.toDoubleDigits((0|a)%60);return b+":"+c},v.DateHelper.toDoubleDigits=function(a){var b;return b=null==a?"null":""+a,1==b.length&&(b="0"+b),b},v.DateHelper.nowAsInt64=function(){return v.DateHelper.dateAsInt64((new Date).getTime())},v.DateHelper.oneDayAfterAsInt64=function(){return v.DateHelper.dateAsInt64((new Date).getTime()+864e5)},v.DateHelper.dateAsInt64=function(a){var b=4294967296;return new z.Int64(a/b|0,a%b|0)},v.History=function(){},e["albero.History"]=v.History,v.History.__name__=["albero","History"],v.History.replaceState=function(a,b,c){return null!=window.history?(window.history.replaceState(a,b,c),!0):!1},v.Int64Helper=function(){},e["albero.Int64Helper"]=v.Int64Helper,v.Int64Helper.__name__=["albero","Int64Helper"],v.Int64Helper.parse=function(a){var b=new h("^\\d+$","");if(!b.match(a))return null;for(var c=new z.Int64(0,0),d=new z.Int64(0,10),e=0,f=a.length;f>e;){var g=e++;c=z.Int64.add(z.Int64.mul(c,d),z.Int64.make(0,o.parseInt(a.charAt(g))))}return c},v.Int64Helper.getHigh=function(a){return a.high},v.Int64Helper.getLow=function(a){return a.low},v.Int64Helper.idStr=function(a){return"_"+a.high+"_"+a.low},v.Int64Helper.makeFromIdStr=function(a){var b=new h("^_(-?\\d*)_(-?\\d*)$","");return b.match(a)?z.Int64.make(o.parseInt(b.matched(1)),o.parseInt(b.matched(2))):null},v.Int64Helper.eq=function(a,b){return null!=a&&null!=b&&a.high==b.high&&a.low==b.low},v.Int64Helper.toFloat=function(a){var b=4294967296,c=a.high,d=a.low;return c*b+(d>=0?d:d+b)},v.Int64Helper.idStrToInt64=function(a){var b=a.split("_");return b.length>2?z.Int64.make(o.parseInt(b[1]),o.parseInt(b[2])):null},v.Int64Helper.decrement=function(a){return null==a?null:z.Int64.sub(a,new z.Int64(0,1))},v.Int64Helper.increment=function(a){return null==a?null:z.Int64.add(a,new z.Int64(0,1))},v.Int64Helper.contains=function(a,b){if(null==a)return!1;for(var c=0;c<a.length;){var d=a[c];if(++c,null!=d&&null!=b&&d.high==b.high&&d.low==b.low)return!0}return!1},v.Int64Helper.remove=function(a,b){if(null==a)return!1;for(var c=0;c<a.length;){var d=a[c];if(++c,null!=d&&null!=b&&d.high==b.high&&d.low==b.low)return i.remove(a,d),!0}return!1},v.StorageHelper=function(){},e["albero.StorageHelper"]=v.StorageHelper,v.StorageHelper.__name__=["albero","StorageHelper"],v.StorageHelper.getItemAsJson=function(a){var b=v.StorageHelper.getItem(a);if(null==b)return null;try{return JSON.parse(b)}catch(c){return null}},v.StorageHelper.getItemAsInt=function(a){var b=v.StorageHelper.getItem(a);return null==b?null:o.parseInt(b)},v.StorageHelper.getItem=function(a){var b=v.js.LocalStorage.getLocalStorage();return null!=b?b.getItem(a):(x._e(x.dateStr(),"storage not found","","","",""),null)},v.StorageHelper.removeItem=function(a){var b=v.js.LocalStorage.getLocalStorage();null==b?x._e(x.dateStr(),"storage not found","","","",""):b.removeItem(a)},v.StorageHelper.setItem=function(a,b){var c=v.js.LocalStorage.getLocalStorage();null==c?x._e(x.dateStr(),"storage not found","","","",""):c.setItem(a,b)},v.StringHelper=function(){},e["albero.StringHelper"]=v.StringHelper,v.StringHelper.__name__=["albero","StringHelper"],v.StringHelper.trim=function(a){return a.trim()},v.StringHelper.compare=function(a,b){return a>b?1:b>a?-1:0},v.StringHelper.isEmtpy=function(a){return null==a||0==a.length},v.StringHelper.randomString=function(){var a=new p,b=8;for(a.add(q.hex(o["int"]((new Date).getTime()),8));b++<36;)a.add(0!=(51*b&52)?q.hex(0!=(15^b)?8^o["int"](Math.random()*(0!=(20^b)?16:4)):4):"-");return a.b.toLowerCase()},v.Urls=e["albero.Urls"]={__ename__:["albero","Urls"],__constructs__:["auto","domains","domain","members","talks","actions","console","settings","announcements","error","loading","environment"]},v.Urls.auto=["auto",0],v.Urls.auto.toString=f,v.Urls.auto.__enum__=v.Urls,v.Urls.domains=["domains",1],v.Urls.domains.toString=f,v.Urls.domains.__enum__=v.Urls,v.Urls.domain=function(a){var b=["domain",2,a];return b.__enum__=v.Urls,b.toString=f,b},v.Urls.members=function(a){var b=["members",3,a];return b.__enum__=v.Urls,b.toString=f,b},v.Urls.talks=function(a){var b=["talks",4,a];return b.__enum__=v.Urls,b.toString=f,b},v.Urls.actions=function(a){var b=["actions",5,a];return b.__enum__=v.Urls,b.toString=f,b},v.Urls.console=function(a){var b=["console",6,a];return b.__enum__=v.Urls,b.toString=f,b},v.Urls.settings=function(a){var b=["settings",7,a];return b.__enum__=v.Urls,b.toString=f,b},v.Urls.announcements=["announcements",8],v.Urls.announcements.toString=f,v.Urls.announcements.__enum__=v.Urls,v.Urls.error=["error",9],v.Urls.error.toString=f,v.Urls.error.__enum__=v.Urls,v.Urls.loading=["loading",10],v.Urls.loading.toString=f,v.Urls.loading.__enum__=v.Urls,v.Urls.environment=function(a){var b=["environment",11,a];return b.__enum__=v.Urls,b.toString=f,b},u.interfaces.INotifier=function(){},e["puremvc.interfaces.INotifier"]=u.interfaces.INotifier,u.interfaces.INotifier.__name__=["puremvc","interfaces","INotifier"],u.interfaces.INotifier.prototype={__class__:u.interfaces.INotifier},u.patterns.observer={},u.patterns.observer.Notifier=function(){this.facade=u.patterns.facade.Facade.getInstance()},e["puremvc.patterns.observer.Notifier"]=u.patterns.observer.Notifier,u.patterns.observer.Notifier.__name__=["puremvc","patterns","observer","Notifier"],u.patterns.observer.Notifier.__interfaces__=[u.interfaces.INotifier],u.patterns.observer.Notifier.prototype={sendNotification:function(a,b,c){this.facade.sendNotification(a,b,c)},__class__:u.patterns.observer.Notifier},u.interfaces.ICommand=function(){},e["puremvc.interfaces.ICommand"]=u.interfaces.ICommand,u.interfaces.ICommand.__name__=["puremvc","interfaces","ICommand"],u.interfaces.ICommand.prototype={__class__:u.interfaces.ICommand},u.patterns.command={},u.patterns.command.SimpleCommand=function(){u.patterns.observer.Notifier.call(this)},e["puremvc.patterns.command.SimpleCommand"]=u.patterns.command.SimpleCommand,u.patterns.command.SimpleCommand.__name__=["puremvc","patterns","command","SimpleCommand"],u.patterns.command.SimpleCommand.__interfaces__=[u.interfaces.ICommand],u.patterns.command.SimpleCommand.__super__=u.patterns.observer.Notifier,u.patterns.command.SimpleCommand.prototype=b(u.patterns.observer.Notifier.prototype,{execute:function(a){},__class__:u.patterns.command.SimpleCommand}),v.command={},v.command.AutoBindCommand=function(){u.patterns.command.SimpleCommand.call(this),v.AppFacade.getInstance().autoBind(this)},e["albero.command.AutoBindCommand"]=v.command.AutoBindCommand,v.command.AutoBindCommand.__name__=["albero","command","AutoBindCommand"],v.command.AutoBindCommand.__super__=u.patterns.command.SimpleCommand,v.command.AutoBindCommand.prototype=b(u.patterns.command.SimpleCommand.prototype,{__class__:v.command.AutoBindCommand}),v.command.AccountControlRequestCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.AccountControlRequestCommand"]=v.command.AccountControlRequestCommand,v.command.AccountControlRequestCommand.__name__=["albero","command","AccountControlRequestCommand"],v.command.AccountControlRequestCommand.__super__=v.command.AutoBindCommand,v.command.AccountControlRequestCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=a.getBody();switch(b[1]){case 0:var c=b[2];this.api.acceptAccountControlRequest(c);break;case 1:var d=b[2];this.api.rejectAccountControlRequest(d)}},__class__:v.command.AccountControlRequestCommand}),v.command.AccountControlRequestAction=e["albero.command.AccountControlRequestAction"]={__ename__:["albero","command","AccountControlRequestAction"],__constructs__:["ACCEPT_REQUEST","REJECT_REQUEST"]},v.command.AccountControlRequestAction.ACCEPT_REQUEST=function(a){var b=["ACCEPT_REQUEST",0,a];return b.__enum__=v.command.AccountControlRequestAction,b.toString=f,b},v.command.AccountControlRequestAction.REJECT_REQUEST=function(a){var b=["REJECT_REQUEST",1,a];return b.__enum__=v.command.AccountControlRequestAction,b.toString=f,b},v.command.DeviceCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.DeviceCommand"]=v.command.DeviceCommand,v.command.DeviceCommand.__name__=["albero","command","DeviceCommand"],v.command.DeviceCommand.__super__=v.command.AutoBindCommand,v.command.DeviceCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=this,c=(a.getBody(),w.Node.require("read"));c({prompt:"Code: "},function(a,c){b.api.authorizeDevice(c,function(){b.sendNotification("SignIn")})})},__class__:v.command.DeviceCommand}),v.command.DeviceAction=e["albero.command.DeviceAction"]={__ename__:["albero","command","DeviceAction"],__constructs__:["AUTHORIZE"]},v.command.DeviceAction.AUTHORIZE=["AUTHORIZE",0],v.command.DeviceAction.AUTHORIZE.toString=f,v.command.DeviceAction.AUTHORIZE.__enum__=v.command.DeviceAction,v.command.DomainCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.DomainCommand"]=v.command.DomainCommand,v.command.DomainCommand.__name__=["albero","command","DomainCommand"],v.command.DomainCommand.__super__=v.command.AutoBindCommand,v.command.DomainCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=a.getBody();switch(b[1]){case 0:var c=b[2];this.api.acceptDomainInvite(c);break;case 1:var d=b[2];this.api.deleteDomainInvite(d);break;case 2:var e=b[2];this.api.leaveDomain(e)}},__class__:v.command.DomainCommand}),v.command.DomainAction=e["albero.command.DomainAction"]={__ename__:["albero","command","DomainAction"],__constructs__:["ACCEPT_INVITE","DELETE_INVITE","LEAVE"]},v.command.DomainAction.ACCEPT_INVITE=function(a){var b=["ACCEPT_INVITE",0,a];return b.__enum__=v.command.DomainAction,b.toString=f,b},v.command.DomainAction.DELETE_INVITE=function(a){var b=["DELETE_INVITE",1,a];return b.__enum__=v.command.DomainAction,b.toString=f,b},v.command.DomainAction.LEAVE=function(a){var b=["LEAVE",2,a];return b.__enum__=v.command.DomainAction,b.toString=f,b},v.command.FileCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.FileCommand"]=v.command.FileCommand,v.command.FileCommand.__name__=["albero","command","FileCommand"],v.command.FileCommand.__super__=v.command.AutoBindCommand,v.command.FileCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=a.getBody();switch(b[1]){case 0:var c=b[3],d=b[2];this.api.upload(d.domainId,d.id,c);break;case 1:var e=b[4],f=b[3],g=b[2];this.api.uploadMulti(g.domainId,g.id,f,e);break;case 2:var h=b[2];this.api.deleteAttachment(h.id,h.messageId);break;case 3:var i=b[6],j=b[5],k=b[4],l=b[3],m=b[2],n=this.fileService.createDummyFile(l,k,j),o=this.dataStore.getTalk(m);this.api.upload(o.domainId,o.id,n,i);break;case 4:for(var p=b[7],q=b[6],r=b[5],s=b[4],t=b[3],u=b[2],v=[],w=0,x=s.length;x>w;){var y=w++;v.push(this.fileService.createDummyFile(s[y],r[y],q[y]))}var z=this.dataStore.getTalk(u);this.api.uploadMulti(z.domainId,z.id,t,v,p);break;case 5:var A=b[4],B=b[3],C=b[2];this.fileService.download(C,B,A)}},__class__:v.command.FileCommand}),v.command.FileAction=e["albero.command.FileAction"]={__ename__:["albero","command","FileAction"],__constructs__:["UPLOAD","UPLOAD_MULTI","DELETE","UPLOAD_PATH","UPLOAD_MULTI_PATH","DOWNLOAD_PATH"]},v.command.FileAction.UPLOAD=function(a,b){var c=["UPLOAD",0,a,b];return c.__enum__=v.command.FileAction,c.toString=f,c},v.command.FileAction.UPLOAD_MULTI=function(a,b,c){var d=["UPLOAD_MULTI",1,a,b,c];return d.__enum__=v.command.FileAction,d.toString=f,d},v.command.FileAction.DELETE=function(a){var b=["DELETE",2,a];return b.__enum__=v.command.FileAction,b.toString=f,b},v.command.FileAction.UPLOAD_PATH=function(a,b,c,d,e){var g=["UPLOAD_PATH",3,a,b,c,d,e];return g.__enum__=v.command.FileAction,g.toString=f,g},v.command.FileAction.UPLOAD_MULTI_PATH=function(a,b,c,d,e,g){var h=["UPLOAD_MULTI_PATH",4,a,b,c,d,e,g];return h.__enum__=v.command.FileAction,h.toString=f,h},v.command.FileAction.DOWNLOAD_PATH=function(a,b,c){var d=["DOWNLOAD_PATH",5,a,b,c];return d.__enum__=v.command.FileAction,d.toString=f,d},v.command.LoadSolutionsCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.LoadSolutionsCommand"]=v.command.LoadSolutionsCommand,v.command.LoadSolutionsCommand.__name__=["albero","command","LoadSolutionsCommand"],v.command.LoadSolutionsCommand.__super__=v.command.AutoBindCommand,v.command.LoadSolutionsCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){},__class__:v.command.LoadSolutionsCommand}),v.command.LoadStampSetCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.LoadStampSetCommand"]=v.command.LoadStampSetCommand,v.command.LoadStampSetCommand.__name__=["albero","command","LoadStampSetCommand"],v.command.LoadStampSetCommand.__super__=v.command.AutoBindCommand,v.command.LoadStampSetCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){new Array},__class__:v.command.LoadStampSetCommand}),v.command.ManageFriendsCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.ManageFriendsCommand"]=v.command.ManageFriendsCommand,v.command.ManageFriendsCommand.__name__=["albero","command","ManageFriendsCommand"],v.command.ManageFriendsCommand.__super__=v.command.AutoBindCommand,v.command.ManageFriendsCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=a.getBody(),c=b.action;switch(c[1]){case 0:for(var d=0,e=b.users;d<e.length;){var f=e[d];++d,this.api.addFriend(f)}break;case 1:for(var g=0,h=b.users;g<h.length;){var i=h[g];++g,this.api.deleteFriend(i)}}},__class__:v.command.ManageFriendsCommand}),v.command.ManageFriendsAction=e["albero.command.ManageFriendsAction"]={__ename__:["albero","command","ManageFriendsAction"],__constructs__:["ADD","DELETE"]},v.command.ManageFriendsAction.ADD=["ADD",0],v.command.ManageFriendsAction.ADD.toString=f,v.command.ManageFriendsAction.ADD.__enum__=v.command.ManageFriendsAction,v.command.ManageFriendsAction.DELETE=["DELETE",1],v.command.ManageFriendsAction.DELETE.toString=f,v.command.ManageFriendsAction.DELETE.__enum__=v.command.ManageFriendsAction,v.command.ReadCommand=function(){v.command.AutoBindCommand.call(this)},
e["albero.command.ReadCommand"]=v.command.ReadCommand,v.command.ReadCommand.__name__=["albero","command","ReadCommand"],v.command.ReadCommand.__super__=v.command.AutoBindCommand,v.command.ReadCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=a.getBody();switch(b[1]){case 0:var c=b[3],d=b[2];this.api.updateReadStatuses(d,c);break;case 1:var e=b[2];this.api.updateAnnouncementReadStatus(e);break;case 2:var f=b[3],g=b[2];this.api.getReadStatus(g,f)}},__class__:v.command.ReadCommand}),v.command.ReadType=e["albero.command.ReadType"]={__ename__:["albero","command","ReadType"],__constructs__:["TALK","ANNOUNCEMENT","READ_STATUS"]},v.command.ReadType.TALK=function(a,b){var c=["TALK",0,a,b];return c.__enum__=v.command.ReadType,c.toString=f,c},v.command.ReadType.ANNOUNCEMENT=function(a){var b=["ANNOUNCEMENT",1,a];return b.__enum__=v.command.ReadType,b.toString=f,b},v.command.ReadType.READ_STATUS=function(a,b){var c=["READ_STATUS",2,a,b];return c.__enum__=v.command.ReadType,c.toString=f,c},v.command.ReloadDataCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.ReloadDataCommand"]=v.command.ReloadDataCommand,v.command.ReloadDataCommand.__name__=["albero","command","ReloadDataCommand"],v.command.ReloadDataCommand.__super__=v.command.AutoBindCommand,v.command.ReloadDataCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=a.getBody();switch(b[1]){case 0:this.api.getDomains();break;case 1:this.api.getFriends(),this.api.getAcquaintances();break;case 2:this.api.getTalks();break;case 3:var c=b[4],d=b[3],e=b[2];this.api.getMessages(e,d,c);break;case 4:var f=b[2];this.api.getAllUsers(f);break;case 5:var g=b[3],h=b[2];this.api.getUsers(h,g);break;case 6:var i=b[3],j=b[2];this.api.getProfile(j,i);break;case 7:var k=b[3],l=b[2];this.api.searchDomainUsers(l,k);break;case 8:var m=b[2];this.api.getAnnouncements(m);break;case 9:var n=b[5],o=b[4],p=b[3],q=b[2];this.api.getQuestions(q,p,o,n);break;case 10:var r=b[3],s=b[2];this.api.getQuestion(s,r);break;case 11:var t=b[3],u=b[2];this.api.getAttachments(u,t)}},__class__:v.command.ReloadDataCommand}),v.command.ReloadDataType=e["albero.command.ReloadDataType"]={__ename__:["albero","command","ReloadDataType"],__constructs__:["Domains","Friends","Talks","Messages","AllUsers","GetUsers","GetProfile","SearchDomainUsers","Announcements","Questions","Question","Files"]},v.command.ReloadDataType.Domains=["Domains",0],v.command.ReloadDataType.Domains.toString=f,v.command.ReloadDataType.Domains.__enum__=v.command.ReloadDataType,v.command.ReloadDataType.Friends=["Friends",1],v.command.ReloadDataType.Friends.toString=f,v.command.ReloadDataType.Friends.__enum__=v.command.ReloadDataType,v.command.ReloadDataType.Talks=["Talks",2],v.command.ReloadDataType.Talks.toString=f,v.command.ReloadDataType.Talks.__enum__=v.command.ReloadDataType,v.command.ReloadDataType.Messages=function(a,b,c){var d=["Messages",3,a,b,c];return d.__enum__=v.command.ReloadDataType,d.toString=f,d},v.command.ReloadDataType.AllUsers=function(a){var b=["AllUsers",4,a];return b.__enum__=v.command.ReloadDataType,b.toString=f,b},v.command.ReloadDataType.GetUsers=function(a,b){var c=["GetUsers",5,a,b];return c.__enum__=v.command.ReloadDataType,c.toString=f,c},v.command.ReloadDataType.GetProfile=function(a,b){var c=["GetProfile",6,a,b];return c.__enum__=v.command.ReloadDataType,c.toString=f,c},v.command.ReloadDataType.SearchDomainUsers=function(a,b){var c=["SearchDomainUsers",7,a,b];return c.__enum__=v.command.ReloadDataType,c.toString=f,c},v.command.ReloadDataType.Announcements=function(a){var b=["Announcements",8,a];return b.__enum__=v.command.ReloadDataType,b.toString=f,b},v.command.ReloadDataType.Questions=function(a,b,c,d){var e=["Questions",9,a,b,c,d];return e.__enum__=v.command.ReloadDataType,e.toString=f,e},v.command.ReloadDataType.Question=function(a,b){var c=["Question",10,a,b];return c.__enum__=v.command.ReloadDataType,c.toString=f,c},v.command.ReloadDataType.Files=function(a,b){var c=["Files",11,a,b];return c.__enum__=v.command.ReloadDataType,c.toString=f,c},v.command.SearchCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.SearchCommand"]=v.command.SearchCommand,v.command.SearchCommand.__name__=["albero","command","SearchCommand"],v.command.SearchCommand.__super__=v.command.AutoBindCommand,v.command.SearchCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=a.getBody();switch(b[1]){case 0:var c=b[4],d=b[3],e=b[2];this.searchService.isSearching()||(null==c&&this.searchService.saveParams(e),this.api.search(e.copy(),d,c));break;case 1:this.searchService.clearEditingParams(),this.searchService.clearRecentParams(),this.searchService.clearSearching(),this.sendNotification("notify_search_clear",{})}},__class__:v.command.SearchCommand}),v.command.SearchAction=e["albero.command.SearchAction"]={__ename__:["albero","command","SearchAction"],__constructs__:["SEARCH","CLEAR"]},v.command.SearchAction.SEARCH=function(a,b,c){var d=["SEARCH",0,a,b,c];return d.__enum__=v.command.SearchAction,d.toString=f,d},v.command.SearchAction.CLEAR=["CLEAR",1],v.command.SearchAction.CLEAR.toString=f,v.command.SearchAction.CLEAR.__enum__=v.command.SearchAction,v.command.SelectTalkCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.SelectTalkCommand"]=v.command.SelectTalkCommand,v.command.SelectTalkCommand.__name__=["albero","command","SelectTalkCommand"],v.command.SelectTalkCommand.__super__=v.command.AutoBindCommand,v.command.SelectTalkCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=a.getBody();this.settings.setSelectedTalk(b)},__class__:v.command.SelectTalkCommand}),v.command.SendCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.SendCommand"]=v.command.SendCommand,v.command.SendCommand.__name__=["albero","command","SendCommand"],v.command.SendCommand.__super__=v.command.AutoBindCommand,v.command.SendCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b,c=a.getBody();b=null!=c.id?v.Int64Helper.idStr(c.id):null,null!=c.talkId?this.api.createMessage(c.talkId,c.type,c.content,b):this.api.createAnnouncement(c.domainId,c.type,c.content,b)},__class__:v.command.SendCommand}),v.command.SignInCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.SignInCommand"]=v.command.SignInCommand,v.command.SignInCommand.__name__=["albero","command","SignInCommand"],v.command.SignInCommand.__super__=v.command.AutoBindCommand,v.command.SignInCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=this.settings.getAccessToken();if(null!=b)return void this.api.createSession(b);var c;c=null!=C.account?C.account.split(":"):null,null!=c&&2==c.length&&this.api.createAccessToken(c[0],c[1]);var d=a.getBody();null==d&&(d=this.accountLoader.load()),null!=d&&(null!=d.accessToken?(this.settings.setAccessToken(d.accessToken),this.api.createSession(d.accessToken)):this.api.createAccessToken(d.email,d.pass))},__class__:v.command.SignInCommand}),v.command.SignOutCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.SignOutCommand"]=v.command.SignOutCommand,v.command.SignOutCommand.__name__=["albero","command","SignOutCommand"],v.command.SignOutCommand.__super__=v.command.AutoBindCommand,v.command.SignOutCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){this.api.deleteSession(),this.settings.clearInputTextForAll(),this.dataStore.clear(!0),x._e(x.dateStr(),"signout","","","",""),w.Node.process.exit(1)},__class__:v.command.SignOutCommand}),v.command.TalkCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.TalkCommand"]=v.command.TalkCommand,v.command.TalkCommand.__name__=["albero","command","TalkCommand"],v.command.TalkCommand.__super__=v.command.AutoBindCommand,v.command.TalkCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=a.getBody();switch(b[1]){case 0:var c,d=b[3],e=b[2];c=1!=d.length?null:this.dataStore.getValidPairTalk(d[0],e),null!=c?this.sendNotification("SelectTalk",c):this.api.createTalk(e,d);break;case 1:var f=b[3],g=b[2];this.api.addTalkers(g,f);break;case 2:var h=b[4],i=b[3],j=b[2];null==i&&(i=this.dataStore.getTalk(j)),null==h&&(h=this.dataStore.me.id),this.api.deleteTalker(i,h);break;case 3:var k=b[6],l=b[5],m=b[4],n=b[3],o=b[2];null==n&&(n=this.dataStore.getTalk(o)),this.api.updateGroupTalk(n,m,l,k)}},__class__:v.command.TalkCommand}),v.command.TalkAction=e["albero.command.TalkAction"]={__ename__:["albero","command","TalkAction"],__constructs__:["NEW","ADD","DELETE","UPDATE"]},v.command.TalkAction.NEW=function(a,b){var c=["NEW",0,a,b];return c.__enum__=v.command.TalkAction,c.toString=f,c},v.command.TalkAction.ADD=function(a,b){var c=["ADD",1,a,b];return c.__enum__=v.command.TalkAction,c.toString=f,c},v.command.TalkAction.DELETE=function(a,b,c){var d=["DELETE",2,a,b,c];return d.__enum__=v.command.TalkAction,d.toString=f,d},v.command.TalkAction.UPDATE=function(a,b,c,d,e){var g=["UPDATE",3,a,b,c,d,e];return g.__enum__=v.command.TalkAction,g.toString=f,g},v.command.UpdateProfileCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.UpdateProfileCommand"]=v.command.UpdateProfileCommand,v.command.UpdateProfileCommand.__name__=["albero","command","UpdateProfileCommand"],v.command.UpdateProfileCommand.__super__=v.command.AutoBindCommand,v.command.UpdateProfileCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=a.getBody().domainId,c=a.getBody().profileItemValues,d=a.getBody().copyToAllDomains,e=this.dataStore.getDomain(b);if(null!=e&&null!=e.profileDefinition.itemDefinitions){var f=new Array;if(d){for(var g=new Array,h=0;h<c.length;){var j=c[h];++h;var k=v.entity.ProfileItemDefinition.findById(e.profileDefinition.itemDefinitions,j.profileItemId);null!=k&&g.push({name:k.name,value:j.value})}for(var l=0,m=this.dataStore.getDomains();l<m.length;){var n=m[l];if(++l,!n.domainInfo.frozen){for(var o=new Array,p=0,q=n.profileDefinition.itemDefinitions;p<q.length;){var r=q[p];if(++p,r.visible&&!r.locked)for(var s=0;s<g.length;){var t=g[s];if(++s,t.name==r.name){var u=new v.entity.ProfileItemValue;u.profileItemId=r.profileItemId,u.value=t.value,o.push(u);break}}}o.length>0&&f.push({domainId:n.id,profileItemValues:o})}}}else{for(var w=new Array,x=(i.iter(c),0);x<c.length;){var y=c[x];++x;var z=v.entity.ProfileItemDefinition.findById(e.profileDefinition.itemDefinitions,y.profileItemId);null!=z&&z.visible&&!z.locked&&w.push(y)}w.length>0&&f.push({domainId:e.id,profileItemValues:w})}0==f.length?this.sendNotification("update_profile_responsed",this.dataStore.me):this.api.updateProfile(f)}},__class__:v.command.UpdateProfileCommand}),v.command.UpdateUserCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.UpdateUserCommand"]=v.command.UpdateUserCommand,v.command.UpdateUserCommand.__name__=["albero","command","UpdateUserCommand"],v.command.UpdateUserCommand.__super__=v.command.AutoBindCommand,v.command.UpdateUserCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=a.getBody();(null==b.profileImage||q.startsWith(b.profileImage.type,"image/"))&&this.api.updateUser(b.displayName,b.profileImage,b.profileImageUrl,b.phoneticDisplayName,b.status)},__class__:v.command.UpdateUserCommand}),v.command.UrlCommand=function(){v.command.AutoBindCommand.call(this)},e["albero.command.UrlCommand"]=v.command.UrlCommand,v.command.UrlCommand.__name__=["albero","command","UrlCommand"],v.command.UrlCommand.__super__=v.command.AutoBindCommand,v.command.UrlCommand.prototype=b(v.command.AutoBindCommand.prototype,{execute:function(a){var b=a.getBody();switch(b[1]){case 0:var c=b[2];this.routing.forward(c);break;case 1:var d=b[2];this.routing.redirect(d);break;case 2:this.routing.back()}},__class__:v.command.UrlCommand}),v.command.UrlAction=e["albero.command.UrlAction"]={__ename__:["albero","command","UrlAction"],__constructs__:["FORWARD","REDIRECT","BACK"]},v.command.UrlAction.FORWARD=function(a){var b=["FORWARD",0,a];return b.__enum__=v.command.UrlAction,b.toString=f,b},v.command.UrlAction.REDIRECT=function(a){var b=["REDIRECT",1,a];return b.__enum__=v.command.UrlAction,b.toString=f,b},v.command.UrlAction.BACK=["BACK",2],v.command.UrlAction.BACK.toString=f,v.command.UrlAction.BACK.__enum__=v.command.UrlAction,v.entity={},v.entity.Account=function(a,b,c){this.email=a,this.pass=b,this.accessToken=c},e["albero.entity.Account"]=v.entity.Account,v.entity.Account.__name__=["albero","entity","Account"],v.entity.Account.prototype={__class__:v.entity.Account},v.entity.AccountControlGroup=function(a){null!=a&&(this.id=a.id,this.group=new v.entity.AccountControlGroupGroup(a.group))},e["albero.entity.AccountControlGroup"]=v.entity.AccountControlGroup,v.entity.AccountControlGroup.__name__=["albero","entity","AccountControlGroup"],v.entity.AccountControlGroup.prototype={__class__:v.entity.AccountControlGroup},v.entity.AccountControlGroupGroup=function(a){null!=a&&(this.name=a.name,this.alias=a.alias,this.ownerName=a.owner_name,this.version=a.version)},e["albero.entity.AccountControlGroupGroup"]=v.entity.AccountControlGroupGroup,v.entity.AccountControlGroupGroup.__name__=["albero","entity","AccountControlGroupGroup"],v.entity.AccountControlGroupGroup.prototype={__class__:v.entity.AccountControlGroupGroup},v.entity.AccountControlGroupPartialUpdate=function(a){null!=a&&(this.id=a.id,this.group=new v.entity.AccountControlGroupGroup(a.group))},e["albero.entity.AccountControlGroupPartialUpdate"]=v.entity.AccountControlGroupPartialUpdate,v.entity.AccountControlGroupPartialUpdate.__name__=["albero","entity","AccountControlGroupPartialUpdate"],v.entity.AccountControlGroupPartialUpdate.prototype={__class__:v.entity.AccountControlGroupPartialUpdate},v.entity.AccountControlRequest=function(a){null!=a&&(w.Boot.__instanceof(a.id,z.Int64)?this.id=a.id:this.id=z.Int64.ofInt(w.Boot.__cast(a.id,E)),this.groupName=a.group_name,this.groupOwnerName=a.group_owner_name,this.groupOwnerEmail=a.group_owner_email,this.hasDomainInvite=a.has_domain_invite,this.updatedAt=a.updated_at,this.version=a.version)},e["albero.entity.AccountControlRequest"]=v.entity.AccountControlRequest,v.entity.AccountControlRequest.__name__=["albero","entity","AccountControlRequest"],v.entity.AccountControlRequest.prototype={__class__:v.entity.AccountControlRequest},v.entity.Announcement=function(a){null!=a&&(this.id=a.announcement_id,this.domainId=a.domain_id,this.groupId=a.group_id,this.groupName=a.group_name,this.type=v.entity.Message.typeOf(a.type),this.content=a.content,this.userId=a.user_id,this.userName=a.user_name,this.createdAt=a.created_at)},e["albero.entity.Announcement"]=v.entity.Announcement,v.entity.Announcement.__name__=["albero","entity","Announcement"],v.entity.Announcement.prototype={__class__:v.entity.Announcement},v.entity.AnnouncementStatus=function(a){null!=a&&(this.domainId=a.domain_id,null!=a.unread_count?this.unreadCount=a.unread_count:this.unreadCount=0,this.maxAnnouncementId=a.max_announcement_id,null!=a.max_annoucement&&(this.maxAnnouncement=new v.entity.Announcement(a.max_annoucement)),this.maxReadAnnouncementId=a.max_read_announcement_id)},e["albero.entity.AnnouncementStatus"]=v.entity.AnnouncementStatus,v.entity.AnnouncementStatus.__name__=["albero","entity","AnnouncementStatus"],v.entity.AnnouncementStatus.prototype={updateRead:function(a){var b=0,c=null;if(null!=a.readAnnouncementIds)for(var d=0,e=a.readAnnouncementIds;d<e.length;){var f=e[d];++d,(null==this.maxReadAnnouncementId||z.Int64.compare(f,this.maxReadAnnouncementId)>0)&&((null==c||z.Int64.compare(f,c)>0)&&(c=f),b++)}if(null!=c){this.maxReadAnnouncementId=c,this.unreadCount=this.unreadCount-b,this.unreadCount<0&&(this.unreadCount=0);var g="Announcement status is updated. domainId:"+o.string(this.domainId)+", maxReadAnnouncementId:"+o.string(this.maxReadAnnouncementId)+", unreadCount:"+this.unreadCount;x._d(x.dateStr(),g,"","","","")}},__class__:v.entity.AnnouncementStatus},v.entity.AnnouncementStatusUpdate=function(a){null!=a&&(this.domainId=a.domain_id,this.readAnnouncementIds=a.read_announcement_ids)},e["albero.entity.AnnouncementStatusUpdate"]=v.entity.AnnouncementStatusUpdate,v.entity.AnnouncementStatusUpdate.__name__=["albero","entity","AnnouncementStatusUpdate"],v.entity.AnnouncementStatusUpdate.prototype={__class__:v.entity.AnnouncementStatusUpdate},v.entity.Configuration=function(a){},e["albero.entity.Configuration"]=v.entity.Configuration,v.entity.Configuration.__name__=["albero","entity","Configuration"],v.entity.Configuration.prototype={__class__:v.entity.Configuration},v.entity.Contract=function(a){null!=a&&(this.id=a.contract_id,this.plan=new v.entity.Plan(a.plan),this.quota=new v.entity.Quota(a.quota),this.solutionIds=a.solution_ids)},e["albero.entity.Contract"]=v.entity.Contract,v.entity.Contract.__name__=["albero","entity","Contract"],v.entity.Contract.prototype={__class__:v.entity.Contract},v.entity.Domain=function(a){null!=a&&(this.id=a.domain_id,this.updatedAt=a.updated_at,this.domainInfo=new v.entity.DomainInfo(a.domain),this.contract=new v.entity.Contract(a.contract),this.profileDefinition=new v.entity.ProfileDefinition(a.profile_definition),this.setting=new v.entity.DomainSetting(a.setting),this.role=new v.entity.DomainRole(a.role),this.closed=!1)},e["albero.entity.Domain"]=v.entity.Domain,v.entity.Domain.__name__=["albero","entity","Domain"],v.entity.Domain.prototype={__class__:v.entity.Domain},v.entity.DomainInfo=function(a){null!=a&&(this.name=a.domain_name,this.logoUrl=a.logo_url,this.frozen=a.frozen)},e["albero.entity.DomainInfo"]=v.entity.DomainInfo,v.entity.DomainInfo.__name__=["albero","entity","DomainInfo"],v.entity.DomainInfo.prototype={__class__:v.entity.DomainInfo},v.entity.DomainSetting=function(a){null!=a&&(this.allowAttachmentType=this.allowAttachmentTypeOf(a.allow_attachment_type),this.allowSaveAttachmentsToDevice=a.allow_save_attachments_to_device)},e["albero.entity.DomainSetting"]=v.entity.DomainSetting,v.entity.DomainSetting.__name__=["albero","entity","DomainSetting"],v.entity.DomainSetting.prototype={allowAttachmentTypeOf:function(a){switch(a){case 0:return v.entity.DomainAllowAttachmentType.ng;case 1:return v.entity.DomainAllowAttachmentType.ok;case 2:return v.entity.DomainAllowAttachmentType.image;case 3:return v.entity.DomainAllowAttachmentType.imageOrVideo;case 4:return v.entity.DomainAllowAttachmentType.imageOrVideoOrAudio;default:return v.entity.DomainAllowAttachmentType.other}},__class__:v.entity.DomainSetting},v.entity.DomainRole=function(a){null!=a&&(this.type=this.typeOf(a.type),this.allowGuests=this.def(a.allow_guests,!0),this.allowCreateAttachments=this.def(a.allow_create_attachments,!0),this.allowReadAttachments=this.def(a.allow_read_attachments,!0),this.allowCreateAnnouncement=this.def(a.allow_create_announcement,!1),this.allowReadAnnouncements=a.allow_read_announcements,null==this.allowReadAnnouncements&&(this.allowReadAnnouncements=!0),this.allowListUsers=a.allow_list_users,null==this.allowListUsers&&(this.allowListUsers=!0))},e["albero.entity.DomainRole"]=v.entity.DomainRole,v.entity.DomainRole.__name__=["albero","entity","DomainRole"],v.entity.DomainRole.prototype={def:function(a,b){return a?a:b},typeOf:function(a){switch(a){case 10:return v.entity.DomainRoleType.owner;case 20:return v.entity.DomainRoleType.manager;case 30:return v.entity.DomainRoleType.user;default:return v.entity.DomainRoleType.guest}},__class__:v.entity.DomainRole},v.entity.DomainRoleType=e["albero.entity.DomainRoleType"]={__ename__:["albero","entity","DomainRoleType"],__constructs__:["owner","manager","user","guest"]},v.entity.DomainRoleType.owner=["owner",0],v.entity.DomainRoleType.owner.toString=f,v.entity.DomainRoleType.owner.__enum__=v.entity.DomainRoleType,v.entity.DomainRoleType.manager=["manager",1],v.entity.DomainRoleType.manager.toString=f,v.entity.DomainRoleType.manager.__enum__=v.entity.DomainRoleType,v.entity.DomainRoleType.user=["user",2],v.entity.DomainRoleType.user.toString=f,v.entity.DomainRoleType.user.__enum__=v.entity.DomainRoleType,v.entity.DomainRoleType.guest=["guest",3],v.entity.DomainRoleType.guest.toString=f,v.entity.DomainRoleType.guest.__enum__=v.entity.DomainRoleType,v.entity.DomainAllowAttachmentType=e["albero.entity.DomainAllowAttachmentType"]={__ename__:["albero","entity","DomainAllowAttachmentType"],__constructs__:["ng","ok","image","imageOrVideo","imageOrVideoOrAudio","other"]},v.entity.DomainAllowAttachmentType.ng=["ng",0],v.entity.DomainAllowAttachmentType.ng.toString=f,v.entity.DomainAllowAttachmentType.ng.__enum__=v.entity.DomainAllowAttachmentType,v.entity.DomainAllowAttachmentType.ok=["ok",1],v.entity.DomainAllowAttachmentType.ok.toString=f,v.entity.DomainAllowAttachmentType.ok.__enum__=v.entity.DomainAllowAttachmentType,v.entity.DomainAllowAttachmentType.image=["image",2],v.entity.DomainAllowAttachmentType.image.toString=f,v.entity.DomainAllowAttachmentType.image.__enum__=v.entity.DomainAllowAttachmentType,v.entity.DomainAllowAttachmentType.imageOrVideo=["imageOrVideo",3],v.entity.DomainAllowAttachmentType.imageOrVideo.toString=f,v.entity.DomainAllowAttachmentType.imageOrVideo.__enum__=v.entity.DomainAllowAttachmentType,v.entity.DomainAllowAttachmentType.imageOrVideoOrAudio=["imageOrVideoOrAudio",4],v.entity.DomainAllowAttachmentType.imageOrVideoOrAudio.toString=f,v.entity.DomainAllowAttachmentType.imageOrVideoOrAudio.__enum__=v.entity.DomainAllowAttachmentType,v.entity.DomainAllowAttachmentType.other=["other",5],v.entity.DomainAllowAttachmentType.other.toString=f,v.entity.DomainAllowAttachmentType.other.__enum__=v.entity.DomainAllowAttachmentType,v.entity.DomainInvite=function(a){null!=a&&(this.id=a.domain_id,this.name=a.domain_name,this.accountControlRequestId=a.account_control_request_id,this.updatedAt=a.updated_at)},e["albero.entity.DomainInvite"]=v.entity.DomainInvite,v.entity.DomainInvite.__name__=["albero","entity","DomainInvite"],v.entity.DomainInvite.prototype={__class__:v.entity.DomainInvite},v.entity.User=function(a){null!=a&&(this.id=a.user_id,this.status=a.status,this.displayName=a.display_name,this.canonicalDisplayName=a.canonical_display_name,this.phoneticDisplayName=a.phonetic_display_name,this.canonicalPhoneticDisplayName=a.canonical_phonetic_display_name,this.profileImageUrl=a.profile_image_url,this.updatedAt=a.updated_at)},e["albero.entity.User"]=v.entity.User,v.entity.User.__name__=["albero","entity","User"],v.entity.User.prototype={__class__:v.entity.User},v.entity.DomainUser=function(a){if(v.entity.User.call(this,a),null!=a&&(this.domainId=a.domain_id,null!=a.profile_contact)){this.profileContact=new Array;var b,c=0;for(b=w.Boot.__cast(a.profile_contact,Array);c<b.length;){var d=b[c];++c,this.profileContact.push(new v.entity.ProfileItemValue(d))}}},e["albero.entity.DomainUser"]=v.entity.DomainUser,v.entity.DomainUser.__name__=["albero","entity","DomainUser"],v.entity.DomainUser.__super__=v.entity.User,v.entity.DomainUser.prototype=b(v.entity.User.prototype,{match:function(a,b,c){if(null==a||0==a.length)return!0;if((null==this.canonicalDisplayName||0==this.canonicalDisplayName.length)&&(this.canonicalDisplayName=v.js.TextCanonicalizer.canonicalize(this.displayName,c),x._d(x.dateStr(),"create canonical display name from %s to %s.",this.canonicalDisplayName,this.displayName,"","")),this.canonicalDisplayName.indexOf(a)>-1)return!0;if(null!=this.canonicalPhoneticDisplayName&&this.canonicalPhoneticDisplayName.indexOf(a)>-1)return!0;if(null!=this.profileContact&&null!=b.profileDefinition.itemDefinitions)for(var d=0,e=this.profileContact;d<e.length;){var f=e[d];++d;for(var g=0,h=b.profileDefinition.itemDefinitions;g<h.length;){var i=h[g];if(++g,i.profileItemId==f.profileItemId){if(i.visible&&10==i.group&&f.canonicalValue.indexOf(a)>-1)return!0;break}}}return!1},__class__:v.entity.DomainUser}),v.entity.FileInfo=function(a){null!=a&&(this.attachmentId=a.attachment_id,this.messageId=a.message_id,this.talkId=a.talk_id,this.id=a.file_id,this.userId=a.user_id,this.name=a.name,this.contentType=a.content_type,this.contentSize=a.content_size,this.url=a.url,this.thumbUrl=a.thumbnail_url,this.updatedAt=a.updated_at,this.file=a.file,this.thumbFile=a.thumbnail_file,null!=a.deleted?this.deleted=a.deleted:this.deleted=!1)},e["albero.entity.FileInfo"]=v.entity.FileInfo,v.entity.FileInfo.__name__=["albero","entity","FileInfo"],v.entity.FileInfo.prototype={__class__:v.entity.FileInfo},v.entity.FileInfoDeletion=function(a){null!=a&&(this.messageId=a[0],this.talkId=a[1],this.fileId=a[2])},e["albero.entity.FileInfoDeletion"]=v.entity.FileInfoDeletion,v.entity.FileInfoDeletion.__name__=["albero","entity","FileInfoDeletion"],v.entity.FileInfoDeletion.prototype={__class__:v.entity.FileInfoDeletion},v.entity.HitContext=function(a){if(null!=a&&(this.talkId=a.talk_id,null!=a.messages)){this.messages=new Array;var b,c=0;for(b=w.Boot.__cast(a.messages,Array);c<b.length;){var d=b[c];++c,this.messages.push(new v.entity.HitMessage(d))}}},e["albero.entity.HitContext"]=v.entity.HitContext,v.entity.HitContext.__name__=["albero","entity","HitContext"],v.entity.HitContext.prototype={__class__:v.entity.HitContext},v.entity.HitMessage=function(a){null!=a&&(this.id=a.message_id,this.talkId=a.talk_id,this.userId=a.user_id,this.type=v.entity.Message.typeOf(a.type),this.content=a.content,this.createdAt=a.created_at,this.hit=a.hit)},e["albero.entity.HitMessage"]=v.entity.HitMessage,v.entity.HitMessage.__name__=["albero","entity","HitMessage"],v.entity.HitMessage.prototype={__class__:v.entity.HitMessage},v.entity.Me=function(a){if(v.entity.User.call(this,a),null!=a&&(this.email=a.email,this.signinId=a.signin_id,null!=a.profiles)){this.profiles=new Array;var b,c=0;for(b=w.Boot.__cast(a.profiles,Array);c<b.length;){var d=b[c];++c,this.profiles.push(new v.entity.Profile(d))}}},e["albero.entity.Me"]=v.entity.Me,v.entity.Me.__name__=["albero","entity","Me"],v.entity.Me.__super__=v.entity.User,v.entity.Me.prototype=b(v.entity.User.prototype,{toDomainUser:function(a){var b=new v.entity.DomainUser;if(b.id=this.id,b.status=this.status,b.domainId=a,b.displayName=this.displayName,b.canonicalDisplayName=this.canonicalDisplayName,b.phoneticDisplayName=this.phoneticDisplayName,b.canonicalPhoneticDisplayName=this.canonicalPhoneticDisplayName,b.profileImageUrl=this.profileImageUrl,b.updatedAt=this.updatedAt,b.email=this.email,null!=this.profiles)for(var c=0,d=this.profiles;c<d.length;){var e=d[c];if(++c,v.Int64Helper.eq(e.domainId,a)){b.profileContact=e.itemValues;break}}return b},__class__:v.entity.Me}),v.entity.Message=function(a){null!=a&&(this.id=a.message_id,this.talkId=a.talk_id,this.userId=a.user_id,this.type=v.entity.Message.typeOf(a.type),this.content=a.content,this.createdAt=a.created_at,this.readCount=a.read_count,this.readUserIds=a.read_user_ids,null==a.is_unread_count_target?this.isUnreadCountTarget=!0:this.isUnreadCountTarget=a.is_unread_count_target)},e["albero.entity.Message"]=v.entity.Message,v.entity.Message.__name__=["albero","entity","Message"],v.entity.Message.typeOf=function(a){switch(a){case 0:return v.entity.MessageType.system;case 1:return v.entity.MessageType.text;case 2:return v.entity.MessageType.stamp;case 3:return v.entity.MessageType.geo;case 4:return v.entity.MessageType.file;case 5:return v.entity.MessageType.textMultipleFile;case 500:return v.entity.MessageType.yesOrNo;case 501:return v.entity.MessageType.yesOrNoReply;case 502:return v.entity.MessageType.selectOne;case 503:return v.entity.MessageType.selectOneReply;case 504:return v.entity.MessageType.todo;case 505:return v.entity.MessageType.todoDone;case 506:return v.entity.MessageType.yesOrNoClosed;case 507:return v.entity.MessageType.selectOneClosed;case 508:return v.entity.MessageType.todoClosed;case 600:return v.entity.MessageType.phoneCall;case 601:return v.entity.MessageType.phoneReceive;default:return v.entity.MessageType.unknown}},v.entity.Message.enumIndex=function(a){switch(a[1]){case 0:case 1:case 2:case 3:case 4:case 5:return a[1];case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:return 500+a[1]-6;case 15:case 16:return 600+a[1]-15;default:return-1}},v.entity.Message.prototype={__class__:v.entity.Message},v.entity.MessageType=e["albero.entity.MessageType"]={__ename__:["albero","entity","MessageType"],__constructs__:["system","text","stamp","geo","file","textMultipleFile","yesOrNo","yesOrNoReply","selectOne","selectOneReply","todo","todoDone","yesOrNoClosed","selectOneClosed","todoClosed","phoneCall","phoneReceive","unknown"]},v.entity.MessageType.system=["system",0],v.entity.MessageType.system.toString=f,v.entity.MessageType.system.__enum__=v.entity.MessageType,v.entity.MessageType.text=["text",1],v.entity.MessageType.text.toString=f,v.entity.MessageType.text.__enum__=v.entity.MessageType,v.entity.MessageType.stamp=["stamp",2],v.entity.MessageType.stamp.toString=f,v.entity.MessageType.stamp.__enum__=v.entity.MessageType,v.entity.MessageType.geo=["geo",3],v.entity.MessageType.geo.toString=f,v.entity.MessageType.geo.__enum__=v.entity.MessageType,v.entity.MessageType.file=["file",4],v.entity.MessageType.file.toString=f,v.entity.MessageType.file.__enum__=v.entity.MessageType,v.entity.MessageType.textMultipleFile=["textMultipleFile",5],v.entity.MessageType.textMultipleFile.toString=f,v.entity.MessageType.textMultipleFile.__enum__=v.entity.MessageType,v.entity.MessageType.yesOrNo=["yesOrNo",6],v.entity.MessageType.yesOrNo.toString=f,v.entity.MessageType.yesOrNo.__enum__=v.entity.MessageType,v.entity.MessageType.yesOrNoReply=["yesOrNoReply",7],v.entity.MessageType.yesOrNoReply.toString=f,v.entity.MessageType.yesOrNoReply.__enum__=v.entity.MessageType,v.entity.MessageType.selectOne=["selectOne",8],v.entity.MessageType.selectOne.toString=f,v.entity.MessageType.selectOne.__enum__=v.entity.MessageType,v.entity.MessageType.selectOneReply=["selectOneReply",9],v.entity.MessageType.selectOneReply.toString=f,v.entity.MessageType.selectOneReply.__enum__=v.entity.MessageType,v.entity.MessageType.todo=["todo",10],v.entity.MessageType.todo.toString=f,v.entity.MessageType.todo.__enum__=v.entity.MessageType,v.entity.MessageType.todoDone=["todoDone",11],v.entity.MessageType.todoDone.toString=f,v.entity.MessageType.todoDone.__enum__=v.entity.MessageType,v.entity.MessageType.yesOrNoClosed=["yesOrNoClosed",12],v.entity.MessageType.yesOrNoClosed.toString=f,v.entity.MessageType.yesOrNoClosed.__enum__=v.entity.MessageType,v.entity.MessageType.selectOneClosed=["selectOneClosed",13],v.entity.MessageType.selectOneClosed.toString=f,v.entity.MessageType.selectOneClosed.__enum__=v.entity.MessageType,v.entity.MessageType.todoClosed=["todoClosed",14],v.entity.MessageType.todoClosed.toString=f,v.entity.MessageType.todoClosed.__enum__=v.entity.MessageType,v.entity.MessageType.phoneCall=["phoneCall",15],v.entity.MessageType.phoneCall.toString=f,v.entity.MessageType.phoneCall.__enum__=v.entity.MessageType,v.entity.MessageType.phoneReceive=["phoneReceive",16],v.entity.MessageType.phoneReceive.toString=f,v.entity.MessageType.phoneReceive.__enum__=v.entity.MessageType,v.entity.MessageType.unknown=["unknown",17],v.entity.MessageType.unknown.toString=f,v.entity.MessageType.unknown.__enum__=v.entity.MessageType,v.entity.MessageReadStatus=function(a){null!=a&&(this.id=a.message_id,this.talkId=a.talk_id,this.readUserIds=a.read_user_ids,this.unreadUserIds=a.unread_user_ids)},e["albero.entity.MessageReadStatus"]=v.entity.MessageReadStatus,v.entity.MessageReadStatus.__name__=["albero","entity","MessageReadStatus"],v.entity.MessageReadStatus.prototype={__class__:v.entity.MessageReadStatus},v.entity.MessageReadStatusesUpdate=function(a){null!=a&&(this.talkId=a.talk_id,this.messageIds=a.message_ids,this.readUserIds=a.read_user_ids,this.messageIdsExcludingUnreadCountTargets=a.message_ids_excluding_unread_count_targets,null==this.messageIdsExcludingUnreadCountTargets&&(this.messageIdsExcludingUnreadCountTargets=new Array));
},e["albero.entity.MessageReadStatusesUpdate"]=v.entity.MessageReadStatusesUpdate,v.entity.MessageReadStatusesUpdate.__name__=["albero","entity","MessageReadStatusesUpdate"],v.entity.MessageReadStatusesUpdate.prototype={__class__:v.entity.MessageReadStatusesUpdate},v.entity.PasswordExpiration=function(a){null!=a&&(this.expiration=a.expiration,this.warning=a.warning)},e["albero.entity.PasswordExpiration"]=v.entity.PasswordExpiration,v.entity.PasswordExpiration.__name__=["albero","entity","PasswordExpiration"],v.entity.PasswordExpiration.prototype={__class__:v.entity.PasswordExpiration},v.entity.Plan=function(a){null!=a&&(this.name=a.plan_name,this.trial=a.trial)},e["albero.entity.Plan"]=v.entity.Plan,v.entity.Plan.__name__=["albero","entity","Plan"],v.entity.Plan.prototype={__class__:v.entity.Plan},v.entity.Profile=function(a){if(null!=a&&(this.domainId=a.domain_id,this.userId=a.user_id,null!=a.item_values)){this.itemValues=new Array;var b,c=0;for(b=w.Boot.__cast(a.item_values,Array);c<b.length;){var d=b[c];++c,this.itemValues.push(new v.entity.ProfileItemValue(d))}}},e["albero.entity.Profile"]=v.entity.Profile,v.entity.Profile.__name__=["albero","entity","Profile"],v.entity.Profile.prototype={__class__:v.entity.Profile},v.entity.ProfileDefinition=function(a){if(null!=a&&(this.domainId=a.domain_id,null!=a.item_definitions)){this.itemDefinitions=new Array;var b,c=0;for(b=w.Boot.__cast(a.item_definitions,Array);c<b.length;){var d=b[c];++c,this.itemDefinitions.push(new v.entity.ProfileItemDefinition(d))}}},e["albero.entity.ProfileDefinition"]=v.entity.ProfileDefinition,v.entity.ProfileDefinition.__name__=["albero","entity","ProfileDefinition"],v.entity.ProfileDefinition.isSameProfileItemDefinitions=function(a,b){if(b.length!=a.length)return!1;for(var c=0,d=b.length;d>c;){var e=c++;if(b[e].profileItemId!=a[e].profileItemId)return!1}return!0},v.entity.ProfileDefinition.prototype={getVisibleItemDefinition:function(a){null==a&&(a=!1);var b=new Array;if(null!=this.itemDefinitions)for(var c=0,d=this.itemDefinitions;c<d.length;){var e=d[c];++c,e.visible&&(a||10==e.group)&&b.push(e)}return b},__class__:v.entity.ProfileDefinition},v.entity.ProfileItemDefinition=function(a){this.locked=!1,this.visible=!0,null!=a&&(this.profileItemId=a.profile_item_id,this.group=a.group,this.name=a.name,this.valueType=a.value_type,null!=a.visible&&(this.visible=a.visible),null!=a.locked&&(this.locked=a.locked))},e["albero.entity.ProfileItemDefinition"]=v.entity.ProfileItemDefinition,v.entity.ProfileItemDefinition.__name__=["albero","entity","ProfileItemDefinition"],v.entity.ProfileItemDefinition.findById=function(a,b){for(var c=0;c<a.length;){var d=a[c];if(++c,d.profileItemId==b)return d}return null},v.entity.ProfileItemDefinition.prototype={__class__:v.entity.ProfileItemDefinition},v.entity.ProfileItemValue=function(a){null!=a&&(this.profileItemId=a.profile_item_id,this.value=a.value,this.canonicalValue=a.canonical_value,x._d(x.dateStr(),"ProfileItemValue unmarshalize. profileItemId:",this.profileItemId,", value:",this.value,""))},e["albero.entity.ProfileItemValue"]=v.entity.ProfileItemValue,v.entity.ProfileItemValue.__name__=["albero","entity","ProfileItemValue"],v.entity.ProfileItemValue.findById=function(a,b){for(var c=0;c<a.length;){var d=a[c];if(++c,d.profileItemId==b)return d}return null},v.entity.ProfileItemValue.prototype={__class__:v.entity.ProfileItemValue},v.entity.Question=function(a){null!=a&&(this.id=a.message_id,this.talkId=a.talk_id,this.type=v.entity.Message.typeOf(a.type),this.content=a.content,this.userId=a.user_id,this.recipientIds=a.assigned_user_ids,this.responses=this.createResponses(a.responses),this.listing=a.listing,this.closingType=v.entity.Question.typeOf(a.closing_type),this.maxResponseId=a.max_response_id,this.lastResponse=a.last_response,this.lastResponseUserId=a.last_response_user_id,this.createdAt=a.created_at,this.updatedAt=a.updated_at,this.responded=a.responded,this.closed=a.closed)},e["albero.entity.Question"]=v.entity.Question,v.entity.Question.__name__=["albero","entity","Question"],v.entity.Question.typeOf=function(a){switch(a){case 0:return v.entity.QuestionClosingType.any;case 1:return v.entity.QuestionClosingType.all;default:return v.entity.QuestionClosingType.unknown}},v.entity.Question.prototype={createResponses:function(a){var b=[];if(null!=a)for(var c=0;c<a.length;){var d=a[c];++c,b.push(new v.entity.QuestionResponse(d))}return b},isCompleted:function(a){if(t.enumEq(this.type,v.entity.MessageType.todo)){if(t.enumEq(this.closingType,v.entity.QuestionClosingType.any)){if(null!=this.lastResponse&&"DONE"==this.responses[this.lastResponse].content)return!0}else{if(!this.responded)return!1;for(var b=0,c=this.responses;b<c.length;){var d=c[b];if(++b,v.Int64Helper.contains(d.userIds,a))return"DONE"==d.content?!0:!1}}return!1}return t.enumEq(this.closingType,v.entity.QuestionClosingType.any)?null!=this.lastResponse:this.responded},__class__:v.entity.Question},v.entity.QuestionResponse=function(a){null!=a&&(this.content=a.content,this.count=a.count,this.userIds=a.user_ids)},e["albero.entity.QuestionResponse"]=v.entity.QuestionResponse,v.entity.QuestionResponse.__name__=["albero","entity","QuestionResponse"],v.entity.QuestionResponse.prototype={__class__:v.entity.QuestionResponse},v.entity.QuestionClosingType=e["albero.entity.QuestionClosingType"]={__ename__:["albero","entity","QuestionClosingType"],__constructs__:["any","all","unknown"]},v.entity.QuestionClosingType.any=["any",0],v.entity.QuestionClosingType.any.toString=f,v.entity.QuestionClosingType.any.__enum__=v.entity.QuestionClosingType,v.entity.QuestionClosingType.all=["all",1],v.entity.QuestionClosingType.all.toString=f,v.entity.QuestionClosingType.all.__enum__=v.entity.QuestionClosingType,v.entity.QuestionClosingType.unknown=["unknown",2],v.entity.QuestionClosingType.unknown.toString=f,v.entity.QuestionClosingType.unknown.__enum__=v.entity.QuestionClosingType,v.entity.QuestionFromType=e["albero.entity.QuestionFromType"]={__ename__:["albero","entity","QuestionFromType"],__constructs__:["fromSelf","fromOther"]},v.entity.QuestionFromType.fromSelf=["fromSelf",0],v.entity.QuestionFromType.fromSelf.toString=f,v.entity.QuestionFromType.fromSelf.__enum__=v.entity.QuestionFromType,v.entity.QuestionFromType.fromOther=["fromOther",1],v.entity.QuestionFromType.fromOther.toString=f,v.entity.QuestionFromType.fromOther.__enum__=v.entity.QuestionFromType,v.entity.QuestionFilter=e["albero.entity.QuestionFilter"]={__ename__:["albero","entity","QuestionFilter"],__constructs__:["onlyClosed","onlyUnclosed","noFilter"]},v.entity.QuestionFilter.onlyClosed=["onlyClosed",0],v.entity.QuestionFilter.onlyClosed.toString=f,v.entity.QuestionFilter.onlyClosed.__enum__=v.entity.QuestionFilter,v.entity.QuestionFilter.onlyUnclosed=["onlyUnclosed",1],v.entity.QuestionFilter.onlyUnclosed.toString=f,v.entity.QuestionFilter.onlyUnclosed.__enum__=v.entity.QuestionFilter,v.entity.QuestionFilter.noFilter=["noFilter",2],v.entity.QuestionFilter.noFilter.toString=f,v.entity.QuestionFilter.noFilter.__enum__=v.entity.QuestionFilter,v.entity.Quota=function(a){null!=a&&(this.msgRetentionPeriod=a.msg_retention_period,this.msgFileSize=a.msg_file_size)},e["albero.entity.Quota"]=v.entity.Quota,v.entity.Quota.__name__=["albero","entity","Quota"],v.entity.Quota.prototype={__class__:v.entity.Quota},v.entity.SearchAttachmentsResult=function(a){if(null!=a&&(this.total=a.total,this.marker=a.marker,this.nextMarker=a.next_marker,this.contents=new Array,null!=a.contents)){var b,c=0;for(b=w.Boot.__cast(a.contents,Array);c<b.length;){var d=b[c];++c,this.contents.push(new v.entity.FileInfo(d))}}},e["albero.entity.SearchAttachmentsResult"]=v.entity.SearchAttachmentsResult,v.entity.SearchAttachmentsResult.__name__=["albero","entity","SearchAttachmentsResult"],v.entity.SearchAttachmentsResult.prototype={__class__:v.entity.SearchAttachmentsResult},v.entity.SearchMessagesResult=function(a){if(null!=a&&(this.total=a.total,this.marker=a.marker,this.nextMarker=a.next_marker,this.contents=new Array,null!=a.contents)){var b,c=0;for(b=w.Boot.__cast(a.contents,Array);c<b.length;){var d=b[c];++c,this.contents.push(new v.entity.HitContext(d))}}},e["albero.entity.SearchMessagesResult"]=v.entity.SearchMessagesResult,v.entity.SearchMessagesResult.__name__=["albero","entity","SearchMessagesResult"],v.entity.SearchMessagesResult.prototype={__class__:v.entity.SearchMessagesResult},v.entity.SearchParams=function(a){null!=a&&(null!=a.domain_id_str&&(this.domainId=v.Int64Helper.makeFromIdStr(a.domain_id_str)),null!=a.talk_id_str&&(this.talkId=v.Int64Helper.makeFromIdStr(a.talk_id_str)),this.keyword=a.keyword,null==a.search_type||"メッセージ"==a.search_type?this.searchType=v.entity.SearchType.MESSAGES:this.searchType=v.entity.SearchType.ATTACHMENTS,this.sinceText=a.since,this.untilText=a.until,null!=a.from_id_str&&(this.fromUserId=v.Int64Helper.makeFromIdStr(a.from_id_str)))},e["albero.entity.SearchParams"]=v.entity.SearchParams,v.entity.SearchParams.__name__=["albero","entity","SearchParams"],v.entity.SearchParams.dateQueryToText=function(a,b){if(null==a)return b;switch(a){case"t":return"今日";case"-1d":return"昨日";case"-3d":return"3日前";default:return q.replace(a,"-","/")}},v.entity.SearchParams.prototype={toProps:function(){var a={};null!=this.domainId&&(a.domain_id_str=v.Int64Helper.idStr(this.domainId)),null!=this.talkId&&(a.talk_id_str=v.Int64Helper.idStr(this.talkId)),a.keyword=this.keyword;var b=this.searchType;switch(b[1]){case 0:a.search_type="メッセージ";break;case 1:a.search_type="ファイル"}return a.since=this.sinceText,a.until=this.untilText,null!=this.fromUserId&&(a.from_id_str=v.Int64Helper.idStr(this.fromUserId)),a},copy:function(){return new v.entity.SearchParams(this.toProps())},eq:function(a){return(this.domainId==a.domainId||v.Int64Helper.eq(this.domainId,a.domainId))&&(this.talkId==a.talkId||v.Int64Helper.eq(this.talkId,a.talkId))?this.keyword!=a.keyword?!1:t.enumEq(this.searchType,a.searchType)?this.sinceText!=a.sinceText?!1:this.untilText!=a.untilText?!1:this.fromUserId==a.fromUserId||v.Int64Helper.eq(this.fromUserId,a.fromUserId)?!0:!1:!1:!1},getQueryText:function(){var a=new Array;return null!=this.keyword&&0!=this.keyword.length&&a.push(this.keyword),null!=this.sinceText&&a.push("since:"+this.sinceText),null!=this.untilText&&a.push("until:"+this.untilText),null!=this.fromUserId&&a.push("from:"+this.fromUserId.toString()),a.join(" ")},getPeriodText:function(){return""+v.entity.SearchParams.dateQueryToText(this.sinceText,"")+"~"+v.entity.SearchParams.dateQueryToText(this.untilText,"")},__class__:v.entity.SearchParams},v.entity.SearchType=e["albero.entity.SearchType"]={__ename__:["albero","entity","SearchType"],__constructs__:["MESSAGES","ATTACHMENTS"]},v.entity.SearchType.MESSAGES=["MESSAGES",0],v.entity.SearchType.MESSAGES.toString=f,v.entity.SearchType.MESSAGES.__enum__=v.entity.SearchType,v.entity.SearchType.ATTACHMENTS=["ATTACHMENTS",1],v.entity.SearchType.ATTACHMENTS.toString=f,v.entity.SearchType.ATTACHMENTS.__enum__=v.entity.SearchType,v.entity.Solution=function(a){null!=a&&(this.solutionId=a.solution_id,this.name=a.name,this.iconUrl=a.icon_url,this.url=a.url)},e["albero.entity.Solution"]=v.entity.Solution,v.entity.Solution.__name__=["albero","entity","Solution"],v.entity.Solution.prototype={__class__:v.entity.Solution},v.entity.StampSet=function(){},e["albero.entity.StampSet"]=v.entity.StampSet,v.entity.StampSet.__name__=["albero","entity","StampSet"],v.entity.StampSet.prototype={__class__:v.entity.StampSet},v.entity.Talk=function(a){null!=a&&(this.id=a.talk_id,this.domainId=a.domain_id,this.type=this.typeOf(a.type),this.name=a.talk_name,this.iconUrl=a.icon_url,this.userIds=a.user_ids,this.guestIds=a.inviting_guest_ids,this.updatedAt=a.updated_at,this.leftUsers=this.getUsers(a.left_users))},e["albero.entity.Talk"]=v.entity.Talk,v.entity.Talk.__name__=["albero","entity","Talk"],v.entity.Talk.prototype={typeOf:function(a){switch(a){case 1:return v.entity.TalkType.PairTalk;case 2:return v.entity.TalkType.GroupTalk;default:return v.entity.TalkType.Unknown}},getUsers:function(a){if(null==a)return null;for(var b=new Array,c=0;c<a.length;){var d=a[c];++c,b.push(new v.entity.DomainUser(d))}return b},__class__:v.entity.Talk},v.entity.TalkType=e["albero.entity.TalkType"]={__ename__:["albero","entity","TalkType"],__constructs__:["Unknown","PairTalk","GroupTalk"]},v.entity.TalkType.Unknown=["Unknown",0],v.entity.TalkType.Unknown.toString=f,v.entity.TalkType.Unknown.__enum__=v.entity.TalkType,v.entity.TalkType.PairTalk=["PairTalk",1],v.entity.TalkType.PairTalk.toString=f,v.entity.TalkType.PairTalk.__enum__=v.entity.TalkType,v.entity.TalkType.GroupTalk=["GroupTalk",2],v.entity.TalkType.GroupTalk.toString=f,v.entity.TalkType.GroupTalk.__enum__=v.entity.TalkType,v.entity.TalkStatus=function(a){this.unreadCount=0,null!=a&&(this.id=a.talk_id,null!=a.unread_count?this.unreadCount=a.unread_count:this.unreadCount=0,this.maxMessageId=a.max_message_id,null!=a.max_message?this.maxMessage=new v.entity.Message(a.max_message):this.maxMessage=null,this.maxReadMessageId=a.max_read_message_id,this.maxEveryoneReadMessageId=a.max_everyone_read_message_id)},e["albero.entity.TalkStatus"]=v.entity.TalkStatus,v.entity.TalkStatus.__name__=["albero","entity","TalkStatus"],v.entity.TalkStatus.prototype={__class__:v.entity.TalkStatus},v.entity.TalkStatusUpdate=function(a){null!=a&&(this.talkId=a.talk_id,this.maxEveryoneReadMessageId=a.max_everyone_read_message_id)},e["albero.entity.TalkStatusUpdate"]=v.entity.TalkStatusUpdate,v.entity.TalkStatusUpdate.__name__=["albero","entity","TalkStatusUpdate"],v.entity.TalkStatusUpdate.prototype={__class__:v.entity.TalkStatusUpdate},v.js={},v.js.LocalStorage=function(a){this.isDirty=!1,this.key=a},e["albero.js.LocalStorage"]=v.js.LocalStorage,v.js.LocalStorage.__name__=["albero","js","LocalStorage"],v.js.LocalStorage.getLocalStorage=function(){var a=null,b=w.Node.require("node-localstorage").LocalStorage;return a=new b(null!=C.storagePath?C.storagePath:"./storage.local")},v.js.LocalStorage.prototype={load:function(){var a=this.val();if(null==a||""==a)return null;var b=null;try{b=z.Unserializer.run(a),this.isDirty=!1}catch(c){x._w(x.dateStr(),c,"","","","")}return b},save:function(a){try{this.val(z.Serializer.run(a)),this.isDirty=!1}catch(b){x._w(x.dateStr(),b,"","","","")}},setDirtyFlag:function(){0==this.isDirty&&(this.val(""),this.isDirty=!0)},val:function(a){var b=v.js.LocalStorage.getLocalStorage();return null!=b&&(null==a?a=b.getItem(this.key):""==a?b.removeItem(this.key):b.setItem(this.key,a)),a},__class__:v.js.LocalStorage};var w={};w.Node=function(){},e["js.Node"]=w.Node,w.Node.__name__=["js","Node"],w.Node.get_assert=function(){return w.Node.require("assert")},w.Node.get_child_process=function(){return w.Node.require("child_process")},w.Node.get_cluster=function(){return w.Node.require("cluster")},w.Node.get_crypto=function(){return w.Node.require("crypto")},w.Node.get_dgram=function(){return w.Node.require("dgram")},w.Node.get_dns=function(){return w.Node.require("dns")},w.Node.get_fs=function(){return w.Node.require("fs")},w.Node.get_http=function(){return w.Node.require("http")},w.Node.get_https=function(){return w.Node.require("https")},w.Node.get_net=function(){return w.Node.require("net")},w.Node.get_os=function(){return w.Node.require("os")},w.Node.get_path=function(){return w.Node.require("path")},w.Node.get_querystring=function(){return w.Node.require("querystring")},w.Node.get_repl=function(){return w.Node.require("repl")},w.Node.get_tls=function(){return w.Node.require("tls")},w.Node.get_url=function(){return w.Node.require("url")},w.Node.get_util=function(){return w.Node.require("util")},w.Node.get_vm=function(){return w.Node.require("vm")},w.Node.get_zlib=function(){return w.Node.require("zlib")},w.Node.get___filename=function(){return __filename},w.Node.get___dirname=function(){return __dirname},w.Node.get_json=function(){return JSON},w.Node.newSocket=function(a){return new w.Node.net.Socket(a)},w.Node.isNodeWebkit=function(){return"object"==typeof process};var x=a.AlberoLog=function(){};e.AlberoLog=x,x.__name__=["AlberoLog"],x.getLogLevel=function(a){switch(a=null!=a?a.toUpperCase():"INFO"){case"EMERGENCY":return 0;case"ALERT":return 1;case"CRITICAL":return 2;case"ERROR":return 3;case"WARNING":return 4;case"NOTICE":return 5;case"INFO":return 6;default:return 7}},x._nop=function(){},x.dateStr=function(){return"["+function(a){var b,c=new Date;return b=i.dateStr(c)}(this)+"] "},v.js.NFKCTextSearch=function(a,b,c){this.ignoreCase=b,this.normalizeFunc=c,b&&(a=a.toUpperCase()),this.normalizedPattern=c(a)},e["albero.js.NFKCTextSearch"]=v.js.NFKCTextSearch,v.js.NFKCTextSearch.__name__=["albero","js","NFKCTextSearch"],v.js.NFKCTextSearch.prototype={search:function(a){var b=new p,c=new Array;this.ignoreCase&&(a=a.toUpperCase()),this.normalize(a,b,c);for(var d,e=0,f=new Array,g=b.b;-1!=(d=g.indexOf(this.normalizedPattern,e));){e=d+this.normalizedPattern.length;for(var h=c[d],i=c[e-1],j=null,k=e,l=c.length;l>k;){var m=k++;if(j=c[m],i!=j)break;j=null}null==j&&(j=a.length),f.push(new v.js.HitSpan(h,j))}return f},normalize:function(a,b,c){for(var d=a.length,e=new p,f=0,g=0;d>g;){var h=g++,i=e.b.length,j=e.b,k=j+a.charAt(h),l=this.normalizeFunc(k);if(k!=l)if(q.startsWith(l,j)){b.add(j.substring(0,i)),e=new p,e.add(l.substring(i,l.length));for(var m=0;i>m;){m++;c.push(f)}f=h}else e=new p,null==l?e.b+="null":e.b+=""+l;else{b.b+=o.string(e),e=new p,e.add(a.charAt(h));for(var n=0;i>n;){n++;c.push(f)}f=h}}null==e.b?b.b+="null":b.b+=""+e.b;for(var r=0,s=e.b.length;s>r;){r++;c.push(f)}},__class__:v.js.NFKCTextSearch},v.js.HitSpan=function(a,b){this.start=a,this.end=b},e["albero.js.HitSpan"]=v.js.HitSpan,v.js.HitSpan.__name__=["albero","js","HitSpan"],v.js.HitSpan.prototype={__class__:v.js.HitSpan},v.js.ProxyHelper=function(){},e["albero.js.ProxyHelper"]=v.js.ProxyHelper,v.js.ProxyHelper.__name__=["albero","js","ProxyHelper"],v.js.ProxyHelper.createAgent=function(a){var b=w.Node.require("url").parse(a),c={host:b.hostname};null!=b.port&&(c.port=o.parseInt(b.port)),null!=b.auth&&(c.proxyAuth=b.auth);var d,e=w.Node.require("tunnel-agent");return(d="https:"==b.protocol?e.httpsOverHttps:e.httpsOverHttp)({proxy:c})},v.js.TextCanonicalizer=function(){},e["albero.js.TextCanonicalizer"]=v.js.TextCanonicalizer,v.js.TextCanonicalizer.__name__=["albero","js","TextCanonicalizer"],v.js.TextCanonicalizer.canonicalize=function(a,b){return v.js.TextCanonicalizer.basicLatinAlphabetToUpperCase(v.js.TextCanonicalizer.hiraganaToKatakana(b(v.js.TextCanonicalizer.eraseInvisible(a))))},v.js.TextCanonicalizer.basicLatinAlphabetToUpperCase=function(a){return a.toUpperCase()},v.js.TextCanonicalizer.hiraganaToKatakana=function(a){for(var b=0,c="",d=0,e=a.length;e>d;){var f=d++,g=i.cca(a,f);g>=v.js.TextCanonicalizer.HIRAGANA_SMALL_A&&g<=v.js.TextCanonicalizer.HIRAGANA_NN&&(c+=a.substring(b,f),c+=String.fromCharCode(g+(v.js.TextCanonicalizer.KATAKANA_SMALL_A-v.js.TextCanonicalizer.HIRAGANA_SMALL_A)),b=f+1)}return c+=a.substring(b,a.length)},v.js.TextCanonicalizer.normalize=function(a){return a.normalize("NFKC")},v.js.TextCanonicalizer.assureNormalize=function(a){a(v.js.TextCanonicalizer.normalize)},v.js.TextCanonicalizer.eraseInvisible=function(a){var b=new h("[\\u0000-\\u0020　]","g");return b.replace(a,"")},v.js.WebSocket=function(a){var b=this,c=w.Node.require("websocket").client;this.ws=new c,this.ws.on("connectFailed",d(this,this.onError)),this.ws.on("connect",function(a){b.connection=a,a.on("error",d(b,b.onError)),a.on("close",d(b,b.onConnectionClose)),a.on("message",d(b,b.onMessage)),b.onOpen(null)});var e=null;null!=C.proxyURL&&(e={agent:v.js.ProxyHelper.createAgent(C.proxyURL)}),this.ws.connect(a,null,null,null,e)},e["albero.js.WebSocket"]=v.js.WebSocket,v.js.WebSocket.__name__=["albero","js","WebSocket"],v.js.WebSocket.prototype={onOpen:function(a){x._i(x.dateStr(),"WebSocket opened.","","","",""),null!=this.onopen&&this.onopen()},onMessage:function(a){if(null!=this.onmessage){var b=null,c=a;b=z.io.Bytes.ofData(c.binaryData),this.onmessage(b)}},onError:function(a){x._e(x.dateStr(),"WebSocket error. event:",a,"","",""),null!=this.onerror&&this.onerror()},onClose:function(a){this.ws=null,this.connection=null,x._i(x.dateStr(),"WebSocket closed. event:%s reason:%s wasClean:%s",a.code,a.reason,a.wasClean,""),null!=this.onclose&&this.onclose(a.code,a.reason,a.wasClean)},onConnectionClose:function(a,b){this.onClose({code:a,reason:b})},close:function(){this.isClosed()||this.connection.close()},send:function(a){this.isClosed()||this.connection.sendBytes(a.b)},isClosed:function(){return null==this.ws||null==this.connection||!this.connection.connected},__class__:v.js.WebSocket},u.interfaces.IProxy=function(){},e["puremvc.interfaces.IProxy"]=u.interfaces.IProxy,u.interfaces.IProxy.__name__=["puremvc","interfaces","IProxy"],u.interfaces.IProxy.prototype={__class__:u.interfaces.IProxy},v.proxy={},v.proxy.AccountLoaderProxy=function(){},e["albero.proxy.AccountLoaderProxy"]=v.proxy.AccountLoaderProxy,v.proxy.AccountLoaderProxy.__name__=["albero","proxy","AccountLoaderProxy"],v.proxy.AccountLoaderProxy.__interfaces__=[u.interfaces.IProxy],v.proxy.AccountLoaderProxy.prototype={__class__:v.proxy.AccountLoaderProxy},v.proxy.AccountLoaderProxyFactory=function(){},e["albero.proxy.AccountLoaderProxyFactory"]=v.proxy.AccountLoaderProxyFactory,v.proxy.AccountLoaderProxyFactory.__name__=["albero","proxy","AccountLoaderProxyFactory"],v.proxy.AccountLoaderProxyFactory.newInstance=function(){var a=t.resolveClass("albero.debug.proxy.AccountLoaderProxyImpl");return null!=a?t.createInstance(a,["accountLoader"]):new v.proxy._AccountLoaderProxy.DefaultTestAccountLoaderProxy("accountLoader")},u.patterns.proxy={},u.patterns.proxy.Proxy=function(a,b){u.patterns.observer.Notifier.call(this),null!=a?this.proxyName=a:this.proxyName=u.patterns.proxy.Proxy.NAME,null!=b&&this.setData(b)},e["puremvc.patterns.proxy.Proxy"]=u.patterns.proxy.Proxy,u.patterns.proxy.Proxy.__name__=["puremvc","patterns","proxy","Proxy"],u.patterns.proxy.Proxy.__interfaces__=[u.interfaces.IProxy],u.patterns.proxy.Proxy.__super__=u.patterns.observer.Notifier,u.patterns.proxy.Proxy.prototype=b(u.patterns.observer.Notifier.prototype,{getProxyName:function(){return this.proxyName},setData:function(a){this.data=a},getData:function(){return this.data},onRegister:function(){},onRemove:function(){},__class__:u.patterns.proxy.Proxy}),v.proxy._AccountLoaderProxy={},v.proxy._AccountLoaderProxy.DefaultTestAccountLoaderProxy=function(a){u.patterns.proxy.Proxy.call(this,a)},e["albero.proxy._AccountLoaderProxy.DefaultTestAccountLoaderProxy"]=v.proxy._AccountLoaderProxy.DefaultTestAccountLoaderProxy,v.proxy._AccountLoaderProxy.DefaultTestAccountLoaderProxy.__name__=["albero","proxy","_AccountLoaderProxy","DefaultTestAccountLoaderProxy"],v.proxy._AccountLoaderProxy.DefaultTestAccountLoaderProxy.__interfaces__=[v.proxy.AccountLoaderProxy],v.proxy._AccountLoaderProxy.DefaultTestAccountLoaderProxy.__super__=u.patterns.proxy.Proxy,v.proxy._AccountLoaderProxy.DefaultTestAccountLoaderProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{load:function(){var a=this,b=w.Node.require("read");return b({prompt:"Email: "},function(c,d){b({prompt:"Password: ",silent:!0},function(b,c){a.sendNotification("SignIn",new v.entity.Account(d,c))})}),null},__class__:v.proxy._AccountLoaderProxy.DefaultTestAccountLoaderProxy}),v.proxy.AlberoBroadcastProxy=function(){u.patterns.proxy.Proxy.call(this,"broadcast")},e["albero.proxy.AlberoBroadcastProxy"]=v.proxy.AlberoBroadcastProxy,v.proxy.AlberoBroadcastProxy.__name__=["albero","proxy","AlberoBroadcastProxy"],v.proxy.AlberoBroadcastProxy.__super__=u.patterns.proxy.Proxy,v.proxy.AlberoBroadcastProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{handleNotification:function(a,b,c){var d=this;switch(x._d(x.dateStr(),"Receive request from server. name:",a," body:",b,""),a){case"notify_update_user":if(b instanceof Array&&null==b.__enum__){var e=new v.entity.DomainUser(b[1]);this.dataStore.setUserIfLatest(null,e)}else{var f=new v.entity.Me(b);x._d(x.dateStr(),"Current user updated. user:",f,"","",""),this.dataStore.setMe(f)}c();break;case"notify_add_friend":var g=new v.entity.DomainUser(b[1]);this.dataStore.addFriend(g),this.sendNotification(a,g),c();break;case"notify_add_acquaintance":var h=new v.entity.DomainUser(b[1]);this.dataStore.addAcquaintance(h),this.sendNotification(a,h),c();break;case"notify_join_domain":var i=new v.entity.Domain(b);this.dataStore.setDomain(i),this.sendNotification(a,[null,i]),c();break;case"notify_update_domain":var j=new v.entity.Domain(b),k=this.dataStore.getDomain(j.id);if(this.dataStore.setDomain(j),null!=k&&k.role.allowReadAnnouncements&&!j.role.allowReadAnnouncements){this.dataStore.removeAnnouncementStatus(k.id);var l=new v.entity.AnnouncementStatusUpdate;l.domainId=j.id,this.sendNotification("notify_update_announcement_status",l)}null!=k&&k.role.allowReadAnnouncements||!j.role.allowReadAnnouncements||this.api.getAnnouncementStatus(j.id),this.sendNotification(a,[k,j]),c();break;case"notify_add_domain_invite":var m=new v.entity.DomainInvite(b);this.dataStore.setDomainInvite(m),this.sendNotification(a,m),c();break;case"notify_create_pair_talk":case"notify_create_group_talk":case"notify_update_group_talk":case"notify_add_talkers":case"notify_delete_talker":var n=new v.entity.Talk(b);this.dataStore.setTalk(n),this.sendNotification(a,n),c();break;case"notify_create_message":var o=new v.entity.Message(b),p=this.newTalkStatusByMessage(o);null!=p&&this.sendNotification("notify_update_local_talk_status",p);var q=o.type;switch(q[1]){case 16:this.sendNotification("phone_call_connected",o.content),this.sendNotification(a,o),c();break;case 6:case 8:case 10:z.Timer.delay(function(){d.sendNotification("ReloadData",v.command.ReloadDataType.Question(o.id,function(b){d.sendNotification(a,o),c()}))},500);break;case 7:case 9:case 11:case 12:case 13:case 14:z.Timer.delay(function(){var b=o.content.in_reply_to;null!=d.dataStore.getQuestion(b)?d.sendNotification("ReloadData",v.command.ReloadDataType.Question(b,function(b){d.sendNotification(a,o),c()})):(d.sendNotification(a,o),c())},500);break;case 4:if(null!=o.content.file_id){var r=new v.entity.FileInfo;r.messageId=o.id,r.talkId=o.talkId,r.userId=o.userId,r.updatedAt=o.createdAt,r.id=o.content.file_id,r.name=o.content.name,r.contentType=o.content.content_type,r.contentSize=o.content.content_size,r.url=o.content.url,r.thumbUrl=o.content.thumbnail_url,this.sendNotification("notify_create_attachment",r)}this.sendNotification(a,o),c();break;case 5:for(var s=o.content.files,t=0;t<s.length;){var u=s[t];++t;var y=new v.entity.FileInfo;y.messageId=o.id,y.talkId=o.talkId,y.userId=o.userId,y.updatedAt=o.createdAt,y.id=u.file_id,y.name=u.name,y.contentType=u.content_type,y.contentSize=u.content_size,y.url=u.url,y.thumbUrl=u.thumbnail_url,this.sendNotification("notify_create_attachment",y)}this.sendNotification(a,o),c();break;case 0:var A=o.content,B=null,C=A.type;switch(C){case"delete_talker":B=A.deleted_user_id;break;case"hide_pair_talk":B=A.user_id}if(null==B)return this.sendNotification(a,o),void c();for(var D=o.talkId,F=this.dataStore.getQuestions(D,B),G=0;G<F.length;){var H=F[G];++G,H.closed=!0,this.sendNotification("notify_update_question",H)}this.sendNotification(a,o),c();break;default:this.sendNotification(a,o),c()}break;case"notify_update_read_statuses":var I=new v.entity.MessageReadStatusesUpdate(b),J=this.updateTalkStatus(I);null!=J&&this.sendNotification("notify_update_local_talk_status",J),this.sendNotification(a,I),c();break;case"notify_update_talk_status":var K=new v.entity.TalkStatusUpdate(b),L=this.dataStore.getTalkStatus(K.talkId);null!=L&&(null==L.maxEveryoneReadMessageId||z.Int64.compare(L.maxEveryoneReadMessageId,K.maxEveryoneReadMessageId)<0)&&(L.maxEveryoneReadMessageId=K.maxEveryoneReadMessageId,this.dataStore.setTalkStatus(L),this.sendNotification("notify_update_local_talk_status",L)),this.sendNotification(a,K),c();break;case"notify_create_announcement":var M=new v.entity.Announcement(b);this.sendNotification("notify_update_announcement_status",this.newAnnouncementStatus(M)),this.sendNotification(a,M),c();break;case"notify_update_announcement_status":var N=new v.entity.AnnouncementStatusUpdate(b),O=this.dataStore.getAnnouncementStatus(N.domainId);null==O&&(O=this.assureAnnouncementStatus(N.domainId)),O.updateRead(N),this.dataStore.setAnnouncementStatus(O),this.sendNotification(a,N),c();break;case"notify_delete_attachment":var P=new v.entity.FileInfoDeletion(b);this.sendNotification(a,P),c();break;case"notify_leave_domain":var Q=b;this.dataStore.removeDomain(Q),this.sendNotification(a,Q),c();break;case"notify_delete_domain_invite":var R=b;this.dataStore.removeDomainInvite(R),this.sendNotification(a,R),c();break;case"notify_delete_friend":this.dataStore.removeFriend(b[0],b[1]),this.sendNotification(a,b),c();break;case"notify_delete_acquaintance":this.dataStore.removeAcquaintance(b[0],b[1]),this.sendNotification(a,b),c();break;case"notify_delete_talk":this.dataStore.removeTalk(b),this.dataStore.removeTalkStatus(b),this.sendNotification("brand_badge_changed"),this.sendNotification("SelectTalk",null),this.sendNotification(a,b),c();break;case"notify_add_account_control_request":var S=new v.entity.AccountControlRequest(b);this.dataStore.setAccountControlRequest(S),this.sendNotification(a,S),c();break;case"notify_delete_account_control_request":var T;T=w.Boot.__instanceof(b,z.Int64)?b:z.Int64.ofInt(w.Boot.__cast(b,E)),this.dataStore.removeAccountControlRequest(T),this.sendNotification(a,T),c();break;case"notify_join_account_control_group":var U=new v.entity.AccountControlGroup(b);this.dataStore.setAccountControlGroup(U),this.dataStore.removeAccountControlRequests(),this.sendNotification("brand_badge_changed"),this.sendNotification(a,U),c();break;case"notify_update_account_control_group":var V=new v.entity.AccountControlGroupPartialUpdate(b);this.dataStore.updateAccountControlGroup(V),this.sendNotification(a,V),c();break;case"notify_leave_account_control_group":var W=b;this.dataStore.removeAccountControlGroup(W),this.sendNotification(a,W),c();break;default:this.sendNotification(a,b),c()}},newTalkStatusByMessage:function(a){var b=this.dataStore.getTalkStatus(a.talkId);return null==b&&(b=new v.entity.TalkStatus,b.id=a.talkId),(null==b.maxMessageId||z.Int64.compare(b.maxMessageId,a.id)<0)&&(b.maxMessageId=a.id,b.maxMessage=a),!this.dataStore.isMe(a.userId)&&a.isUnreadCountTarget&&b.unreadCount++,this.dataStore.setTalkStatus(b),b},updateTalkStatus:function(a){var b=this;if(!j.exists(a.readUserIds,function(a){return b.dataStore.isMe(a)}))return null;var c=this.dataStore.getTalkStatus(a.talkId);if(null==c)return x._e(x.dateStr(),"talkStatus is not found.","","","",""),null;for(var d=a.messageIds[0],e=0,f=a.messageIds;e<f.length;){var g=f[e];++e,(null==c.maxReadMessageId||z.Int64.compare(c.maxReadMessageId,g)<0)&&(z.Int64.compare(d,g)<0&&(d=g),v.Int64Helper.contains(a.messageIdsExcludingUnreadCountTargets,g)||c.unreadCount--)}return(null==c.maxReadMessageId||z.Int64.compare(c.maxReadMessageId,d)<0)&&(c.maxReadMessageId=d,this.dataStore.setTalkStatus(c)),c},newAnnouncementStatus:function(a){var b=this.dataStore.getAnnouncementStatus(a.domainId);return null==b&&(b=new v.entity.AnnouncementStatus,b.domainId=a.domainId),(null==b.maxAnnouncementId||z.Int64.compare(b.maxAnnouncementId,a.id)<0)&&(b.maxAnnouncementId=a.id,b.maxAnnouncement=a),null==b.unreadCount&&(b.unreadCount=0),b.unreadCount++,this.dataStore.setAnnouncementStatus(b),b},assureAnnouncementStatus:function(a){var b=this.dataStore.getAnnouncementStatus(a);return null==b&&(b=new v.entity.AnnouncementStatus,b.domainId=a,b.unreadCount=0,this.dataStore.setAnnouncementStatus(b)),b},__class__:v.proxy.AlberoBroadcastProxy}),v.proxy.AlberoServiceProxy=function(){this.mockMsgId=new z.Int64(-1,-1),u.patterns.proxy.Proxy.call(this,"api"),this.updateReadStatusesTimers=new z.ds.StringMap,
this.updateReadAnnouncementStatusesTimers=new z.ds.StringMap,this.createSessionCount=0},e["albero.proxy.AlberoServiceProxy"]=v.proxy.AlberoServiceProxy,v.proxy.AlberoServiceProxy.__name__=["albero","proxy","AlberoServiceProxy"],v.proxy.AlberoServiceProxy.__super__=u.patterns.proxy.Proxy,v.proxy.AlberoServiceProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{createAccessToken:function(a,b){var c,d,e=this,f=this.settings.getOs(),g=this.settings.getIDFV(),h=a.split("$");-1==a.indexOf("@")&&2==h.length?(c="create_access_token_by_id",d=[h[1],h[0],b,g,f,""]):(c="create_access_token",d=[a,b,g,f,""]),this.rpc.call(c,d,function(a){x._d(x.dateStr(),"access token:"+a,"","","",""),e.settings.setAccessToken(a),e.createSession(a)},function(a){e.sendNotification("Url",v.command.UrlAction.FORWARD(v.Urls.error))})},authorizeDevice:function(a,b){var c=this.settings.getIDFV();this.rpc.call("authorize_device",[a,c],function(a){b()})},createSession:function(a){var b=this;this.rpc.call("create_session",[a,"1.76"],function(a){var c=new v.entity.PasswordExpiration(a.password_expiration),d=v.DateHelper.nowAsInt64();if(null!=c.expiration&&z.Int64.compare(d,c.expiration)>0)return void b.sendNotification("password_expiration_overed");var e=b.settings.getPasswordWarningSkipUntil();(null==e||z.Int64.compare(d,e)>0)&&null!=c.warning&&z.Int64.compare(d,c.warning)>0&&(b.settings.setPasswordWarningSkipUntil(v.DateHelper.oneDayAfterAsInt64()),b.sendNotification("password_expiration_warned")),b.dataRecoverd=a.notification&&b.dataStore.isMe(a.user.user_id),b.dataStore.setMe(new v.entity.Me(a.user)),b.settings.setConfiguration(new v.entity.Configuration(a.configuration));var f=function(){b.dataRecoverd=!0;var c=a.configuration.bot_expired_version;if(x._d(x.dateStr(),"bot_expired_version",c,"","",""),null!=c){var d=w.Node.require("../../package.json").version;if(x._d(x.dateStr(),"current",d,"","",""),null!=d){var e=c.split("."),f=d.split(".");3==e.length&&3==f.length&&1e4*(o.parseFloat(e[0])-o.parseFloat(f[0]))+100*(o.parseFloat(e[1])-o.parseFloat(f[1]))+(o.parseFloat(e[2])-o.parseFloat(f[2]))>=0&&w.Node.process.stderr.write("-----------------------------------------\nCurrent version is expired! (current: "+d+")\nRun 'npm install direct-js' to update\n-----------------------------------------\n")}}b.sendNotification("data_recovered"),b.rpc.call("start_notification",[],function(a){var c=a;c||(b.dataStore.clear(!0),x._e(x.dateStr(),"start_notification failed.","","","",""),w.Node.process.exit(1))})};b.dataRecoverd?(b.recoverDataNotifications(),f()):(b.dataStore.clear(!1),b.recoverData(f)),b.createSessionCount++},function(a){if(null!=a){if(401==a.code&&"expired password"==a.message)return void b.sendNotification("password_expiration_overed");if(401==a.code&&"unauthorized device"==a.message)return void b.sendNotification("Device",v.command.DeviceAction.AUTHORIZE);b.rpc.onServerError("create_session",a)}b.settings.clearAccessToken(),b.sendNotification("Url",v.command.UrlAction.FORWARD(v.Urls.error))})},recoverData:function(a){var b=this;this.rpc.call("reset_notification",[],function(c){var d=0,e=function(){d++,6==d&&b.getAllUserEmails(a)};b.getDomains(function(){var a=b.dataStore.getDomains(),c=0,d=function(){c++,c==a.length&&e()};a.length>0?b.getAnnouncementStatuses(d):e();var f=0,g=function(){f++,2==f&&(b.getTalks(e),b.getTalkInvites(e))};b.getFriends(g),b.getAcquaintances(g)}),b.getDomainInvites(e),b.getAccountControlRequests(e),b.getJoinedAccountControlGroup(e)})},recoverDataNotifications:function(){var a=this.dataStore.getDomains();a.sort(function(a,b){return z.Int64.compare(b.id,a.id)}),this.sendDomainNotifications(a);for(var b=0;b<a.length;){var c=a[b];++b;var d=this.dataStore.getAnnouncementStatus(c.id);null==d&&(d=new v.entity.AnnouncementStatus,d.domainId=c.id,d.unreadCount=0,this.dataStore.setAnnouncementStatus(d)),this.sendAnnouncementStatusNotification(d);for(var e=0,f=this.dataStore.getFriends(c.id);e<f.length;){var g=f[e];++e,this.sendNotification("notify_add_friend",g)}for(var h=0,i=this.dataStore.getAcquaintances(c.id);h<i.length;){var j=i[h];++h,this.sendNotification("notify_add_acquaintance",j)}}this.sendTalkNotifications(this.dataStore.getTalks()),this.sendTalkStatusNotifications(this.dataStore.getTalkStatuses());for(var k=0,l=this.dataStore.getDomainInvites();k<l.length;){var m=l[k];++k,this.sendNotification("notify_add_domain_invite",m)}for(var n=0,o=this.dataStore.getAccountControlRequests();n<o.length;){var p=o[n];++n,this.sendNotification("notify_add_account_control_request",p)}var q=this.dataStore.getAccountControlGroup();null!=q&&this.sendNotification("notify_join_account_control_group",q)},sendDomainNotifications:function(a){a.reverse();for(var b=0;b<a.length;){var c=a[b];++b,this.sendNotification("notify_update_domain",[null,c])}},sendAnnouncementStatusNotification:function(a){var b=new v.entity.AnnouncementStatusUpdate;b.domainId=a.domainId,this.sendNotification("notify_update_announcement_status",b)},sendTalkNotification:function(a){var b;b=a.type==v.entity.TalkType.PairTalk?"notify_create_pair_talk":"notify_create_group_talk",this.sendNotification(b,a)},sendTalkNotifications:function(a){var b=this;a.sort(function(a,c){var d,e=b.dataStore.getTalkStatus(a.id);d=null!=e?e.maxMessage:null;var f;f=null!=d?d.createdAt:null,(null==f||z.Int64.compare(f,a.updatedAt)<0)&&(f=a.updatedAt);var g,h=b.dataStore.getTalkStatus(c.id);g=null!=h?h.maxMessage:null;var i;return i=null!=g?g.createdAt:null,(null==i||z.Int64.compare(i,c.updatedAt)<0)&&(i=c.updatedAt),z.Int64.compare(f,i)});for(var c=0;c<a.length;){var d=a[c];++c,this.sendTalkNotification(d)}},sendTalkStatusNotifications:function(a){for(var b=0;b<a.length;){var c=a[b];++b,this.sendNotification("notify_update_local_talk_status",c)}},deleteSession:function(){this.settings.clearSelectedStampTabId(),this.settings.clearDomainSelection(),this.settings.clearAccessToken(),this.rpc.restart()},updateUser:function(a,b,c,d,e){var f=this,g=function(b){f.rpc.call("update_user",[a,b,d,e],function(a){f.dataStore.setMe(new v.entity.Me(a)),f.sendNotification("update_user_responsed",f.dataStore.me)})};if(null!=c)g(c);else if(null!=b){var h=function(a){};this.uploadFile(b,null,v.proxy._AlberoServiceProxy.UploadUseType.PROFILE_IMAGE,function(a){g(a.get_url)},h)}else g()},updateProfile:function(a){for(var b=this,c=new Array,d=0;d<a.length;){var e=a[d];++d;var f=new Array;f.push(e.domainId);for(var g=new Array,h=0,i=e.profileItemValues;h<i.length;){var j=i[h];++h,g.push({profile_item_id:j.profileItemId,value:j.value})}f.push(g),c.push(f)}this.rpc.call("update_profile",[c],function(a){x._d(x.dateStr(),"update_profile_succeed",a,"","",""),b.dataStore.setMe(new v.entity.Me(a)),b.sendNotification("update_profile_responsed",b.dataStore.me)})},addFriend:function(a){var b=this.settings.getSelectedDomainId();this.rpc.call("add_friend",[b,a.id])},deleteFriend:function(a){var b=this.settings.getSelectedDomainId();this.rpc.call("delete_friend",[b,a.id])},getFriends:function(a){var b=this;this.rpc.call("get_friends",[],function(c){for(var d=0;d<c.length;){var e=c[d];++d;for(var f=e[1],g=0;g<f.length;){var h=f[g];++g;var i=new v.entity.DomainUser(h);b.dataStore.addFriend(i),b.sendNotification("notify_add_friend",i)}}null!=a&&a()})},getAcquaintances:function(a){var b=this;this.rpc.call("get_acquaintances",[],function(c){for(var d=0;d<c.length;){var e=c[d];++d;for(var f=e[1],g=0;g<f.length;){var h=f[g];++g;var i=new v.entity.DomainUser(h);b.dataStore.addAcquaintance(i),b.sendNotification("notify_add_acquaintance",i)}}null!=a&&a()})},getAllUsers:function(a){var b=this,c=this.settings.getSelectedDomainId(),d=40,e=14;this.rpc.call("get_domain_users",[c,e,d,a],function(a){var d,e=new Array,f=0;for(d=w.Boot.__cast(a.contents,Array);f<d.length;){var g=d[f];++f,e.push(new v.entity.DomainUser(g))}b.dataStore.setUsersIfLatest(c,e),b.sendNotification("get_domain_users_responsed",[c,a.marker,a.next_marker,e])})},getUsers:function(a,b){var c=this;this.rpc.call("get_users",[a,b],function(b){var d,e=new Array,f=0;for(d=w.Boot.__cast(b,Array);f<d.length;){var g=d[f];++f,e.push(new v.entity.DomainUser(g))}c.dataStore.setUsersIfLatest(a,e),c.sendNotification("get_users_responsed",[a,e])})},getProfile:function(a,b){var c=this;this.rpc.call("get_profile",[a,b],function(a){var b=new v.entity.Profile(a);c.sendNotification("get_profile_responsed",b)})},searchDomainUsers:function(a,b){var c=this,d=this.settings.getSelectedDomainId(),e=40,f=14;this.rpc.call("search_domain_users",[d,a,f,e,b],function(b){var e,f=new Array,g=0;for(e=w.Boot.__cast(b.contents,Array);g<e.length;){var h=e[g];++g,f.push(new v.entity.DomainUser(h))}c.dataStore.setUsersIfLatest(d,f),c.sendNotification("get_domain_users_responsed",[d,b.marker,b.next_marker,f,a])})},getUserEmails:function(a,b,c){var d=this,e=100;0==b.length?null!=c&&c():this._getUserEmails(a,b.slice(0,e),function(){d.getUserEmails(a,b.slice(e),c)})},_getUserEmails:function(a,b,c){var d=this;this.rpc.call("get_user_emails",[a,b],function(e){for(var f=0,g=b.length;g>f;){var h=f++,i=d.dataStore.getUser(a,b[h]);null!=i&&(i.email=e[h])}null!=c&&c()})},getAllUserEmails:function(a){var b=this,c=null,d=this.dataStore.getUsers();null==d&&(d=new Array);for(var e=0;e<d.length;){var f=d[e];if(++e,null==f.email){var g=v.Int64Helper.idStr(f.domainId);null==c&&(c=new z.ds.StringMap);var h=c.get(g);null==h&&(h=new Array,c.set(g,h)),h.push(f.id)}}if(null==c)a();else{var i=c.keys(),j=null;j=function(){if(i.hasNext()){var d=i.next();b.getUserEmails(v.Int64Helper.makeFromIdStr(d),c.get(d),j)}else a()},j()}},getDomains:function(a){var b=this;this.rpc.call("get_domains",[],function(c){for(var d=0;d<c.length;){var e=c[d];++d,b.newDomain(e)}b.sendDomainNotifications(b.dataStore.getDomains()),null!=a&&a()})},leaveDomain:function(a){var b=this;this.rpc.call("leave_domain",[a.id],function(a){b.dataStore.removeDomain(a)})},getDomainInvites:function(a){var b=this;this.rpc.call("get_domain_invites",[],function(c){for(var d=0;d<c.length;){var e=c[d];++d,b.sendNotification("notify_add_domain_invite",b.newDomainInvite(e))}null!=a&&a()})},acceptDomainInvite:function(a){this.callApiReliable("accept_domain_invite",[a],function(a){})},deleteDomainInvite:function(a){this.callApiReliable("delete_domain_invite",[a],function(a){})},getAccountControlRequests:function(a){var b=this;this.rpc.call("get_account_control_requests",[],function(c){for(var d=0;d<c.length;){var e=c[d];++d,b.sendNotification("notify_add_account_control_request",b.newAccountControlRequest(e))}null!=a&&a()})},acceptAccountControlRequest:function(a){if(null!=a){var b=this.dataStore.getAccountControlRequest(a);null!=b&&this.rpc.call("accept_account_control_request",[b.id,b.version],function(a){})}},rejectAccountControlRequest:function(a){if(null!=a){var b=this.dataStore.getAccountControlRequest(a);null!=b&&this.rpc.call("reject_account_control_request",[b.id,b.version],function(a){})}},getJoinedAccountControlGroup:function(a){var b=this;this.rpc.call("get_joined_account_control_group",[],function(c){for(var d=0;d<c.length;){var e=c[d];++d,b.sendNotification("notify_join_account_control_group",b.newAccountControlGroup(e))}null!=a&&a()})},getTalks:function(a){var b=this;this.rpc.call("get_talks",[],function(c){for(var d=0;d<c.length;){var e=c[d];++d,b.newTalk(e)}b.rpc.call("get_talk_statuses",[],function(c){for(var d=0;d<c.length;){var e=c[d];++d,b.newTalkStatus(e)}b.sendTalkNotifications(b.dataStore.getTalks()),b.sendTalkStatusNotifications(b.dataStore.getTalkStatuses()),null!=a&&a()})})},getTalkStatuses:function(){var a=this,b=function(b){var c=a.dataStore.getTalk(b.id);null!=c&&a.sendNotification("notify_update_local_talk_status",b)};this.rpc.call("get_talk_statuses",[],function(c){for(var d=0;d<c.length;){var e=c[d];++d,b(a.newTalkStatus(e))}})},getReadStatus:function(a,b){var c=this;this.rpc.call("get_read_status",[a,b],function(a){c.sendNotification("notify_get_message_status",new v.entity.MessageReadStatus(a))})},createTalk:function(a,b){var c=this;if(null==a&&(a=this.settings.getSelectedDomainId()),0!=b.length){var d,e=1==b.length;d=e?"create_pair_talk":"create_group_talk";var f;f=e?[a,b.pop()]:[a,b],this.rpc.call(d,f,function(a){var b=c.newTalk(a);c.settings.setSelectedTalk(b)})}},updateGroupTalk:function(a,b,c,d){var e=this;if(a.type==v.entity.TalkType.GroupTalk){var f=function(c){e.rpc.call("update_group_talk",[a.id,b,c],function(a){e.sendNotification("notify_update_group_talk",e.newTalk(a))})};if(null!=d)f(d);else if(null!=c){var g=function(a){};this.uploadFile(c,a.domainId,v.proxy._AlberoServiceProxy.UploadUseType.TALK_ICON,function(a){f(a.get_url)},g)}else f()}},addTalkers:function(a,b){var c=this;if(a.type==v.entity.TalkType.PairTalk){var d=a.userIds.concat(b);return v.Int64Helper.remove(d,this.dataStore.me.id),void this.createTalk(null,d)}0!=b.length&&this.rpc.call("add_talkers",[a.id,b],function(a){c.sendNotification("notify_add_talkers",c.newTalk(a))})},deleteTalker:function(a,b){var c=this,d=null,e=null;this.dataStore.isMe(b)&&(d=a,e=this.dataStore.getTalkStatus(a.id),this.dataStore.removeTalk(a.id),this.dataStore.removeTalkStatus(a.id)),this.rpc.call("delete_talker",[a.id,b],function(d){v.Int64Helper.remove(a.userIds,b),c.sendNotification("notify_delete_talker",c.dataStore.setTalk(a))},function(a){null!=d&&c.dataStore.setTalk(d),null!=e&&c.dataStore.setTalkStatus(e),c.sendNotification("error_occurred",a)})},inviteTalker:function(a,b){this.rpc.call("add_talk_invite",[a.id,b],function(a){})},getTalkInvites:function(a){var b=this;this.rpc.call("get_talk_invites",[],function(c){for(var d=0;d<c.length;){var e=c[d];++d,b.acceptTalkInvite(e.talk_id)}null!=a&&a()})},acceptTalkInvite:function(a){this.rpc.call("accept_talk_invite",[a],function(a){})},deleteTalkInvite:function(a){this.rpc.call("delete_talk_invite",[a],function(a){})},getMessages:function(a,b,c){var d=this,e=20;null==b&&(b={sinceId:null,maxId:null}),null==c&&(c=2),this.rpc.call("get_messages",[a.id,e,b.sinceId,b.maxId,c],function(b){for(var e=new Array,f=0;f<b.length;){var g=b[f];++f,e.push(d.newMessage(g))}d.sendNotification("notify_get_messages",{talkId:a.id,messages:e,sortOrder:c})})},createMessage:function(a,b,c,d){var e=this,f=this.newDummyMessage(a,b,c);if(null==this.dataStore.getTalk(a)){var g={code:400,message:"invalid talk_id (deleted talk)"};return x._w(x.dateStr(),"WARNING method: create_message",g,"","",""),void this.sendNotification("create_message_fail",[g,f],d)}this.sendNotification("create_message_start",f),this.rpc.call("create_message",[a,v.entity.Message.enumIndex(b),c],function(a){e.sendNotification("create_message_complete",[e.newMessage(a),f.id],d)},function(a){e.sendNotification("create_message_fail",[a,f],d),e.sendNotification("error_occurred",a)})},updateReadStatuses:function(a,b){var c=this,d=this.dataStore.getTalkStatus(a);if(null!=d){if(null==b){if(0==d.unreadCount)return;b=d.maxMessageId}else if(null!=d.maxReadMessageId&&z.Int64.compare(d.maxReadMessageId,b)>=0)return;d.unreadCount=0,d.maxReadMessageId=b,this.dataStore.setTalkStatus(d),this.sendNotification("notify_update_local_talk_status",d);var e="_"+a.high+"_"+a.low,f=this.updateReadStatusesTimers.get(e);null!=f&&f.stop(),f=z.Timer.delay(function(){c.updateReadStatusesTimers.remove(e);var d=c.dataStore.getTalkStatus(a);null!=d&&c.rpc.call("update_read_statuses",[a,b],function(a){})},1e3),this.updateReadStatusesTimers.set(e,f)}},upload:function(a,b,c,d){var e=this;v.js.TextCanonicalizer.assureNormalize(function(f){var g=f(c.name),h={content_type:c.type,content_size:c.size,name:g,file:c},i=e.newDummyMessage(b,v.entity.MessageType.file,h),j=function(a){e.sendNotification("create_message_fail",[a,i],d)},k=e.fileService.getBlobFromUpdatableFile(c);e.uploadThumbnail(k,a,b,i,function(f){e.uploadFile(c,a,v.proxy._AlberoServiceProxy.UploadUseType.MESSAGE,function(a){var h={url:a.get_url,content_type:c.type,content_size:c.size,name:g,file_id:a.file_id};null!=f&&(h.thumbnail_url=f.get_url),e.createMessageReliable(b,v.entity.MessageType.file,h,i,d)},j)},j)})},uploadMulti:function(a,b,c,d,e){var f=this;v.js.TextCanonicalizer.assureNormalize(function(g){var h=f.newDummyMessage(b,v.entity.MessageType.textMultipleFile,{text:c,files:j.array(d.map(function(a){var b=g(a.name),c={content_type:a.type,content_size:a.size,name:b,file:a};return c}))});f.sendNotification("create_message_start",h);var k=function(a){f.sendNotification("create_message_fail",[a,h],e)},l=new Array,m=function(){if(l.length==d.length){var a={files:l};null!=c&&c.length>0&&(a.text=c),f.createMessageReliable(b,v.entity.MessageType.textMultipleFile,a,h,e)}},n=null;(n=function(c){if(c.hasNext()){var d=c.next(),e=f.fileService.getBlobFromUpdatableFile(d);f.uploadThumbnail(e,a,b,null,function(b){f.uploadFile(d,a,v.proxy._AlberoServiceProxy.UploadUseType.MESSAGE,function(a){var e=g(d.name),f={url:a.get_url,content_type:d.type,content_size:d.size,name:e,file_id:a.file_id};null!=b&&(f.thumbnail_url=b.get_url),l.push(f),n(c)},k)},k)}else m()})(i.iter(d))})},createMessageReliable:function(a,b,c,d,e){var f=this;this.callApiReliable("create_message",[a,v.entity.Message.enumIndex(b),c],function(a){f.sendNotification("create_message_complete",[f.newMessage(a),d.id],e)},function(a){f.sendNotification("create_message_fail",[a,d],e),f.sendNotification("error_occurred",a)},function(a){return 500==a.code&&"Internal Error (IllegalStateException)"==a.message})},uploadThumbnail:function(a,b,c,d,e,f){var g=this;this.fileService.createThumbnail(a,function(a){null!=d&&(d.content.thumbnail_file=a,g.sendNotification("create_message_start",d)),null!=a?g.uploadFile(a,b,v.proxy._AlberoServiceProxy.UploadUseType.THUMBNAIL,e,f):e(null)})},uploadFile:function(a,b,c,d,e){var f,g=this;switch(c[1]){case 0:f=0;break;case 1:f=1;break;case 2:f=2;break;case 3:f=4}v.js.TextCanonicalizer.assureNormalize(function(c){var h=c(a.name);g.rpc.call("create_upload_auth",[h,a.type,a.size,b,f],function(b){g.fileService.upload(b,a.type,a,function(){d(b)},e)},function(a){if(null!=a)if(502==a.code){var b=g.fileService.createByteSizeStringWithUnit(a.detail.limit_max);g.sendNotification("error_occurred",{message:"サイズが "+b+" を超えるファイルは使用できません"})}else g.sendNotification("error_occurred",a);e(a)})})},deleteAttachment:function(a,b){this.rpc.call("delete_attachment",[a,b])},getAttachments:function(a,b){var c=this,d=20;null==b&&(b={sinceId:null,maxId:null}),this.rpc.call("get_attachments",[a.id,d,b.sinceId,b.maxId],function(b){for(var d=new Array,e=0;e<b.length;){var f=b[e];++e,d.push(c.newFileInfo(f))}c.sendNotification("get_file_responsed",{talkId:a.id,files:d})})},createAnnouncement:function(a,b,c,d){var e=this;if(null!=a||(a=this.settings.getSelectedDomainId(),null!=a)){var f=this.newDummyMessage(null,b,c);this.sendNotification("create_announcement_start",f),this.rpc.call("create_announcement",[a,v.entity.Message.enumIndex(b),c],function(a){e.sendNotification("create_announcement_complete",[e.newAnnouncement(a),f.id],d)},function(a){e.sendNotification("create_announcement_fail",f),e.sendNotification("error_occurred",a)})}},getAnnouncements:function(a,b){var c=this,d=20,e=this.settings.getSelectedDomainId();return null==e?void(null!=b&&b()):(null==a&&(a={sinceId:null,maxId:null}),void this.rpc.call("get_announcements",[e,d,a.sinceId,a.maxId],function(a){for(var b=new Array,d=0;d<a.length;){var f=a[d];++d,b.push(new v.entity.Announcement(f))}c.sendNotification("notify_get_announcements",{domainId:e,announcements:b})}))},getAnnouncementStatuses:function(a){var b=this;this.rpc.call("get_announcement_statuses",[],function(c){for(var d=0;d<c.length;){var e=c[d];++d;var f=b.newAnnouncementStatus(e);b.sendAnnouncementStatusNotification(f),null!=a&&a()}})},getAnnouncementStatus:function(a,b){var c=this;this.rpc.call("get_announcement_status",[a],function(a){var d=c.newAnnouncementStatus(a);c.sendAnnouncementStatusNotification(d),null!=b&&b()})},updateAnnouncementReadStatus:function(a){var b=this,c=this.dataStore.getAnnouncementStatus(a);if(null!=c&&0!=c.unreadCount){c.unreadCount=0,c.maxReadAnnouncementId=c.maxAnnouncementId,this.dataStore.setAnnouncementStatus(c),this.sendAnnouncementStatusNotification(c);var d="_"+a.high+"_"+a.low,e=this.updateReadAnnouncementStatusesTimers.get(d);null!=e&&e.stop(),e=z.Timer.delay(function(){b.updateReadAnnouncementStatusesTimers.remove(d),b.rpc.call("update_announcement_status",[a,c.maxAnnouncementId],function(a){})},1e3),this.updateReadAnnouncementStatusesTimers.set(d,e)}},getQuestions:function(a,b,c,d){var e=this,f=20,g=this.settings.getSelectedDomainId(),h=null;null!=a&&(g=a.domainId,h=a.id);var i;switch(b[1]){case 0:i=0;break;case 1:i=1}var j;switch(c[1]){case 0:j=!0;break;case 1:j=!1;break;case 2:j=null}null==d&&(d={sinceId:null,maxId:null}),this.rpc.call("get_actions",[g,h,i,j,f,d.sinceId,d.maxId],function(a){for(var d=new Array,f=0;f<a.length;){var i=a[f];++f,d.push(e.newQuestion(i))}e.sendNotification("get_questions_responsed",{domainId:g,talkId:h,questions:d,fromType:b,filter:c})})},getQuestion:function(a,b){var c=this;this.callApiReliable("get_action",[a],function(a){var d=c.newQuestion(a);c.sendNotification("notify_update_question",d),null!=b&&b(d)})},search:function(a,b,c,d){var e=this;this.searchService.prepareForSearching(a,c);var f=a.getQueryText(),g=function(f){return 400==f.code&&null!=c?void e.search(a,b,null,d):void e.sendNotification("error_occurred",f)},h=a.searchType;switch(h[1]){case 0:x._d(x.dateStr(),"call search_messages, query=%s",f,"","",""),this.rpc.call("search_messages",[a.domainId,a.talkId,f,b,c],function(b){e.searchService.isRecentParams(a)&&e.searchService.isSearching()&&e.searchService.saveSearchMessagesResult(new v.entity.SearchMessagesResult(b)),null!=d&&d()},function(a){e.searchService.notifySearchMessagesFail(),g(a)});break;case 1:x._d(x.dateStr(),"call search_attachments, query=%s",f,"","",""),this.rpc.call("search_attachments",[a.domainId,a.talkId,f,b,c],function(b){e.searchService.isRecentParams(a)&&e.searchService.isSearching()&&e.searchService.saveSearchAttachmentsResult(new v.entity.SearchAttachmentsResult(b)),null!=d&&d()},function(a){e.searchService.notifySearchAttachmentsFail(),g(a)})}},newDomain:function(a){return this.dataStore.setDomain(new v.entity.Domain(a))},newDomainInvite:function(a){return this.dataStore.setDomainInvite(new v.entity.DomainInvite(a))},newTalk:function(a){return this.dataStore.setTalk(new v.entity.Talk(a))},newTalkStatus:function(a){return this.dataStore.setTalkStatus(new v.entity.TalkStatus(a))},newMessage:function(a){return new v.entity.Message(a)},newDummyMessage:function(a,b,c){var d=new v.entity.Message;return d.id=this.mockMsgId,d.userId=this.dataStore.me.id,d.talkId=a,d.type=b,d.content=c,this.mockMsgId=v.Int64Helper.decrement(this.mockMsgId),d},newQuestion:function(a){return this.dataStore.setQuestion(new v.entity.Question(a))},newFileInfo:function(a){return new v.entity.FileInfo(a)},newAnnouncement:function(a){return new v.entity.Announcement(a)},newAnnouncementStatus:function(a){return this.dataStore.setAnnouncementStatus(new v.entity.AnnouncementStatus(a))},newAccountControlRequest:function(a){return this.dataStore.setAccountControlRequest(new v.entity.AccountControlRequest(a))},newAccountControlGroup:function(a){return this.dataStore.setAccountControlGroup(new v.entity.AccountControlGroup(a))},callApiReliable:function(a,b,c,d,e){var f=this;null==e&&(e=function(a){return 404==a.code});var g=null;(g=function(h){f.rpc.call(a,b,c,function(b){return e(b)&&0!=h?void z.Timer.delay(function(){g(h-1)},1e3):void(null==d?f.rpc.onServerError(a,b):d(b))})})(3)},__class__:v.proxy.AlberoServiceProxy}),v.proxy._AlberoServiceProxy={},v.proxy._AlberoServiceProxy.UploadUseType=e["albero.proxy._AlberoServiceProxy.UploadUseType"]={__ename__:["albero","proxy","_AlberoServiceProxy","UploadUseType"],__constructs__:["PROFILE_IMAGE","MESSAGE","TALK_ICON","THUMBNAIL"]},v.proxy._AlberoServiceProxy.UploadUseType.PROFILE_IMAGE=["PROFILE_IMAGE",0],v.proxy._AlberoServiceProxy.UploadUseType.PROFILE_IMAGE.toString=f,v.proxy._AlberoServiceProxy.UploadUseType.PROFILE_IMAGE.__enum__=v.proxy._AlberoServiceProxy.UploadUseType,v.proxy._AlberoServiceProxy.UploadUseType.MESSAGE=["MESSAGE",1],v.proxy._AlberoServiceProxy.UploadUseType.MESSAGE.toString=f,v.proxy._AlberoServiceProxy.UploadUseType.MESSAGE.__enum__=v.proxy._AlberoServiceProxy.UploadUseType,v.proxy._AlberoServiceProxy.UploadUseType.TALK_ICON=["TALK_ICON",2],v.proxy._AlberoServiceProxy.UploadUseType.TALK_ICON.toString=f,v.proxy._AlberoServiceProxy.UploadUseType.TALK_ICON.__enum__=v.proxy._AlberoServiceProxy.UploadUseType,v.proxy._AlberoServiceProxy.UploadUseType.THUMBNAIL=["THUMBNAIL",3],v.proxy._AlberoServiceProxy.UploadUseType.THUMBNAIL.toString=f,v.proxy._AlberoServiceProxy.UploadUseType.THUMBNAIL.__enum__=v.proxy._AlberoServiceProxy.UploadUseType,v.proxy.AppStateProxy=function(){u.patterns.proxy.Proxy.call(this,"appState")},e["albero.proxy.AppStateProxy"]=v.proxy.AppStateProxy,v.proxy.AppStateProxy.__name__=["albero","proxy","AppStateProxy"],v.proxy.AppStateProxy.__super__=u.patterns.proxy.Proxy,v.proxy.AppStateProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{start:function(){this.updateLastActivityAt(),this.checkInactiveInterval()},setAppState:function(a){var b="APP_STATE_CHANGED: "+o.string(a);x._d(x.dateStr(),b,"","","",""),this.appState=a,this.sendNotification("app_state_changed",this.appState)},updateLastActivityAt:function(){this.lastActivityAt=new Date},checkInactiveInterval:function(){var a=this;this.checkInactive(),z.Timer.delay(function(){a.checkInactiveInterval()},500)},checkInactive:function(){if(this.appState!=v.AppState.Inactive){var a=(new Date).getTime()-this.lastActivityAt.getTime();2e3>a||this.setAppState(v.AppState.Inactive)}},__class__:v.proxy.AppStateProxy}),v.proxy.DataStoreProxy=function(){u.patterns.proxy.Proxy.call(this,"dataStore"),this.init()},e["albero.proxy.DataStoreProxy"]=v.proxy.DataStoreProxy,v.proxy.DataStoreProxy.__name__=["albero","proxy","DataStoreProxy"],v.proxy.DataStoreProxy.__super__=u.patterns.proxy.Proxy,v.proxy.DataStoreProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{setMe:function(a){this.me=a;for(var b=0,c=this.getDomains();b<c.length;){var d=c[b];++b,this.sendNotification("notify_update_user",this.me.toDomainUser(d.id))}this.sendNotification("current_user_changed",a),this.storage.setDirtyFlag()},getMe:function(){return this.me},isMe:function(a){return null!=this.me&&v.Int64Helper.eq(this.me.id,a)},getFriends:function(a){var b=this.users.get("_"+a.high+"_"+a.low),c=[];if(null!=b)for(var d=b.iterator();d.hasNext();){var e=d.next();0==e.type&&c.push(e.user)}return c},getAcquaintances:function(a){var b=this.users.get("_"+a.high+"_"+a.low),c=[];if(null!=b)for(var d=b.iterator();d.hasNext();){var e=d.next();1==e.type&&c.push(e.user)}return c},isFriend:function(a,b){var c=this.users.get("_"+a.high+"_"+a.low);if(null!=c){var d=c.get("_"+b.high+"_"+b.low);return null!=d&&0==d.type}return!1},addFriend:function(a){var b=this.ensureDomainUserMap(a.domainId),c=v.Int64Helper.idStr(a.id);return b.set(c,{type:0,user:a}),this.storage.setDirtyFlag(),a},addAcquaintance:function(a){var b=this.ensureDomainUserMap(a.domainId),c=v.Int64Helper.idStr(a.id);return b.set(c,{type:1,user:a}),this.storage.setDirtyFlag(),a},ensureDomainUserMap:function(a){var b="_"+a.high+"_"+a.low,c=this.users.get(b);return null==c&&(c=new z.ds.StringMap,this.users.set(b,c)),c},setUserIfLatest:function(a,b){null==a&&(a=this.ensureDomainUserMap(b.domainId));var c,d=v.Int64Helper.idStr(b.id);if(c=a.get(d),null!=c){var e=z.Int64.compare(b.updatedAt,c.user.updatedAt);(2==c.type&&0!=e||e>1)&&(c.user=b,this.sendNotification("notify_update_user",b))}else{var f=v.Int64Helper.idStr(b.id);a.set(f,{type:2,user:b})}this.storage.setDirtyFlag()},setUsersIfLatest:function(a,b){for(var c=this.ensureDomainUserMap(a),d=0;d<b.length;){var e=b[d];++d,this.setUserIfLatest(c,e)}},removeFriend:function(a,b){var c=this.users.get("_"+a.high+"_"+a.low);if(null!=c){var d=c.get("_"+b.high+"_"+b.low);d.type=2}this.storage.setDirtyFlag()},removeAcquaintance:function(a,b){this.removeFriend(a,b)},getUser:function(a,b){if(null==b)return null;if(0==(b.high|b.low))return null;if(v.Int64Helper.eq(this.me.id,b))return this.me.toDomainUser(a);var c=this.users.get("_"+a.high+"_"+a.low);if(null!=c){var d=c.get("_"+b.high+"_"+b.low);if(null!=d)return d.user}return null},getUsers:function(a,b){var c=this,d=function(a,b){var d=c.users.get("_"+a.high+"_"+a.low);if(null!=d){if(null!=b)return b.map(function(b){if(0==(b.high|b.low))return null;if(v.Int64Helper.eq(c.me.id,b))return c.me.toDomainUser(a);var e=d.get("_"+b.high+"_"+b.low);return null!=e?e.user:null});for(var e=new Array,f=d.iterator();f.hasNext();)e.push(f.next().user);return e}return new Array};if(null!=a)return d(a,b);for(var e=this.domains.iterator(),f=null;e.hasNext();)f=null==f?d(e.next().id,b):f.concat(d(e.next().id,b));return f},getTalk:function(a){return this.talks.get("_"+a.high+"_"+a.low)},getValidPairTalk:function(a,b){var c=this;return null==this.me?null:j.find(this.getTalks(),function(d){return t.enumEq(d.type,v.entity.TalkType.PairTalk)&&v.Int64Helper.eq(d.domainId,b)&&j.exists(d.userIds,function(b){return null!=b&&null!=a&&b.high==a.high&&b.low==a.low})&&j.exists(d.userIds,function(a){return v.Int64Helper.eq(a,c.me.id)})?!0:!1})},setTalk:function(a){var b=v.Int64Helper.idStr(a.id);if(this.talks.set(b,a),null!=a.leftUsers)for(var c=this.ensureDomainUserMap(a.domainId),d=0,e=a.leftUsers;d<e.length;){var f=e[d];++d;var g=v.Int64Helper.idStr(f.id),h=c.get(g);null!=h?2==h.type&&z.Int64.compare(f.updatedAt,h.user.updatedAt)>0&&(h.user=f,this.sendNotification("notify_update_user",f)):(c.set(g,{type:2,user:f}),this.sendNotification("notify_update_user",f))}return this.storage.setDirtyFlag(),a},getTalks:function(){for(var a=new Array,b=this.talks.keys();b.hasNext();){var c=b.next();a.push(this.talks.get(c))}return a},setTalks:function(a){for(var b=0;b<a.length;){var c=a[b];++b,this.setTalk(c)}},removeTalk:function(a){if(null!=this.domainUnreadCounts){var b=this.talks.get("_"+a.high+"_"+a.low);if(null!=b){var c=v.Int64Helper.idStr(b.domainId);this.domainUnreadCounts.remove(c)}}this.talks.remove("_"+a.high+"_"+a.low),this.storage.setDirtyFlag()},getTalkStatuses:function(){for(var a=new Array,b=this.talkStatuses.keys();b.hasNext();){var c=b.next();this.talks.exists(c)&&a.push(this.talkStatuses.get(c))}return a},getTalkStatus:function(a){return this.talkStatuses.get("_"+a.high+"_"+a.low)},setTalkStatus:function(a){var b=v.Int64Helper.idStr(a.id);if(null!=this.domainUnreadCounts){var c=this.talks.get(b);if(null!=c){var d=v.Int64Helper.idStr(c.domainId);this.domainUnreadCounts.remove(d)}}return this.talkStatuses.set(b,a),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),a},removeTalkStatus:function(a){if(null!=this.domainUnreadCounts){var b=this.talks.get("_"+a.high+"_"+a.low);if(null!=b){var c=v.Int64Helper.idStr(b.domainId);this.domainUnreadCounts.remove(c)}}this.talkStatuses.remove("_"+a.high+"_"+a.low),this.storage.setDirtyFlag()},getDomains:function(){for(var a=new Array,b=this.domains.iterator();b.hasNext();){var c=b.next();a.push(c)}return a},getDomain:function(a){return this.domains.get("_"+a.high+"_"+a.low)},setDomain:function(a){var b=v.Int64Helper.idStr(a.id);return this.domains.set(b,a),this.storage.setDirtyFlag(),a},removeDomain:function(a){this.domains.remove("_"+a.high+"_"+a.low),this.storage.setDirtyFlag();for(var b=this.getTalks().filter(function(b){return v.Int64Helper.eq(b.domainId,a)}),c=0;c<b.length;){var d=b[c];++c,this.removeTalk(d.id),this.removeTalkStatus(d.id)}},getUnreadCount:function(){for(var a=0,b=this.domains.keys();b.hasNext();){var c=b.next();a+=this._getDomainUnreadCount(c)}return a+=this.getDomainInvitesCount()},_getDomainUnreadCount:function(a){if(null!=this.domainUnreadCounts&&this.domainUnreadCounts.exists(a))return this.domainUnreadCounts.get(a);null==this.domainUnreadCounts&&(this.domainUnreadCounts=new z.ds.StringMap);
for(var b=0,c=this.talkStatuses.iterator();c.hasNext();){var d=c.next();if(null!=d.unreadCount&&0!=d.unreadCount){var e,f=v.Int64Helper.idStr(d.id);e=this.talks.get(f),null!=e&&v.Int64Helper.idStr(e.domainId)==a&&(b+=d.unreadCount)}}var g=this.announcementStatuses.get(a);return null!=g&&null!=g.unreadCount&&(b+=g.unreadCount),this.domainUnreadCounts.set(a,b),b},getDomainUnreadCount:function(a){return null==a?0:this._getDomainUnreadCount("_"+a.high+"_"+a.low)},getDomainInvites:function(){for(var a=new Array,b=this.domainInvites.keys();b.hasNext();){var c=b.next();a.push(this.domainInvites.get(c))}return a},getDomainInvitesCount:function(){var a=0;if(null==this.accountControlGroup)for(var b=this.domainInvites.iterator();b.hasNext();){var c=b.next();null==c.accountControlRequestId&&a++}else for(var d=this.domainInvites.iterator();d.hasNext();){d.next();a++}return a},getDomainInvite:function(a){return this.domainInvites.get("_"+a.high+"_"+a.low)},setDomainInvite:function(a){var b=v.Int64Helper.idStr(a.id);return this.domainInvites.set(b,a),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),a},removeDomainInvite:function(a){this.domainInvites.remove("_"+a.high+"_"+a.low),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag()},getQuestions:function(a,b){var c=[];if(null!=this.questions)for(var d=this.questions.iterator();d.hasNext();){var e=d.next();v.Int64Helper.eq(e.talkId,a)&&v.Int64Helper.eq(e.userId,b)&&c.push(e)}return c},getQuestion:function(a){return this.questions.get("_"+a.high+"_"+a.low)},setQuestion:function(a){return a},getAnnouncementStatus:function(a){return this.announcementStatuses.get("_"+a.high+"_"+a.low)},setAnnouncementStatus:function(a){var b=v.Int64Helper.idStr(a.domainId);return this.announcementStatuses.set(b,a),null!=this.domainUnreadCounts&&this.domainUnreadCounts.remove(b),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag(),a},removeAnnouncementStatus:function(a){var b="_"+a.high+"_"+a.low;this.announcementStatuses.remove(b),null!=this.domainUnreadCounts&&this.domainUnreadCounts.remove(b),this.sendNotification("brand_badge_changed"),this.storage.setDirtyFlag()},getAccountControlRequests:function(){for(var a=new Array,b=this.accountControlRequests.iterator();b.hasNext();){var c=b.next();a.push(c)}return a},getAccountControlRequest:function(a){var b="_"+a.high+"_"+a.low;return this.accountControlRequests.get(b)},setAccountControlRequest:function(a){var b=v.Int64Helper.idStr(a.id),c=this.accountControlRequests.get(b);return null!=c&&c.version>a.version?c:(this.accountControlRequests.set(b,a),this.storage.setDirtyFlag(),a)},removeAccountControlRequest:function(a){var b="_"+a.high+"_"+a.low;this.accountControlRequests.remove(b),this.storage.setDirtyFlag()},removeAccountControlRequests:function(){this.accountControlRequests=new z.ds.StringMap,this.storage.setDirtyFlag()},getAccountControlGroup:function(){return this.accountControlGroup},setAccountControlGroup:function(a){return this.accountControlGroup=a,this.storage.setDirtyFlag(),this.accountControlGroup},updateAccountControlGroup:function(a){if(null!=this.accountControlGroup&&v.Int64Helper.eq(this.accountControlGroup.id,a.id)){var b=a.group;null!=b&&this.accountControlGroup.group.version<b.version&&(this.accountControlGroup.group=b,this.storage.setDirtyFlag())}},removeAccountControlGroup:function(a){null!=this.accountControlGroup&&v.Int64Helper.eq(this.accountControlGroup.id,a)&&(this.accountControlGroup=null,this.storage.setDirtyFlag())},clear:function(a){this.users=new z.ds.StringMap,this.talks=new z.ds.StringMap,this.talkStatuses=new z.ds.StringMap,this.domains=new z.ds.StringMap,this.domainInvites=new z.ds.StringMap,this.questions=new z.ds.StringMap,this.announcementStatuses=new z.ds.StringMap,this.accountControlRequests=new z.ds.StringMap,this.accountControlGroup=null,a&&(this.me=null),this.storage.setDirtyFlag()},init:function(){this.storage=new v.js.LocalStorage("dataStore");var a=this.storage.load();if(null!=a){var b=a.shift();if("1.76"==b)return this.me=a.shift(),this.users=a.shift(),this.talks=a.shift(),this.talkStatuses=a.shift(),this.domains=a.shift(),this.domainInvites=a.shift(),this.questions=a.shift(),this.announcementStatuses=a.shift(),this.accountControlRequests=a.shift(),this.accountControlGroup=a.shift(),void x._d(x.dateStr(),"dataStore is loaded.","","","","")}this.clear(!0),x._d(x.dateStr(),"dataStore is initialized.","","","","")},saveIfNeeded:function(){this.storage.isDirty&&(this.storage.save(["1.76",this.me,this.users,this.talks,this.talkStatuses,this.domains,this.domainInvites,this.questions,this.announcementStatuses,this.accountControlRequests,this.accountControlGroup]),x._d(x.dateStr(),"dataStore is saved.","","","",""))},__class__:v.proxy.DataStoreProxy}),v.proxy.FileServiceProxy=function(){u.patterns.proxy.Proxy.call(this,"fileService"),this.validHost=this.getValidHost()},e["albero.proxy.FileServiceProxy"]=v.proxy.FileServiceProxy,v.proxy.FileServiceProxy.__name__=["albero","proxy","FileServiceProxy"],v.proxy.FileServiceProxy.__super__=u.patterns.proxy.Proxy,v.proxy.FileServiceProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{getValidHost:function(){return"https://"+C.host},downloadUrl:function(a,b){if(null==b&&(b=!1),null==a||0==a.length)return"data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(q.startsWith(a,this.validHost)){var c=this.settings.getAccessToken(),d=a;return d+=-1!=a.indexOf("?")?"&":"?",d+="Authorization=ALB%20"+c,b&&(d+="&download=true"),d}return a},download:function(a,b,c){var d=this;if(a=this.downloadUrl(a),q.startsWith(a,"data:"))return void c(null);var e=w.Node.require("url").parse(a);null!=C.proxyURL&&(e.agent=v.js.ProxyHelper.createAgent(C.proxyURL));var f=w.Node.require("https").request(e,function(a){var e=a.headers.location;if(null!=e)return void d.download(e,b,c);if(2!=Math.floor(a.statusCode/100))return void c(null);var f=w.Node.require("fs").createWriteStream(b);a.on("data",function(a){f.write(a)}),a.on("end",function(){f.end(),f.on("finish",function(){c(b)})}),a.on("error",function(a){c(null)}),f.on("error",function(a){c(null)})});f.on("error",function(a){c(null)}),f.end()},upload:function(a,b,c,d,e){var f=this,g=w.Node.require("url").parse(a.put_url);g.method="PUT",g.headers={},g.headers["Content-Length"]=c.size,g.headers["Content-Type"]=a.post_form["Content-Type"],g.headers["Content-Disposition"]=a.post_form["Content-Disposition"],null!=C.proxyURL&&(g.agent=v.js.ProxyHelper.createAgent(C.proxyURL));var h=w.Node.require("https").request(g,function(a){if(2!=Math.floor(a.statusCode/100)){var b="";return a.on("data",function(a){b+=a}),void a.on("end",function(){f.uploadFailed({responseText:a.statusCode+": "+b},e)})}d()});h.on("error",function(a){f.uploadFailed({responseText:a.message},e)});var i=w.Node.require("fs").createReadStream(c.path);i.on("data",function(a){h.write(a)}),i.on("end",function(){h.end()}),i.on("error",function(){h.end()})},uploadFailed:function(a,b){this.sendNotification("error_occurred",{message:"ファイルの送信に失敗しました。"}),b(null)},createDummyFile:function(a,b,c){var d=q.replace(a,"/","\\").split("\\");if(0==d.length)return null;var e=d[d.length-1];if(null!=b&&(e=b),0==e.length)return null;var f="application/octet-stream",g=e.split(".");if(g.length>1){var h=g[g.length-1];switch(h){case"txt":f="text/plain";break;case"htm":case"html":f="text/html";break;case"xml":f="text/xml";break;case"gif":f="image/gif";break;case"jpg":case"jpeg":f="image/jpeg";break;case"png":f="image/png";break;case"pdf":f="application/pdf"}}null!=c&&(f=c);var i=1;return i=w.Node.require("fs").statSync(a).size,{name:e,size:i,type:f,path:a}},createThumbnail:function(a,b){b(q.startsWith(a.type,"video/")?null:q.startsWith(a.type,"image/")?null:null)},captureVideo:function(a,b,c){var d=a.width,e=a.height,f=b.videoWidth,g=b.videoHeight;f>g?f>d&&(g*=d/f,f=d):g>e&&(f*=e/g,g=e),1>g&&(g=1),1>f&&(f=1);var h=0,i=0;a.height=0|g,a.width=0|f;var j=a.getContext("2d");j.drawImage(b,h,i,f,g),a.toBlob(function(a){x._d(x.dateStr(),"captureVideo blob callback","","","","");var b={name:"thumb.jpeg",type:"image/jpeg",file:"thumb.jpeg",blob:a,size:a.size};c(b)})},normalizeImage:function(a,b,c){var d=a.width,e=a.height,f=b.width,g=b.height;f>g?f>d&&(g*=d/f,f=d):g>e&&(f*=e/g,g=e),1>g&&(g=1),1>f&&(f=1);var h=0,i=0;a.height=0|g,a.width=0|f;var j=a.getContext("2d");j.drawImage(b,h,i,f,g),x._d(x.dateStr(),"normalizeImage","","","",""),a.toBlob(function(a){x._d(x.dateStr(),"blob callback","","","","");var b={name:"thumb.jpeg",type:"image/jpeg",file:"thumb.jpeg",blob:a,size:a.size};c(b)})},createByteSizeStringWithUnit:function(a){for(var b,c=["","K","M","G","T"];(b=a/1024|0)>0;)a=b,c.shift();return a+" "+c.shift()+"B"},convertUploadableFile:function(a){if(null==a)return a;var b=!1,c=a.name;v.StringHelper.isEmtpy(c)&&(c="clipboard_"+v.DateHelper.getDateStringForFile()+".png",b=!0);var d=a.type;if(v.StringHelper.isEmtpy(d)&&(d="application/octet-stream",b=!0),!b)return a;var e={name:c,type:d,file:c,blob:a,size:a.size};return e},getBlobFromUpdatableFile:function(a){return null==a.blob?a:a.blob},__class__:v.proxy.FileServiceProxy}),v.proxy.FormatterProxy=function(){u.patterns.proxy.Proxy.call(this,"formatter"),v.proxy._FormatterProxy.ExternalUserIconListener.formatterProxy=this},e["albero.proxy.FormatterProxy"]=v.proxy.FormatterProxy,v.proxy.FormatterProxy.__name__=["albero","proxy","FormatterProxy"],v.proxy.FormatterProxy.__super__=u.patterns.proxy.Proxy,v.proxy.FormatterProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{abbreviateDatetimeString:function(a){if(null==a)return"";var b,c=new Date,d=v.Int64Helper.toFloat(a),e=new Date;e.setTime(d),b=e;var f="";return f=c.getFullYear()==b.getFullYear()&&c.getMonth()==b.getMonth()&&c.getDate()==b.getDate()?b.getHours()+":"+(b.getMinutes()<10?"0":"")+b.getMinutes():v.DateHelper.dateString(b,!1)},datetimeStringIn11Chars:function(a){if(null==a)return"";var b,c=new Date,d=v.Int64Helper.toFloat(a),e=new Date;e.setTime(d),b=e;var f=v.DateHelper.dateString(b,!1);return c.getFullYear()==b.getFullYear()&&(f+=" "+b.getHours()+":"+(b.getMinutes()<10?"0":"")+b.getMinutes()),f},timeString:function(a){if(null==a)return"";var b,c=v.Int64Helper.toFloat(a),d=new Date;return d.setTime(c),b=d,b.getHours()+":"+(b.getMinutes()<10?"0":"")+b.getMinutes()},datetimeString:function(a){if(null==a)return"";var b,c=o.parseFloat(o.string(a)),d=new Date;return d.setTime(c),b=d,b.getFullYear()+"/"+(b.getMonth()+1)+"/"+b.getDate()+" "+b.getHours()+":"+(b.getMinutes()<10?"0":"")+b.getMinutes()},messageString:function(a,b){var c;c=b.type==v.entity.MessageType.system?null:this.dataStore.getUser(a,b.userId);var d;d=null!=c?c.displayName:"";var e=b.type;switch(e[1]){case 0:return this.systemMessageString(a,b.content);case 1:return d+"："+o.string(b.content);case 3:return d+" が位置情報を送信しました。";case 4:return d+" が添付ファイルを送信しました。";case 5:return null!=b.content.text&&b.content.text.length>0?d+"：［添付ファイル］"+o.string(b.content.text):d+" が添付ファイルを送信しました。";case 2:return null!=b.content.text&&b.content.text.length>0?d+"：［スタンプ］"+o.string(b.content.text):d+" がスタンプを送信しました。";case 6:case 8:return d+"：［質問］ "+o.string(b.content.question);case 7:case 9:return d+" が質問に回答しました。";case 10:return d+"：［タスク］"+o.string(b.content.title);case 11:return b.content.done?d+" がタスクを達成しました。":d+" がタスクを差戻しました。";case 12:case 13:return d+" が回答を締め切りました。";case 14:return d+" がタスクを締め切りました。";default:return d+" がメッセージを送信しました。"}},announcementString:function(a){var b,c=this.dataStore.getUser(a.domainId,a.userId);b=null!=c?c.displayName:a.userName,null==b&&(b="");var d=a.type;switch(d[1]){case 1:return b+":"+o.string(a.content);default:return x._e(x.dateStr(),"announcement.type is not text. announcment:%o",a,"","",""),b+" がメッセージを送信しました。"}},systemMessageString:function(a,b){var c=b.type;switch(c){case"add_talkers":for(var d="",e=b.added_user_ids,f=0;f<e.length;){var g=e[f];++f;var h=this.dataStore.getUser(a,g);null!=h&&(""!=d&&(d+="と"),d+=h.displayName)}var i=null;if(null!=b.added_by){var j=this.dataStore.getUser(a,b.added_by);null!=j&&(i=j.displayName)}return null==i?d+"を追加しました":i+"が"+d+"を追加しました";case"delete_talker":var k=this.dataStore.getUser(a,b.deleted_user_id),l=this.dataStore.getUser(a,b.deleted_by);return null!=l&&null!=k?l.displayName+"が"+k.displayName+"を退出させました。関連するアクションは締め切られました。":null!=k?k.displayName+"が退出しました。関連するアクションは締め切られました。":"";case"add_talk_invite":var m=b.email;return m+"が招待されました";case"delete_talk_invite":var n=b.email;return n+"の招待が取り消されました";case"hide_pair_talk":var o="",p=this.dataStore.getUser(a,b.user_id);return null!=p&&(o+=p.displayName),o+"はメッセージ履歴を削除しました。相手にこれ以前のメッセージは表示されません。関連するアクションは締め切られました。";default:return""}},createText:function(a){if(null==a)return null;var b=this.emoji(this.linking(a));return q.endsWith(b,"\n")&&(b+="\n"),b},emoji:function(a){var b=new h("\\{p:(\\d+)\\}","g"),c=b.replace(a,"<img class='emoji' src='images/emoji/$1.gif'>");return c},linking:function(a){return twttr.txt.autoLinkUrlsCustom(a,{targetBlank:!0,htmlEscapeNonEntities:!0})},__class__:v.proxy.FormatterProxy}),v.proxy._FormatterProxy={},v.proxy._FormatterProxy.ExternalUserIconListener=a.albero.ExternalUserIconListener=function(){},e["albero.proxy._FormatterProxy.ExternalUserIconListener"]=v.proxy._FormatterProxy.ExternalUserIconListener,v.proxy._FormatterProxy.ExternalUserIconListener.__name__=["albero","proxy","_FormatterProxy","ExternalUserIconListener"],v.proxy.MsgPackRpcProxy=function(){this.connectionStatus=v.ConnectionStatus.Ok,u.patterns.proxy.Proxy.call(this,"rpc"),this.responseHandlers=new z.ds.IntMap,this.errorHandler=d(this,this.onServerError),this.connectionKeeper=new v.proxy._MsgPackRpcProxy.ConnectionKeeper(d(this,this.ping))},e["albero.proxy.MsgPackRpcProxy"]=v.proxy.MsgPackRpcProxy,v.proxy.MsgPackRpcProxy.__name__=["albero","proxy","MsgPackRpcProxy"],v.proxy.MsgPackRpcProxy.__super__=u.patterns.proxy.Proxy,v.proxy.MsgPackRpcProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{initWebSocket:function(){null==this.ws&&(this.ws=new v.js.WebSocket(C.endpoint),this.ws.onopen=d(this,this.onOpen),this.ws.onmessage=d(this,this.onMessage),this.ws.onclose=d(this,this.onClose))},finishWebSocket:function(){null!=this.ws&&(this.ws.onopen=null,this.ws.onmessage=null,this.ws.onerror=null,this.ws.onclose=null,this.ws.close(),this.ws=null)},onRegister:function(){this.initWebSocket(),this.connectionKeeper.start()},onRemove:function(){this.connectionKeeper.stop(),this.finishWebSocket()},onOpen:function(){this.connectionStatus=v.ConnectionStatus.Ok,this.connectionKeeper.setConnected(!0),this.sendNotification("SignIn")},onMessage:function(a){var b,c=this,d=new A.Decoder(a,!0).getResult();if(b=w.Boot.__cast(d[0],E),1==b&&4==d.length){var e;e=w.Boot.__cast(d[1],E);var f=d[2],g=d[3],h=this.responseHandlers.get(e);if(null==h)return void x._e(x.dateStr(),"No ResponseHandler prepared. msgId:%s error:%s result:",e,f,g,"");if(x._d(x.dateStr(),"response received. method:",h.method," data:",d,""),null==f){var i=h.onSuccess;null!=i&&i(g)}else{x._e(x.dateStr(),"Receive Error Response. method:",h.method," error:",f,"");var j=h.onError;null!=j?j(f):null!=this.errorHandler&&this.errorHandler(h.method,f)}this.responseHandlers.remove(e)}else if(0==b&&4==d.length){var k;k=w.Boot.__cast(d[1],E);var l;l=w.Boot.__cast(d[2],String);var m;m=w.Boot.__cast(d[3],Array),x._d(x.dateStr(),"request received. method:",l,"","","");for(var n=0;n<m.length;){var o=m[n];++n,this.broadcast.handleNotification(l,o,function(){x._d(x.dateStr(),"response sent. method:",l,"","",""),c.ws.send(new A.Encoder([1,k,null,!0]).getBytes())})}}},onClose:function(a,b,c){x._i(x.dateStr(),"onClose. code:"+a+", reason:"+b+", wasClean:"+(null==c?"null":""+c),"","","",""),1001==a&&c||(1e3!=a&&1005!=a||"concurrent access"!=b?1e3!=a&&1005!=a||"forcibly closed"!=b?this.connectionStatus=v.ConnectionStatus.Error:this.connectionStatus=v.ConnectionStatus.ForcibliyClosedError:this.connectionStatus=v.ConnectionStatus.ConcurrentAccessError,this.connectionStatus==v.ConnectionStatus.ForcibliyClosedError?this.sendNotification("SignOut"):this.sendNotification("Url",v.command.UrlAction.FORWARD(v.Urls.error))),this.finishWebSocket(),this.connectionKeeper.setConnected(!1)},restart:function(a){null==a&&(a=500);var b=this;this.finishWebSocket();for(var c=this.responseHandlers.keys();c.hasNext();){var d=c.next();this.responseHandlers.remove(d)}z.Timer.delay(function(){b.initWebSocket()},a)},call:function(a,b,c,d){if(null==this.ws)return void x._e(x.dateStr(),"disconnected. data:",this.data,"","","");null==b&&(b=[]);var e=v.proxy.MsgPackRpcProxy.lastMsgId++,f=new v.proxy._MsgPackRpcProxy.ResponseHandler(a,c,d);this.responseHandlers.set(e,f);var g=[0,e,a,b],h=new A.Encoder(g).getBytes();this.ws.send(h),x._d(x.dateStr(),"send request. data:",g,"","","")},ping:function(){var a=this.connectionStatus;switch(a[1]){case 2:case 3:return}null==this.ws||this.ws.isClosed()?(this.restart(),x._d(x.dateStr(),"restart connection.","","","","")):(this.ws.send(z.io.Bytes.alloc(0)),x._d(x.dateStr(),"send ping","","","",""))},onServerError:function(a,b){if(this.sendNotification("error_occurred",b),503==b.code&&"service temporarily unavailable"==b.message){var c=b.detail.retry_after;this.restart(1e3*c)}"invalid session"==b.message&&this.restart()},__class__:v.proxy.MsgPackRpcProxy}),v.proxy._MsgPackRpcProxy={},v.proxy._MsgPackRpcProxy.ConnectionKeeper=function(a){this.connected=!1,this.ping=a},e["albero.proxy._MsgPackRpcProxy.ConnectionKeeper"]=v.proxy._MsgPackRpcProxy.ConnectionKeeper,v.proxy._MsgPackRpcProxy.ConnectionKeeper.__name__=["albero","proxy","_MsgPackRpcProxy","ConnectionKeeper"],v.proxy._MsgPackRpcProxy.ConnectionKeeper.prototype={start:function(){},stop:function(){this.deleteTimer()},setConnected:function(a){(this.connected!=a||null==this.timer)&&(this.connected=a,this.resetTimer())},resetTimer:function(){var a=this;if(this.deleteTimer(),this.connected)this.timer=new z.Timer(45e3),this.timer.run=this.ping;else{var b=null;b=function(c){var d=o["int"](Math.min(2*c,45e3));return function(){a.ping(),a.timer=z.Timer.delay(b(d),c)}},b(3e3)()}},deleteTimer:function(){null!=this.timer&&(this.timer.stop(),this.timer=null)},__class__:v.proxy._MsgPackRpcProxy.ConnectionKeeper},v.proxy._MsgPackRpcProxy.ResponseHandler=function(a,b,c){this.method=a,this.onSuccess=b,this.onError=c},e["albero.proxy._MsgPackRpcProxy.ResponseHandler"]=v.proxy._MsgPackRpcProxy.ResponseHandler,v.proxy._MsgPackRpcProxy.ResponseHandler.__name__=["albero","proxy","_MsgPackRpcProxy","ResponseHandler"],v.proxy._MsgPackRpcProxy.ResponseHandler.prototype={__class__:v.proxy._MsgPackRpcProxy.ResponseHandler},v.proxy.Error=function(a){this.code=a.code,this.message=a.message,this.detail=a.detail},e["albero.proxy.Error"]=v.proxy.Error,v.proxy.Error.__name__=["albero","proxy","Error"],v.proxy.Error.prototype={__class__:v.proxy.Error},v.proxy.RoutingProxy=function(){u.patterns.proxy.Proxy.call(this,"routing")},e["albero.proxy.RoutingProxy"]=v.proxy.RoutingProxy,v.proxy.RoutingProxy.__name__=["albero","proxy","RoutingProxy"],v.proxy.RoutingProxy.__super__=u.patterns.proxy.Proxy,v.proxy.RoutingProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{init:function(){null==this.router&&(this.router=new v.proxy._RoutingProxy.LocalRouter(this,this.settings,this.dataStore),this.router.start())},forward:function(a){this.init(),this.router.forward(a)},redirect:function(a,b){this.init(),this.router.redirect(a,b)},back:function(){null!=this.router&&this.router.back()},stop:function(){null!=this.router&&this.router.started&&this.router.stop()},__class__:v.proxy.RoutingProxy}),v.proxy._RoutingProxy={},v.proxy._RoutingProxy.LocalRouter=function(a,b,c){this.proxy=a,this.settings=b,this.dataStore=c,this.started=!1},e["albero.proxy._RoutingProxy.LocalRouter"]=v.proxy._RoutingProxy.LocalRouter,v.proxy._RoutingProxy.LocalRouter.__name__=["albero","proxy","_RoutingProxy","LocalRouter"],v.proxy._RoutingProxy.LocalRouter.prototype={notify:function(a){var b=this.getDomainId(a);this.settings.setSelectedDomainId(b),this.proxy.sendNotification("current_page_changed",a)},start:function(){this.started=!0},forward:function(a){switch(a[1]){case 0:break;default:this.notify(a)}},redirect:function(a,b){},redirectWithHash:function(){},back:function(){this.notify(this.prev)},stop:function(){this.started=!1},getDomainId:function(a){switch(a[1]){case 2:var b=a[2];return b;case 3:var c=a[2];return c;case 4:var d=a[2];return d;case 5:var e=a[2];return e;case 6:var f=a[2];return f;case 7:var g=a[2];return g;case 11:var h=a[2];return h;default:return null}},parseFragment:function(a){if(null==a)return null;var b=a.split("/");if(""!=b[0])return null;if(2==b.length){if(""==b[1])return v.Urls.domains;if("settings"==b[1]){var c=this.settings.getLastSelectedDomainId();if(null!=c&&null!=this.dataStore.getDomain(c))return v.History.replaceState("settings",null,"#"+this.toFragment(v.Urls.settings(c))),v.Urls.settings(c);var d=this.dataStore.getDomains();if(d.length>0){for(var e=null,f=0;f<d.length;){var g=d[f];++f,(null==e||z.Int64.compare(e.id,g.id)>0)&&(e=g)}return v.History.replaceState("settings",null,"#"+this.toFragment(v.Urls.settings(e.id))),v.Urls.settings(e.id)}return v.Urls.settings(null)}if(b[1]==o.string(v.Urls.error))return v.Urls.error;if(b[1]==o.string(v.Urls.loading))return v.Urls.loading;if("environment"==b[1]){var h=this.settings.getLastSelectedDomainId();return null!=h&&null!=this.dataStore.getDomain(h)?(v.History.replaceState("environment",null,"#"+this.toFragment(v.Urls.environment(h))),v.Urls.environment(h)):v.Urls.environment(null)}}else if(3==b.length){var i=v.Int64Helper.parse(b[1]);if(null!=i){if(""==b[2])return v.Urls.domain(i);if("members"==b[2])return v.Urls.members(i);if("talks"==b[2])return v.Urls.talks(i);if("actions"==b[2])return v.Urls.actions(i);if("console"==b[2])return v.Urls.console(i);if("settings"==b[2])return v.Urls.settings(i)}}return null},toFragment:function(a){switch(a[1]){case 1:return"/";case 9:case 10:return"/"+o.string(a);case 2:var b=a[2];return"/"+b.toString()+"/";case 3:var c=a[2];return"/"+c.toString()+"/members";case 4:var d=a[2];return"/"+d.toString()+"/talks";case 5:var e=a[2];return"/"+e.toString()+"/actions";case 6:var f=a[2];return"/"+f.toString()+"/console";case 7:var g=a[2];return x._d(x.dateStr(),"convert urls.settings to fragment. domainId:",null!=g?g:"","","",""),null==g&&(g=this.settings.getLastSelectedDomainId()),null!=g?"/"+g.toString()+"/settings":"/settings";case 11:var h=a[2];return x._d(x.dateStr(),"convert urls.settings to fragment. domainId:",null!=h?h:"","","",""),null==h&&(h=this.settings.getLastSelectedDomainId()),null!=h?"/"+h.toString()+"/environment":"/environment";default:return null}},__class__:v.proxy._RoutingProxy.LocalRouter},v.proxy.SearchServiceProxy=function(){u.patterns.proxy.Proxy.call(this,"searchService")},e["albero.proxy.SearchServiceProxy"]=v.proxy.SearchServiceProxy,v.proxy.SearchServiceProxy.__name__=["albero","proxy","SearchServiceProxy"],v.proxy.SearchServiceProxy.__super__=u.patterns.proxy.Proxy,v.proxy.SearchServiceProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{isSearching:function(){return this.searching},clearSearching:function(){this.searching=!1},isRecentParams:function(a){return null==this.recentParams||null==a?!1:this.recentParams.eq(a)},clearRecentParams:function(){this.recentParams=null},clearEditingParams:function(){this.editingParams=null},saveParams:function(a){var b=this;this.editingParams=a,this.recentParams=a.copy(),v.js.TextCanonicalizer.assureNormalize(function(a){null==b.normalizedKeywords?b.normalizedKeywords=new Array:b.normalizedKeywords.splice(0,b.normalizedKeywords.length);for(var c=new h("[ 　]","g").split(q.htmlEscape(b.recentParams.keyword,!0)),d=0;d<c.length;){var e=c[d];++d,null!=e&&0!=e.length&&b.normalizedKeywords.push(new v.js.NFKCTextSearch(e,!0,a))}})},updateTalkIdParam:function(a){this.assureParams(),this.editingParams.talkId=a},updateSearchTypeParam:function(a){this.assureParams(),this.editingParams.searchType=a},updateFromUserIdParam:function(a){this.assureParams(),this.editingParams.fromUserId=a},updateKeywordParam:function(a){this.assureParams(),this.editingParams.keyword=a},updateDomainIdParam:function(a){this.assureParams(),this.editingParams.domainId=a},updateSinceTextParam:function(a){this.assureParams(),this.editingParams.sinceText=a},updateUntilTextParam:function(a){this.assureParams(),this.editingParams.untilText=a},assureParams:function(){if(null==this.editingParams){var a={domain_id_str:v.Int64Helper.idStr(this.settings.getSelectedDomainId())};this.editingParams=new v.entity.SearchParams(a)}},prepareForSearching:function(a,b){this.searching=!0,null==b&&this.sendNotification("notify_search_prepare",{searching:!0,params:a})},notifySearchMessagesFail:function(){this.searching=!1,this.sendNotification("notify_search_messages_fail",{})},notifySearchAttachmentsFail:function(){this.searching=!1,this.sendNotification("notify_search_attachments_fail",{})},saveSearchMessagesResult:function(a){null==this.contextMap&&(this.contextMap=new z.ds.StringMap),this.messagesNextMarker=a.nextMarker,null==a.marker&&(this.hitMessageIdSet=new z.ds.StringMap);for(var b=0,c=a.contents;b<c.length;){var d=c[b];++b;var e=v.Int64Helper.idStr(d.messages[0].id);this.contextMap.set(e,d),this.hitMessageIdSet=j.fold(d.messages,function(a,b){if(a.hit){var c=v.Int64Helper.idStr(a.id);b.set(c,1)}return b},this.hitMessageIdSet)}this.searching=!1,this.sendNotification("notify_search_messages",a)},saveSearchAttachmentsResult:function(a){null==this.attachmentsMap&&(this.attachmentsMap=new z.ds.StringMap),this.attachmentsNextMarker=a.nextMarker;for(var b=0,c=a.contents;b<c.length;){var d=c[b];++b;var e=v.Int64Helper.idStr(d.id);this.attachmentsMap.set(e,d)}this.searching=!1,this.sendNotification("notify_search_attachments",a)},getHitContext:function(a){return this.contextMap.get(a)},getFileInfo:function(a){return this.attachmentsMap.get(a)},isHitMessage:function(a){return this.hitMessageIdSet.exists("_"+a.high+"_"+a.low)},emphasisKeyword:function(a){for(var b=q.htmlEscape(a,!0),c=new Array,d=0,e=this.normalizedKeywords;d<e.length;){var f=e[d];++d,c=c.concat(f.search(b))}if(0==c.length)return b;c.sort(function(a,b){return a.start-b.start});for(var g=new p,h=0,i=0;i<c.length;){var j=c[i];++i,h<j.start&&(g.add(b.substring(h,j.start)),h=j.start),h==j.start&&(g.add("<em>"+b.substring(j.start,j.end)+"</em>"),h=j.end)}return h!=b.length&&g.add(b.substring(h)),g.b},__class__:v.proxy.SearchServiceProxy}),v.proxy.SettingsProxy=function(){this.selectedDomainId=null,this.remember=!0,u.patterns.proxy.Proxy.call(this,"settings"),this.browserSettings=new v.proxy.BrowserSettings},e["albero.proxy.SettingsProxy"]=v.proxy.SettingsProxy,v.proxy.SettingsProxy.__name__=["albero","proxy","SettingsProxy"],v.proxy.SettingsProxy.__super__=u.patterns.proxy.Proxy,v.proxy.SettingsProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{setAccessTokenRemember:function(a){this.remember=a},setAccessToken:function(a){this.remember&&(this.accessToken=a,this.sendNotification("access_token_changed",a))},getAccessToken:function(){return null==this.accessToken&&(this.accessToken=C.accessToken),this.accessToken},clearAccessToken:function(){this.accessToken=null},getOs:function(){return"bot"},getIDFV:function(){var a=v.StorageHelper.getItem("idfv");return(null==a||""==a)&&(a=v.StringHelper.randomString(),v.StorageHelper.setItem("idfv",a)),a},setConfiguration:function(a){this.configuration=a,this.sendNotification("configuration_changed",a)},getConfiguration:function(){return this.configuration},setSelectedDomainId:function(a){v.Int64Helper.eq(this.selectedDomainId,a)||(null!=a?(v.StorageHelper.setItem("selected_domain_id_h",null==a.high?"null":""+a.high),v.StorageHelper.setItem("selected_domain_id_l",null==a.low?"null":""+a.low)):(v.StorageHelper.removeItem("selected_domain_id_h"),v.StorageHelper.removeItem("selected_domain_id_l")),this.selectedDomainId=a,this.sendNotification("domain_selection_changed",a))},getLastSelectedDomainId:function(){var a,b=v.StorageHelper.getItemAsInt("selected_domain_id_h"),c=v.StorageHelper.getItemAsInt("selected_domain_id_l");return a=null!=b&&null!=c?new z.Int64(b,c):null},getSelectedDomainId:function(){return this.selectedDomainId},clearDomainSelection:function(){this.selectedDomainId=null,v.StorageHelper.removeItem("selected_domain_id_h"),v.StorageHelper.removeItem("selected_domain_id_l")},clearSelectedTalk:function(){if(this.hasSelectedTalk()){var a=v.Int64Helper.idStr(this.selectedDomainId);this.selectedTalkIds.remove(a)}},setSelectedTalk:function(a){if(x._d(x.dateStr(),"talk selected. talk:",a,"","",""),null==this.selectedTalkIds&&(this.selectedTalkIds=new z.ds.StringMap),null==a){if(null!=this.selectedDomainId){var b=v.Int64Helper.idStr(this.selectedDomainId);this.selectedTalkIds.set(b,null)}this.sendNotification("talk_selection_changed")}else{var c=v.Int64Helper.idStr(a.domainId);if(this.selectedTalkIds.set(c,a.id),!v.Int64Helper.eq(a.domainId,this.selectedDomainId))return!1;this.sendNotification("talk_selection_changed",a)}return!0},hasSelectedTalk:function(){return null!=this.selectedTalkIds&&function(a){var b,c=v.Int64Helper.idStr(a.selectedDomainId);return b=a.selectedTalkIds.exists(c)}(this)},getSelectedTalkId:function(){if(null==this.selectedTalkIds)return null;var a=v.Int64Helper.idStr(this.selectedDomainId);return this.selectedTalkIds.get(a)},isSendByEnter:function(){return null==this.sendByEnter&&(this.sendByEnter=!0),this.sendByEnter},setSendByEnter:function(a){this.sendByEnter=a},setSelectedStampTabId:function(a){v.StorageHelper.setItem("selected_stamp_tab_id",null==a?"null":""+a)},getSelectedStampTabId:function(){var a=v.StorageHelper.getItemAsInt("selected_stamp_tab_id");return null==a?0:a},clearSelectedStampTabId:function(){v.StorageHelper.removeItem("selected_stamp_tab_id")},setInputTextForTalkId:function(a,b){null==a||0==a.length?this.clearInputTextForTalkId(b):(this.loadInputTextForAll(),this.inputTexts["_"+b.high+"_"+b.low]=a)},getInputTextForTalkId:function(a){this.loadInputTextForAll();var b=this.inputTexts["_"+a.high+"_"+a.low];return null!=b?b:""},clearInputTextForTalkId:function(a){this.loadInputTextForAll(),delete this.inputTexts["_"+a.high+"_"+a.low]},loadInputTextForAll:function(){null==this.inputTexts&&(this.inputTexts=v.StorageHelper.getItemAsJson("input_text"),null==this.inputTexts&&(this.inputTexts={}))},saveInputTextForAll:function(){if(null!=this.inputTexts){var a=JSON.stringify(this.inputTexts,null,null);v.StorageHelper.setItem("input_text",a)}},clearInputTextForAll:function(){v.StorageHelper.removeItem("input_text"),this.inputTexts=null},setCopyProfileToAllDomains:function(a){a?v.StorageHelper.setItem("copy_profile_to_all_domains","true"):v.StorageHelper.removeItem("copy_profile_to_all_domains")},isCopyProfileToAllDomains:function(){return null!=v.StorageHelper.getItem("copy_profile_to_all_domains")},setSearchHistoriesForSelectedDomain:function(a){null!=this.selectedDomainId&&(null==a?this.clearSearchHistoriesForSelectedDomain():(this.loadSearchHistoryForAll(),this.searchHistories[v.Int64Helper.idStr(this.selectedDomainId)]=a,this.saveSearchHistoryForAll()))},getSearchHistoriesForSelectedDomain:function(){if(null==this.selectedDomainId)return null;this.loadSearchHistoryForAll();var a=this.searchHistories[v.Int64Helper.idStr(this.selectedDomainId)];return a},clearSearchHistoriesForSelectedDomain:function(){this.loadSearchHistoryForAll(),delete this.searchHistories[v.Int64Helper.idStr(this.selectedDomainId)]},loadSearchHistoryForAll:function(){null==this.searchHistories&&(this.searchHistories=v.StorageHelper.getItemAsJson("search_histories"),null==this.searchHistories&&(this.searchHistories={}))},saveSearchHistoryForAll:function(){if(null!=this.searchHistories){var a=JSON.stringify(this.searchHistories,null,null);v.StorageHelper.setItem("search_histories",a)}},clearSearchHistoryForAll:function(){v.StorageHelper.removeItem("input_text"),
this.searchHistories=null},setRightPanelOpened:function(a){a?v.StorageHelper.removeItem("right_panel_opened"):v.StorageHelper.setItem("right_panel_opened","false")},isRightPanelOpened:function(){return null==v.StorageHelper.getItem("right_panel_opened")},setPasswordWarningSkipUntil:function(a){null==a?v.StorageHelper.removeItem("password_warning_skip_until"):v.StorageHelper.setItem("password_warning_skip_until","_"+a.high+"_"+a.low)},getPasswordWarningSkipUntil:function(){var a=v.StorageHelper.getItem("password_warning_skip_until");return null==a?null:v.Int64Helper.makeFromIdStr(a)},setNotificationPopupEnabled:function(a,b){a?this.browserSettings.notificationVisibleTalkPopup=b:this.browserSettings.notificationInvisibleTalkPopup=b,this.browserSettings.save()},getNotificationPopupEnabled:function(a){return a?this.browserSettings.notificationVisibleTalkPopup:this.browserSettings.notificationInvisibleTalkPopup},setNotificationSoundEnabled:function(a,b){a?this.browserSettings.notificationVisibleTalkSound=b:this.browserSettings.notificationInvisibleTalkSound=b,this.browserSettings.save()},getNotificationSoundEnabled:function(a){return a?this.browserSettings.notificationVisibleTalkSound:this.browserSettings.notificationInvisibleTalkSound},setNotificationAutoScroll:function(a){this.browserSettings.notificationVisibleTalkAutoScroll=a,this.browserSettings.save()},isNotificationAutoScroll:function(){return this.browserSettings.notificationVisibleTalkAutoScroll},__class__:v.proxy.SettingsProxy}),v.proxy.BrowserSettings=function(){this.notificationInvisibleTalkSound=!0,this.notificationInvisibleTalkPopup=!1,this.notificationVisibleTalkSound=!1,this.notificationVisibleTalkPopup=!1,this.notificationVisibleTalkAutoScroll=!0;var a=v.StorageHelper.getItemAsJson(v.proxy.BrowserSettings.NAME);null!=a&&(null!=a.notificationInvisibleTalkSound&&(this.notificationInvisibleTalkSound=a.notificationInvisibleTalkSound),null!=a.notificationInvisibleTalkPopup&&(this.notificationInvisibleTalkPopup=a.notificationInvisibleTalkPopup),null!=a.notificationVisibleTalkSound&&(this.notificationVisibleTalkSound=a.notificationVisibleTalkSound),null!=a.notificationVisibleTalkPopup&&(this.notificationVisibleTalkPopup=a.notificationVisibleTalkPopup),null!=a.notificationVisibleTalkAutoScroll&&(this.notificationVisibleTalkAutoScroll=a.notificationVisibleTalkAutoScroll))},e["albero.proxy.BrowserSettings"]=v.proxy.BrowserSettings,v.proxy.BrowserSettings.__name__=["albero","proxy","BrowserSettings"],v.proxy.BrowserSettings.prototype={save:function(){var a=v.StorageHelper.getItemAsJson(v.proxy.BrowserSettings.NAME);null==a&&(a={}),a.notificationInvisibleTalkSound=this.notificationInvisibleTalkSound,a.notificationInvisibleTalkPopup=this.notificationInvisibleTalkPopup,a.notificationVisibleTalkSound=this.notificationVisibleTalkSound,a.notificationVisibleTalkPopup=this.notificationVisibleTalkPopup,a.notificationVisibleTalkAutoScroll=this.notificationVisibleTalkAutoScroll,v.StorageHelper.setItem(v.proxy.BrowserSettings.NAME,JSON.stringify(a,null,null))},__class__:v.proxy.BrowserSettings},v.proxy.StagedFileInfoStoreProxy=function(){u.patterns.proxy.Proxy.call(this,"stagedFileInfoStore"),this.stagedFileInfosMap=new z.ds.StringMap,this.stagedFileInfosMaxId=0},e["albero.proxy.StagedFileInfoStoreProxy"]=v.proxy.StagedFileInfoStoreProxy,v.proxy.StagedFileInfoStoreProxy.__name__=["albero","proxy","StagedFileInfoStoreProxy"],v.proxy.StagedFileInfoStoreProxy.__super__=u.patterns.proxy.Proxy,v.proxy.StagedFileInfoStoreProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{ensureStagedFileInfos:function(a){var b="_"+a.high+"_"+a.low,c=this.stagedFileInfosMap.get(b);return null==c&&(c=new Array,this.stagedFileInfosMap.set(b,c)),c},getStagedFileInfo:function(a,b){var c=this.ensureStagedFileInfos(a);return j.find(c,function(a){return v.Int64Helper.eq(a.id,b)})},createStagedFileInfo:function(a,b,c){var d=new v.entity.FileInfo;return d.id=z.Int64.make(0,++this.stagedFileInfosMaxId),d.talkId=a,null!=b&&(d.contentType=b.type,d.contentSize=b.size,d.url=URL.createObjectURL(this.fileService.getBlobFromUpdatableFile(b)),d.file=b,d.name=b.name),null!=c&&(d.thumbUrl=URL.createObjectURL(c.blob)),d},__class__:v.proxy.StagedFileInfoStoreProxy}),u.interfaces.IMediator=function(){},e["puremvc.interfaces.IMediator"]=u.interfaces.IMediator,u.interfaces.IMediator.__name__=["puremvc","interfaces","IMediator"],u.interfaces.IMediator.prototype={__class__:u.interfaces.IMediator},u.patterns.mediator={},u.patterns.mediator.Mediator=function(a,b){u.patterns.observer.Notifier.call(this),null!=a?this.mediatorName=a:this.mediatorName=u.patterns.mediator.Mediator.NAME,null!=b&&(this.viewComponent=b)},e["puremvc.patterns.mediator.Mediator"]=u.patterns.mediator.Mediator,u.patterns.mediator.Mediator.__name__=["puremvc","patterns","mediator","Mediator"],u.patterns.mediator.Mediator.__interfaces__=[u.interfaces.IMediator],u.patterns.mediator.Mediator.__super__=u.patterns.observer.Notifier,u.patterns.mediator.Mediator.prototype=b(u.patterns.observer.Notifier.prototype,{getMediatorName:function(){return this.mediatorName},setViewComponent:function(a){this.viewComponent=a},getViewComponent:function(){return this.viewComponent},listNotificationInterests:function(){return[]},handleNotification:function(a){},onRegister:function(){},onRemove:function(){},__class__:u.patterns.mediator.Mediator});var y={};y.mediator={},y.mediator.CommandLineMediator=function(){u.patterns.mediator.Mediator.call(this,"commandline",null)},e["albero_cli.mediator.CommandLineMediator"]=y.mediator.CommandLineMediator,y.mediator.CommandLineMediator.__name__=["albero_cli","mediator","CommandLineMediator"],y.mediator.CommandLineMediator.__super__=u.patterns.mediator.Mediator,y.mediator.CommandLineMediator.prototype=b(u.patterns.mediator.Mediator.prototype,{onRegister:function(){this.getViewComponent();this.eventEmitter=g.getInstance(),this.dataRecovered=!1,this.startDataSaver()},listNotificationInterests:function(){return["app_state_changed","access_token_changed","current_user_changed","configuration_changed","domain_selection_changed","talk_selection_changed","talk_list_scroll_to_talk_top_needed","user_selection_needed","user_selection_changed","friend_selection_needed","stamp_set_changed","stamp_selection_changed","phone_call_started","phone_call_accepted","phone_call_connected","phone_call_hangued_up","action_selection_changed","current_page_changed","current_page_not_changed","fileinfo_selection_changed","message_fileinfo_selection_changed","staged_fileinfo_selection_changed","error_occurred","brand_badge_changed","send_form_top_changed","solutions_loaded","right_pane_open","right_pane_close","right_pane_opened","right_pane_closed","password_expiration_overed","password_expiration_warned","photo_editor_saved","mc_authenticated_user_received","data_recovered","notify_update_user","notify_add_friend","notify_add_acquaintance","notify_delete_friend","notify_delete_acquaintance","notify_update_domain_users","get_domain_users_responsed","get_users_responsed","get_profile_responsed","update_user_responsed","update_profile_responsed","notify_add_domain_invite","notify_accept_domain_invite","notify_delete_domain_invite","notify_join_domain","notify_update_domain","notify_leave_domain","notify_create_pair_talk","notify_create_group_talk","notify_update_group_talk","notify_add_talkers","notify_delete_talker","notify_add_talk_invite","notify_accept_talk_invite","notify_delete_talk_invite","notify_delete_talk","notify_create_message","notify_update_read_statuses","notify_update_talk_status","notify_update_local_talk_status","notify_get_messages","notify_get_message_status","create_message_start","create_message_complete","create_message_fail","notify_create_announcement","notify_update_announcement_status","notify_get_announcements","create_announcement_start","create_announcement_complete","create_announcement_fail","notify_update_question","get_questions_responsed","notify_create_attachment","notify_delete_attachment","get_file_responsed","notify_search_messages","notify_search_attachments","notify_search_messages_fail","notify_search_attachments_fail","notify_search_prepare","notify_search_clear","notify_search_box_text_changed","notify_search_box_popup","notify_add_account_control_request","notify_delete_account_control_request","notify_join_account_control_group","notify_update_account_control_group","notify_leave_account_control_group"]},handleNotification:function(a){var b=this,c=a.getName();switch(c){case"data_recovered":if(this.dataRecovered)return;this.dataRecovered=!0,this.eventEmitter.emit(a.getName());break;case"error_occurred":this.eventEmitter.emit(a.getName(),new Error("AdapterError"),a.getBody());break;case"current_page_changed":var d=a.getBody();t.enumEq(d,v.Urls.error)&&(this.dataRecovered=!1),this.eventEmitter.emit(a.getName(),a.getBody());break;default:this.eventEmitter.emit(a.getName(),a.getBody())}var e=(this.getViewComponent(),a.getName());switch(e){case"access_token_changed":this.dataStore.clear(!0),w.Node.console.log(a.getBody()),w.Node.process.exit(0);break;case"current_user_changed":a.getBody();this.sendQueue.restart();break;case"notify_add_domain_invite":a.getBody();break;case"notify_create_pair_talk":case"notify_create_group_talk":if(!this.dataRecovered)return;var f=a.getBody();z.Timer.delay(function(){b.emit(f,"JoinMessage",b.dataStore.me)},500);break;case"notify_update_group_talk":if(!this.dataRecovered)return;var g,h=a.getBody();g=null!=h.name?h.name:"",z.Timer.delay(function(){b.emit(h,"TopicChangeMessage",b.dataStore.me,g)},500);break;case"create_message_complete":case"create_announcement_complete":var i=a.getBody(),j=i[0];i[1];if(this.dataStore.isMe(j.userId))return this.messageEvent.messageCreated(j,a.getType()),void this.sendQueue.sendNext(j);break;case"create_message_fail":var k=a.getBody()[0],l=a.getBody()[1];if(this.dataStore.isMe(l.userId))return this.messageEvent.messageCreated(null,a.getType()),void(null!=k&&429==k.code?this.sendQueue.retryAfter(1e3*o["int"](k.detail.retry_after)):null!=k&&503==k.code?this.sendQueue.retryAfter(1e3*o["int"](k.detail.retry_after)):this.sendQueue.sendNext(l));break;case"notify_create_message":var m=a.getBody();if(this.dataStore.isMe(m.userId))return;var n=this.dataStore.getTalkStatus(m.talkId);if(null!=n&&null!=n.maxReadMessageId&&z.Int64.compare(n.maxReadMessageId,m.id)>=0)return;z.Timer.delay(function(){null!=b.dataStore.getTalk(m.talkId)&&(b.sendNotification("Read",v.command.ReadType.TALK(m.talkId,m.id)),b.dispatch(m))},200);break;case"notify_update_read_statuses":for(var p=a.getBody(),q=0,r=p.messageIds;q<r.length;){var s=r[q];++q,this.messageEvent.messageRead(p.talkId,s,p.readUserIds)}break;case"notify_get_message_status":var u=a.getBody();this.messageEvent.messageRead(u.talkId,u.id,u.readUserIds,u.unreadUserIds);break;case"notify_update_local_talk_status":var x=a.getBody();this.messageEvent.messageReadEveryone(x.id,x.maxEveryoneReadMessageId);break;case"notify_delete_talk":var y=a.getBody();this.messageEvent.deleteTalk(y);break;case"notify_leave_domain":var A=a.getBody();this.messageEvent.leaveDomain(A)}},emit:function(a,b,c,d){var e=this;null!=b&&null!=a&&null!=c&&this.api.getAllUserEmails(function(){e.eventEmitter.emit(b,{room:v.Int64Helper.idStr(a.id),rooms:e.hubotObject.talkObjects()},e.hubotObject.userObject(c),d)})},leave:function(a){var b=this;z.Timer.delay(function(){null!=b.dataStore.getTalk(a.id)&&b.sendNotification("Talk",v.command.TalkAction.DELETE(null,a))},500)},dispatch:function(a){var b=this,c=a.content,d=this.dataStore.getTalk(a.talkId),e=function(c,e,f){b.emit(d,c,b.dataStore.getUser(d.domainId,e),{id:v.Int64Helper.idStr(a.id),content:f})};if(a.type==v.entity.MessageType.system){var f=c.type;if("add_talkers"==f){var g=c.added_user_ids,h=this.dataStore.me.id;if(v.Int64Helper.contains(g,h))return void e("JoinMessage",h);for(var i=0;i<g.length;){var j=g[i];++i,e("EnterMessage",j)}}else"delete_talker"==f?(e("LeaveMessage",c.deleted_user_id),c.user_ids.length<=1&&this.leave(d)):"hide_pair_talk"==f&&(e("LeaveMessage",c.user_id),this.leave(d))}else{var k=null,l=a.type;switch(l[1]){case 1:k=c;break;default:for(var p=m.deepCopy(a.content),r=0,s=n.fields(p);r<s.length;){var t=s[r];++r;var u=n.field(p,t);if(n.isObject(p)&&null!=u.high&&null!=u.low){var w=z.Int64.make(u.high,u.low);n.setField(p,t,"stamp_index"==t?w.toString():"_"+w.high+"_"+w.low)}else"stamp_set"==t&&n.setField(p,t,o.string(u))}a.type!=v.entity.MessageType.textMultipleFile||null!=p.text&&0!=p.text.length||null==p.files||1!=p.files.length||(p=p.files[0]),k=JSON.stringify(p)}if(null!=k){if(d.type==v.entity.TalkType.PairTalk){var x;x=null!=C.$name?C.$name:"Hubot",q.startsWith(k,x)||(k=x+" "+k)}e("TextMessage",a.userId,k)}}},startDataSaver:function(){var a=this;z.Timer.delay(function(){a.dataRecovered&&a.dataStore.saveIfNeeded(),a.startDataSaver()},5e3)},__class__:y.mediator.CommandLineMediator}),y.proxy={},y.proxy.HubotObjectProxy=function(){u.patterns.proxy.Proxy.call(this,"hubotObject")},e["albero_cli.proxy.HubotObjectProxy"]=y.proxy.HubotObjectProxy,y.proxy.HubotObjectProxy.__name__=["albero_cli","proxy","HubotObjectProxy"],y.proxy.HubotObjectProxy.__super__=u.patterns.proxy.Proxy,y.proxy.HubotObjectProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{userObject:function(a){var b;return b=null==a?null:JSON.parse(JSON.stringify(a)),b.id_i64=a.id,b.id=v.Int64Helper.idStr(a.id),b.name=a.displayName,b.profile_url=a.profileImageUrl,b},userObjectByIdStr:function(a,b){var c=this.userObjectsByIds(a,[v.Int64Helper.idStrToInt64(b)]);return c.length>0?c[0]:null},userObjectsByIds:function(a,b,c){for(var d=[],e=0,f=this.dataStore.getUsers(a,b);e<f.length;){var g=f[e];if(++e,null!=g){var h,i="u"+v.Int64Helper.idStr(g.id);if(h=null!=c?c.get(i):null,null==h&&(h=this.userObject(g),null!=c)){var j=h;c.set(i,j)}d.push(h)}}return d},userObjects:function(a){for(var b={},c=0,d=this.dataStore.getUsers(a);c<d.length;){var e=d[c];++c,b[v.Int64Helper.idStr(e.id)]=this.userObject(e)}return b},talkObject:function(a,b){var c;return c=null==a?null:JSON.parse(JSON.stringify(a)),c.id_i64=a.id,c.id=v.Int64Helper.idStr(a.id),c.topic=a.name,a.type==v.entity.TalkType.Unknown?c.type=0:a.type==v.entity.TalkType.PairTalk?c.type=1:c.type=2,c.userIds=a.userIds,c.users=this.userObjectsByIds(a.domainId,a.userIds,b),c.domain=this.domainObjectById(a.domainId,b),c.domainId_i64=a.domainId,c.domainId=v.Int64Helper.idStr(a.domainId),c},talkObjects:function(a){for(var b=new z.ds.StringMap,c={},d=0,e=this.dataStore.getTalks();d<e.length;){var f=e[d];++d,(null==a||v.Int64Helper.eq(a,f.domainId))&&(c[v.Int64Helper.idStr(f.id)]=this.talkObject(f,b))}return c},domainObjectById:function(a,b){if(null==a)return null;var c="d"+("_"+a.high+"_"+a.low),d=b.get(c);if(null==d){d=this.domainObject(this.dataStore.getDomain(a));var e=d;b.set(c,e)}return d},domainObject:function(a,b){null==b&&(b=!1);var c;return c=null==a?null:JSON.parse(JSON.stringify(a)),c.id_i64=a.id,c.id=v.Int64Helper.idStr(a.id),b&&(c.talks=this.talkObjects(a.id)),c},domainObjects:function(){for(var a={},b=0,c=this.dataStore.getDomains();b<c.length;){var d=c[b];++b,a[v.Int64Helper.idStr(d.id)]=this.domainObject(d)}return a},messageObject:function(a){var b=new z.ds.StringMap,c=this.dataStore.getTalk(a.talkId),d=this.userObjectsByIds(c.domainId,[a.userId],b),e={};return e.type=v.entity.Message.enumIndex(a.type),e.content=m.deepCopy(a.content),e.createdAt=m.deepCopy(a.createdAt),e.id_i64=m.deepCopy(a.id),e.id=v.Int64Helper.idStr(a.id),d.length>0?e.user=d[0]:e.user=null,e.userId=v.Int64Helper.idStr(a.userId),e.talk=this.talkObject(c,b),e.talkId=v.Int64Helper.idStr(a.talkId),e},__class__:y.proxy.HubotObjectProxy}),y.proxy.MessageEventProxy=function(){u.patterns.proxy.Proxy.call(this,"messageEvent"),this.emitters=new z.ds.StringMap},e["albero_cli.proxy.MessageEventProxy"]=y.proxy.MessageEventProxy,y.proxy.MessageEventProxy.__name__=["albero_cli","proxy","MessageEventProxy"],y.proxy.MessageEventProxy.__super__=u.patterns.proxy.Proxy,y.proxy.MessageEventProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{registEmitter:function(a,b){y.proxy.Emitter.factory=this;var c=y.proxy.Emitter.createInstance(b);null!=c&&this.emitters.set(a,c)},messageCreated:function(a,b){var c=this.emitters.get(b);if(null!=c&&(this.emitters.remove(b),null!=a)){var d=v.Int64Helper.idStr(a.id);if(this.emitters.set(d,c),c.talk=this.dataStore.getTalk(a.talkId),c.setFirstReader(this.dataStore.me),c.emitOnSend(a),c.removeEventListener("send"),!c.hasEventListener()){var e=v.Int64Helper.idStr(a.id);this.emitters.remove(e)}}},messageRead:function(a,b,c,d){var e=this,f=this.emitters.get("_"+b.high+"_"+b.low);if(null!=f){f.emitOnRead(c,d);var g=f.__readerIds.length>=16;f.startTimer(g,function(c){c?e.messageReadEveryone(a,b):e.sendNotification("Read",v.command.ReadType.READ_STATUS(a,b))}),0==f.__unreadIds.length&&this.messageReadEveryone(a,b)}},messageReadEveryone:function(a,b){if(null!=b)for(var c=this.emitters.keys();c.hasNext();){var d=c.next(),e=this.emitters.get(d);if(null!=e.talk&&v.Int64Helper.eq(e.talk.id,a)){var f=v.Int64Helper.makeFromIdStr(d);z.Int64.compare(f,b)<=0&&this._messageReadEveryone(a,d)}}},_messageReadEveryone:function(a,b){var c=this.emitters.get(b);null!=c&&(c.__unreadIds.length>0&&c.emitOnRead(c.__unreadIds),c.stopTimer(),c.removeEventListener("read"),c.hasEventListener()||this.emitters.remove(b))},deleteTalk:function(a){for(var b=this.emitters.keys();b.hasNext();){var c=b.next(),d=this.emitters.get(c);null!=d.talk&&v.Int64Helper.eq(d.talk.id,a)&&(d.stopTimer(),this.emitters.remove(c))}},leaveDomain:function(a){for(var b=this.emitters.keys();b.hasNext();){var c=b.next(),d=this.emitters.get(c);null!=d.talk&&v.Int64Helper.eq(d.talk.domainId,a)&&(d.stopTimer(),this.emitters.remove(c))}},__class__:y.proxy.MessageEventProxy}),y.proxy.Emitter=function(a){this.context=a,this.listeners=new z.ds.StringMap,Object.defineProperty(this,"readUsers",{get:this.get_readUsers}),Object.defineProperty(this,"unreadUsers",{get:this.get_unreadUsers})},e["albero_cli.proxy.Emitter"]=y.proxy.Emitter,y.proxy.Emitter.__name__=["albero_cli","proxy","Emitter"],y.proxy.Emitter.createInstance=function(a){for(var b=null,c=n.fields(a),d=0;d<c.length;){var e=c[d];if(++d,q.startsWith(e,"on")){var f=n.field(a,e);n.isFunction(f)&&(n.deleteField(a,e),null==b&&(b=new y.proxy.Emitter(a)),b.addEventListener(i.substr(e,2,null),f))}}return b},y.proxy.Emitter.prototype={addEventListener:function(a,b){var c=b;this.listeners.set(a,c)},hasEventListener:function(){return this.listeners.iterator().hasNext()},removeEventListener:function(a){this.listeners.remove(a)},emit:function(a,b){var c=this.listeners.get(a);null!=c&&c.apply(this,b)},emitOnSend:function(a){this.message=this.get_message(a),this.emit("send",[this,a])},emitOnRead:function(a,b){var c=[];null!=b&&(this.__unreadIds=b);for(var d=0;d<a.length;){var e=a[d];++d,v.Int64Helper.contains(this.__readerIds,e)||(this.__readerIds.push(e),c.push(e)),v.Int64Helper.remove(this.__unreadIds,e)}c.length>0&&this.emit("read",[this.users(c),this.get_readUsers(),this.get_unreadUsers()])},setFirstReader:function(a){this.__readerIds=[a.id],this.__unreadIds=this.talk.userIds.slice(),v.Int64Helper.remove(this.__unreadIds,a.id)},get_readUsers:function(){return this.users(this.__readerIds)},get_unreadUsers:function(){return this.users(this.__unreadIds)},users:function(a){return null==a?[]:y.proxy.Emitter.factory.hubotObject.userObjectsByIds(this.talk.domainId,a)},get_message:function(a){return y.proxy.Emitter.factory.hubotObject.messageObject(a)},answer:function(a){var b=this,c=v.entity.Message.typeOf(this.message.type),d=v.Int64Helper.idStrToInt64(this.message.id);switch(c[1]){case 7:case 12:case 9:case 13:case 11:case 14:var e=this.message.content.in_reply_to;d=new z.Int64(e.high,e.low)}y.proxy.Emitter.factory.sendNotification("ReloadData",v.command.ReloadDataType.Question(d,function(d){var e=d.responses;switch(c[1]){case 6:case 7:case 12:a(b.users(e[0].userIds),b.users(e[1].userIds));break;case 8:case 9:case 13:a(e.map(function(a){return b.users(a.userIds)}));break;case 10:case 11:case 14:a(b.users(e[0].userIds),b.users(e[1].userIds))}}))},startTimer:function(a,b){var c=this;null!=this.__readerTimer&&this.stopTimer(),a?this.__readerTimerWait=1:this.__readerTimerWait=1440;var d=null;d=function(){c.__readerTimerWait*=2,c.__readerTimerWait<1440?(b(!1),c.__readerTimer=z.Timer.delay(d,60*c.__readerTimerWait*1e3|0)):(b(!0),c.__readerTimer=null)},this.__readerTimer=z.Timer.delay(d,60*this.__readerTimerWait*1e3|0)},stopTimer:function(){null!=this.__readerTimer&&(this.__readerTimer.stop(),this.__readerTimer=null)},__class__:y.proxy.Emitter},y.proxy.SendQueueProxy=function(){u.patterns.proxy.Proxy.call(this,"sendQueue"),this.sendCount=0,this.sendMsgQueue=new y.proxy._SendQueueProxy.SendQueue(this,550,new v.js.LocalStorage("sendQueueMessage")),this.sendAnnounceQueue=new y.proxy._SendQueueProxy.SendQueue(this,5050,new v.js.LocalStorage("sendQueueAnnounce"))},e["albero_cli.proxy.SendQueueProxy"]=y.proxy.SendQueueProxy,y.proxy.SendQueueProxy.__name__=["albero_cli","proxy","SendQueueProxy"],y.proxy.SendQueueProxy.__super__=u.patterns.proxy.Proxy,y.proxy.SendQueueProxy.prototype=b(u.patterns.proxy.Proxy.prototype,{restart:function(){this.sendMsgQueue.sendNext(),this.sendAnnounceQueue.sendNext()},retryAfter:function(a){this.sendMsgQueue.retryAfter(a),this.sendAnnounceQueue.retryAfter(a)},sendNext:function(a){null!=a.talkId?this.sendMsgQueue.sendNext():this.sendAnnounceQueue.sendNext()},sendAnnouncement:function(a,b){this.send(a,null,b)},sendMessage:function(a,b){this.send(null,a,b)},send:function(a,b,c){if("string"!=typeof c){var d=z.Int64.make(0,this.sendCount++);this.messageEvent.registEmitter("_"+d.high+"_"+d.low,c);var e=new v.entity.Message;if(e.id=d,e.domainId=a,e.talkId=b,e.content=this.parseContent(c),e.type=this.detectType(e.content),e.type==v.entity.MessageType.unknown)return;if(e.type==v.entity.MessageType.file&&null!=e.content.path)return void this.sendFile(b,e.content,"_"+d.high+"_"+d.low);e.type!=v.entity.MessageType.yesOrNo&&e.type!=v.entity.MessageType.selectOne||null!=e.content.listing||(e.content.listing=!1),this.applyLimitToMessage(e),this.pushQueue(e)}else for(var f=c,g=0,h=r.slice(f,1024);g<h.length;){var i=h[g];++g;var j=new v.entity.Message;j.domainId=a,j.talkId=b,j.type=v.entity.MessageType.text,j.content=i,this.pushQueue(j)}},sendFile:function(a,b,c){var d,e=null,f=null;if("string"==typeof b)d=b;else{if(b.path instanceof Array&&null==b.path.__enum__)return void this.sendFiles(a,b.path,b.name,b.type,b.text,c);if(null!=b.text)return void this.sendFiles(a,[b.path],[b.name],[b.type],b.text,c);d=b.path,e=b.name,f=b.type}return null!=d&&w.Node.require("fs").existsSync(d)?void this.sendMsgQueue.pushQueue("File",v.command.FileAction.UPLOAD_PATH(a,d,e,f,c)):void x._e(x.dateStr(),"File not found: ",d,"","","")},sendFiles:function(a,b,c,d,e,f){for(var g=0;g<b.length;){var h=b[g];if(++g,!w.Node.require("fs").existsSync(h))return void x._e(x.dateStr(),"File not found: ",h,"","","")}var i=b.length;if(null==c){for(var j=[],k=0;i>k;){k++;j.push(null)}c=j}if(null==d){for(var l=[],m=0;i>m;){m++;l.push(null)}d=l}return c.length!=i||d.length!=i?void x._e(x.dateStr(),"The length of name or type must be the same as path length.","","","",""):void this.sendMsgQueue.pushQueue("File",v.command.FileAction.UPLOAD_MULTI_PATH(a,e,b,c,d,f))},pushQueue:function(a){null==a.talkId?this.sendAnnounceQueue.pushQueue("Send",a):this.sendMsgQueue.pushQueue("Send",a)},parseContent:function(a){if(null==a)return null;for(var b=n.fields(a),c=0;c<b.length;){var d=b[c];++c;var e=n.field(a,d);if("string"==typeof e){var f=null;"stamp_set"==d?f=o.parseInt(e):"stamp_index"==d?f=v.Int64Helper.parse(e):"file_id"==d||"in_reply_to"==d?f=v.Int64Helper.idStrToInt64(e):("close_yesno"==d||"close_select"==d||"close_task"==d)&&(n.setField(a,"close",i.substr(d,6,null)),d="in_reply_to",f=v.Int64Helper.idStrToInt64(e)),null!=f&&(a[d]=f)}else n.isObject(a)&&null!=e.high&&null!=e.low&&n.setField(a,d,z.Int64.make(e.high,e.low))}return 1==b.length&&null!=a.text?a.text:a},detectType:function(a){if(null==a)return v.entity.MessageType.unknown;if("string"==typeof a)return v.entity.MessageType.text;if(null!=a.stamp_set)return v.entity.MessageType.stamp;if(null!=a.lat)return v.entity.MessageType.geo;if(null!=a.file_id||null!=a.path)return v.entity.MessageType.file;if(null!=a.close){var b=a.close;if(n.deleteField(a,"close"),"yesno"==b)return v.entity.MessageType.yesOrNoClosed;if("select"==b)return v.entity.MessageType.selectOneClosed;if("task"==b)return v.entity.MessageType.todoClosed}else if(null!=a.in_reply_to){if("boolean"==typeof a.response)return v.entity.MessageType.yesOrNoReply;if(w.Boot.__instanceof(a.response,E))return v.entity.MessageType.selectOneReply;if(null!=a.done)return v.entity.MessageType.todoDone}else{if(null!=a.question)return null==a.options?v.entity.MessageType.yesOrNo:v.entity.MessageType.selectOne;if(null!=a.title)return v.entity.MessageType.todo}return v.entity.MessageType.unknown},applyLimitToMessage:function(a){var b=a.type;switch(b[1]){case 1:var c=a.content;null!=c&&c.length>1024&&(a.content=c.substring(0,1024));break;case 2:case 5:var d=a.content.text;null!=d&&d.length>1024&&(a.content.text=d.substring(0,1024));break;case 6:case 8:var e=a.content.question;if(null!=e&&e.length>1024&&(a.content.question=e.substring(0,1024)),a.type==v.entity.MessageType.selectOne){var f=a.content.options;f.length>9&&(a.content.options=f=f.slice(0,9));for(var g=0,h=f.length;h>g;){var i=g++;f[i].length>64&&(f[i]=f[i].substring(0,64))}}break;case 10:var j=a.content.title;null!=j&&j.length>1024&&(a.content.title=j.substring(0,1024))}},__class__:y.proxy.SendQueueProxy}),y.proxy._SendQueueProxy={},y.proxy._SendQueueProxy.SendQueue=function(a,b,c){this.proxy=a,this.sendSpan=b,this.storage=c,this.sendQueue=this.loadQueue(),this.sending=this.sendQueue.length>0,this.lastSendNode=null;var d=new Date;d.setTime(0),this.lastSendTime=d},e["albero_cli.proxy._SendQueueProxy.SendQueue"]=y.proxy._SendQueueProxy.SendQueue,y.proxy._SendQueueProxy.SendQueue.__name__=["albero_cli","proxy","_SendQueueProxy","SendQueue"],y.proxy._SendQueueProxy.SendQueue.prototype={pushQueue:function(a,b){this.sendQueue.push({name:a,param:b}),this.saveQueue(),this.sending||(this.sending=!0,this.sendNext())},sendNext:function(){if(!this.sending||0==this.sendQueue.length)return void this.closeQueue();var a=(new Date).getTime()-this.lastSendTime.getTime(),b=o["int"](Math.max(this.sendSpan-a,100));z.Timer.delay(d(this,this.sendNotification),b)},retryAfter:function(a){return this.sending&&null!=this.lastSendNode?(this.sendQueue.unshift(this.lastSendNode),this.saveQueue(),void z.Timer.delay(d(this,this.sendNotification),a)):void this.closeQueue()},sendNotification:function(){var a=this.sendQueue.shift();this.saveQueue(),this.proxy.sendNotification(a.name,a.param),this.lastSendNode=a,this.lastSendTime=new Date},closeQueue:function(){this.sending=!1,this.lastSendNode=null},saveQueue:function(){null!=this.storage&&this.storage.save(this.sendQueue)},loadQueue:function(){if(null!=this.storage){var a=this.storage.load();if(null!=a)return a}return new Array},__class__:y.proxy._SendQueueProxy.SendQueue};var z={};z.Http=function(a){this.responseHeaders=new z.ds.StringMap,this.url=a,this.headers=new z.ds.StringMap,this.params=new z.ds.StringMap,this.async=!0},e["haxe.Http"]=z.Http,z.Http.__name__=["haxe","Http"],z.Http.requestUrl=function(a){var b=new z.Http(a);b.async=!1;var c=null;return b.onData=function(a){c=a},b.onError=function(a){throw a},b.request(!1),c},z.Http.prototype={setHeader:function(a,b){this.headers.set(a,b)},setParameter:function(a,b){this.params.set(a,b)},setPostData:function(a){this.postData=a},request:function(a){var b=this,c=this,d={},e=this.postData,f="https://"==this.url.substring(0,8);"http://"==this.url.substring(0,7)?this.url=i.substr(this.url,7,null):f&&(this.url=i.substr(this.url,8,null));var g=this.url.split("/"),h=g.shift();g.length>0?d.path="/"+g.join("/"):d.path="/";var j=h.split(":");if(null!=j&&j.length>1?(d.host=j[0],d.port=o.parseInt(j[1])):d.host=h,null!=e)a=!0;else for(var k=this.params.keys();k.hasNext();){var l=k.next();null==e?e="":e+="&",e+=encodeURIComponent(l)+"="+q.urlEncode(this.params.get(l))}if(null!=e){var m=this.url.split("?").length<=1;d.path+=(m?"?":"&")+e,e=null}if(a?d.method="POST":d.method="GET",null==this.headers.get("Content-Type")&&a&&null==this.postData&&this.headers.set("Content-Type","application/x-www-form-urlencoded"),this.headers.iterator().hasNext()){null==d.headers&&(d.headers={});for(var p=this.headers.keys();p.hasNext();){var r=p.next();n.setField(d.headers,r,this.headers.get(r))}}var s=null;s=f?w.Node.require("https"):w.Node.require("http");var t=s.request(d,function(a){b.responseData="";for(var d=0,e=n.fields(a.headers);d<e.length;){var f=e[d];++d;var g=n.field(a.headers,f);b.responseHeaders.set(f,g)}a.setEncoding("utf8");var h;try{h=a.statusCode}catch(i){h=0}if(null!=a.statusCode&&c.onStatus(a.statusCode),null!=a.statusCode&&a.statusCode>=200&&a.statusCode<400);else switch(h){case 0:c.onError("Failed to connect or resolve host");break;case 12029:c.onError("Failed to connect to host");break;case 12007:c.onError("Unknown host");break;default:c.onError("Http Error #"+a.statusCode)}a.on("data",function(a){b.responseData+=a}),a.once("end",function(){a.removeAllListeners("data"),a.removeAllListeners("end"),null!=b.responseData&&b.onData(b.responseData),b.responseData=null}),a.once("close",function(){null!=b.responseData&&b.onData(b.responseData),b.responseData=null}),a.once("error",function(a){c.onError("Http Response Error: "+o.string(a))})});t.on("error",function(a){c.onError("Http Request Error: "+o.string(a))}),t.end()},onData:function(a){},onError:function(a){},onStatus:function(a){},__class__:z.Http},z.Int64=function(a,b){this.high=0|a,this.low=0|b},e["haxe.Int64"]=z.Int64,z.Int64.__name__=["haxe","Int64"],z.Int64.make=function(a,b){return new z.Int64(a,b)},z.Int64.ofInt=function(a){return new z.Int64(a>>31,a)},z.Int64.getLow=function(a){return a.low},z.Int64.getHigh=function(a){return a.high},z.Int64.add=function(a,b){var c=a.high+b.high|0,d=a.low+b.low|0;return z.Int64.uicompare(d,a.low)<0&&c++,new z.Int64(c,d)},z.Int64.sub=function(a,b){var c=a.high-b.high|0,d=a.low-b.low|0;return z.Int64.uicompare(a.low,b.low)<0&&c--,new z.Int64(c,d)},z.Int64.mul=function(a,b){var c=65535,d=a.low&c,e=a.low>>>16,f=b.low&c,g=b.low>>>16,h=d*f,i=e*f,j=d*g,k=e*g,l=h,m=k+(j>>>16)+(i>>>16)|0;return j=j<<16|0,l=l+j|0,z.Int64.uicompare(l,j)<0&&(m=m+1|0),i=i<<16|0,l=l+i|0,z.Int64.uicompare(l,i)<0&&(m=m+1|0),m=m+function(c){var d,e=a.low,f=b.high;return d=(e*(f>>>16)<<16|0)+e*(65535&f)|0}(this)|0,m=m+function(c){var d,e=a.high,f=b.low;return d=(e*(f>>>16)<<16|0)+e*(65535&f)|0}(this)|0,new z.Int64(m,l)},z.Int64.divMod=function(a,b){var c=new z.Int64(0,0),d=0,e=1;for(b=new z.Int64(b.high,b.low);b.high>=0;){var f=z.Int64.ucompare(b,a);if(b.high=b.high<<1|0|b.low>>>31|0,b.low=b.low<<1|0,d=d<<1|0|e>>>31|0,e=e<<1|0,f>=0)break}for(;0!=(e|d|0);)z.Int64.ucompare(a,b)>=0&&(c.high=c.high|d|0,c.low=c.low|e|0,a=z.Int64.sub(a,b)),e=e>>>1|(d<<31|0)|0,d>>>=1,b.low=b.low>>>1|(b.high<<31|0)|0,b.high=b.high>>>1;return{quotient:c,modulus:a}},z.Int64.neg=function(a){var b=0|~a.high,c=0|-a.low;return 0==c&&b++,new z.Int64(b,c)},z.Int64.uicompare=function(a,b){return 0>a?0>b?~b-~a|0:1:0>b?-1:a-b|0},z.Int64.compare=function(a,b){var c=a.high-b.high|0;return 0!=c?c:z.Int64.uicompare(a.low,b.low)},z.Int64.ucompare=function(a,b){var c=z.Int64.uicompare(a.high,b.high);return 0!=c?c:z.Int64.uicompare(a.low,b.low)},z.Int64.prototype={toString:function(){if(0==(this.high|this.low))return"0";var a="",b=!1,c=this;c.high<0&&(b=!0,c=z.Int64.neg(c));for(var d=new z.Int64(0,10);0!=(c.high|c.low);){var e=z.Int64.divMod(c,d);a=e.modulus.low+a,c=e.quotient}return b&&(a="-"+a),a},__class__:z.Int64},z.Json=function(){},
e["haxe.Json"]=z.Json,z.Json.__name__=["haxe","Json"],z.Json.stringify=function(a,b,c){return JSON.stringify(a,b,c)},z.Json.parse=function(a){return JSON.parse(a)},z.Serializer=function(){this.buf=new p,this.cache=new Array,this.useCache=z.Serializer.USE_CACHE,this.useEnumIndex=z.Serializer.USE_ENUM_INDEX,this.shash=new z.ds.StringMap,this.scount=0},e["haxe.Serializer"]=z.Serializer,z.Serializer.__name__=["haxe","Serializer"],z.Serializer.run=function(a){var b=new z.Serializer;return b.serialize(a),b.toString()},z.Serializer.prototype={toString:function(){return this.buf.b},serializeString:function(a){var b=this.shash.get(a);return null!=b?(this.buf.b+="R",void(null==b?this.buf.b+="null":this.buf.b+=""+b)):(this.shash.set(a,this.scount++),this.buf.b+="y",a=encodeURIComponent(a),null==a.length?this.buf.b+="null":this.buf.b+=""+a.length,this.buf.b+=":",void(null==a?this.buf.b+="null":this.buf.b+=""+a))},serializeRef:function(a){for(var b=typeof a,c=0,d=this.cache.length;d>c;){var e=c++,f=this.cache[e];if(typeof f==b&&f==a)return this.buf.b+="r",null==e?this.buf.b+="null":this.buf.b+=""+e,!0}return this.cache.push(a),!1},serializeFields:function(a){for(var b=0,c=n.fields(a);b<c.length;){var d=c[b];++b,this.serializeString(d),this.serialize(n.field(a,d))}this.buf.b+="g"},serialize:function(a){var b=t["typeof"](a);switch(b[1]){case 0:this.buf.b+="n";break;case 1:var c=a;if(0==c)return void(this.buf.b+="z");this.buf.b+="i",null==c?this.buf.b+="null":this.buf.b+=""+c;break;case 2:var d=a;Math.isNaN(d)?this.buf.b+="k":Math.isFinite(d)?(this.buf.b+="d",null==d?this.buf.b+="null":this.buf.b+=""+d):0>d?this.buf.b+="m":this.buf.b+="p";break;case 3:a?this.buf.b+="t":this.buf.b+="f";break;case 6:var e=b[2];if(e==String)return void this.serializeString(a);if(this.useCache&&this.serializeRef(a))return;switch(e){case Array:var f=0;this.buf.b+="a";for(var g=a.length,h=0;g>h;){var j=h++;null==a[j]?f++:(f>0&&(1==f?this.buf.b+="n":(this.buf.b+="u",null==f?this.buf.b+="null":this.buf.b+=""+f),f=0),this.serialize(a[j]))}f>0&&(1==f?this.buf.b+="n":(this.buf.b+="u",null==f?this.buf.b+="null":this.buf.b+=""+f)),this.buf.b+="h";break;case k:this.buf.b+="l";for(var l=a,m=l.iterator();m.hasNext();){var q=m.next();this.serialize(q)}this.buf.b+="h";break;case Date:var r=a;this.buf.b+="v",this.buf.add(i.dateStr(r));break;case z.ds.StringMap:this.buf.b+="b";for(var s=a,u=s.keys();u.hasNext();){var v=u.next();this.serializeString(v),this.serialize(s.get(v))}this.buf.b+="h";break;case z.ds.IntMap:this.buf.b+="q";for(var w=a,x=w.keys();x.hasNext();){var y=x.next();this.buf.b+=":",null==y?this.buf.b+="null":this.buf.b+=""+y,this.serialize(w.get(y))}this.buf.b+="h";break;case z.ds.ObjectMap:this.buf.b+="M";for(var A=a,B=A.keys();B.hasNext();){var C=B.next(),D=n.field(C,"__id__");n.deleteField(C,"__id__"),this.serialize(C),C.__id__=D,this.serialize(A.h[C.__id__])}this.buf.b+="h";break;case z.io.Bytes:for(var E=a,F=0,G=E.length-2,H=new p,I=z.Serializer.BASE64;G>F;){var J=E.get(F++),K=E.get(F++),L=E.get(F++);H.add(I.charAt(J>>2)),H.add(I.charAt(63&(J<<4|K>>4))),H.add(I.charAt(63&(K<<2|L>>6))),H.add(I.charAt(63&L))}if(F==G){var M=E.get(F++),N=E.get(F++);H.add(I.charAt(M>>2)),H.add(I.charAt(63&(M<<4|N>>4))),H.add(I.charAt(N<<2&63))}else if(F==G+1){var O=E.get(F++);H.add(I.charAt(O>>2)),H.add(I.charAt(O<<4&63))}var P=H.b;this.buf.b+="s",null==P.length?this.buf.b+="null":this.buf.b+=""+P.length,this.buf.b+=":",null==P?this.buf.b+="null":this.buf.b+=""+P;break;default:this.useCache&&this.cache.pop(),null!=a.hxSerialize?(this.buf.b+="C",this.serializeString(t.getClassName(e)),this.useCache&&this.cache.push(a),a.hxSerialize(this),this.buf.b+="g"):(this.buf.b+="c",this.serializeString(t.getClassName(e)),this.useCache&&this.cache.push(a),this.serializeFields(a))}break;case 4:if(this.useCache&&this.serializeRef(a))return;this.buf.b+="o",this.serializeFields(a);break;case 7:var Q=b[2];if(this.useCache){if(this.serializeRef(a))return;this.cache.pop()}this.useEnumIndex?this.buf.b+="j":this.buf.b+="w",this.serializeString(t.getEnumName(Q)),this.useEnumIndex?(this.buf.b+=":",this.buf.b+=o.string(a[1])):this.serializeString(a[0]),this.buf.b+=":";var R=a.length;this.buf.b+=o.string(R-2);for(var S=2;R>S;){var T=S++;this.serialize(a[T])}this.useCache&&this.cache.push(a);break;case 5:throw"Cannot serialize function";default:throw"Cannot serialize "+o.string(a)}},__class__:z.Serializer},z.Timer=function(a){var b=this;this.id=setInterval(function(){b.run()},a)},e["haxe.Timer"]=z.Timer,z.Timer.__name__=["haxe","Timer"],z.Timer.delay=function(a,b){var c=new z.Timer(b);return c.run=function(){c.stop(),a()},c},z.Timer.prototype={stop:function(){null!=this.id&&(clearInterval(this.id),this.id=null)},run:function(){},__class__:z.Timer},z.Unserializer=function(a){this.buf=a,this.length=a.length,this.pos=0,this.scache=new Array,this.cache=new Array;var b=z.Unserializer.DEFAULT_RESOLVER;null==b&&(b=t,z.Unserializer.DEFAULT_RESOLVER=b),this.setResolver(b)},e["haxe.Unserializer"]=z.Unserializer,z.Unserializer.__name__=["haxe","Unserializer"],z.Unserializer.initCodes=function(){for(var a=new Array,b=0,c=z.Unserializer.BASE64.length;c>b;){var d=b++;a[z.Unserializer.BASE64.charCodeAt(d)]=d}return a},z.Unserializer.run=function(a){return new z.Unserializer(a).unserialize()},z.Unserializer.prototype={setResolver:function(a){null==a?this.resolver={resolveClass:function(a){return null},resolveEnum:function(a){return null}}:this.resolver=a},get:function(a){return this.buf.charCodeAt(a)},readDigits:function(){for(var a=0,b=!1,c=this.pos;;){var d=this.buf.charCodeAt(this.pos);if(d!=d)break;if(45!=d){if(48>d||d>57)break;a=10*a+(d-48),this.pos++}else{if(this.pos!=c)break;b=!0,this.pos++}}return b&&(a*=-1),a},unserializeObject:function(a){for(;;){if(this.pos>=this.length)throw"Invalid object";if(103==this.buf.charCodeAt(this.pos))break;var b=this.unserialize();if("string"!=typeof b)throw"Invalid object key";var c=this.unserialize();a[b]=c}this.pos++},unserializeEnum:function(a,b){if(58!=this.get(this.pos++))throw"Invalid enum format";var c=this.readDigits();if(0==c)return t.createEnum(a,b);for(var d=new Array;c-->0;)d.push(this.unserialize());return t.createEnum(a,b,d)},unserialize:function(){var a=this.get(this.pos++);switch(a){case 110:return null;case 116:return!0;case 102:return!1;case 122:return 0;case 105:return this.readDigits();case 100:for(var b=this.pos;;){var c=this.buf.charCodeAt(this.pos);if(!(c>=43&&58>c||101==c||69==c))break;this.pos++}return o.parseFloat(i.substr(this.buf,b,this.pos-b));case 121:var d=this.readDigits();if(58!=this.get(this.pos++)||this.length-this.pos<d)throw"Invalid string length";var e=i.substr(this.buf,this.pos,d);return this.pos+=d,e=decodeURIComponent(e.split("+").join(" ")),this.scache.push(e),e;case 107:return Math.NaN;case 109:return Math.NEGATIVE_INFINITY;case 112:return Math.POSITIVE_INFINITY;case 97:var f=(this.buf,new Array);for(this.cache.push(f);;){var g=this.buf.charCodeAt(this.pos);if(104==g){this.pos++;break}if(117==g){this.pos++;var h=this.readDigits();f[f.length+h-1]=null}else f.push(this.unserialize())}return f;case 111:var j={};return this.cache.push(j),this.unserializeObject(j),j;case 114:var l=this.readDigits();if(0>l||l>=this.cache.length)throw"Invalid reference";return this.cache[l];case 82:var m=this.readDigits();if(0>m||m>=this.scache.length)throw"Invalid string reference";return this.scache[m];case 120:throw this.unserialize();case 99:var n=this.unserialize(),p=this.resolver.resolveClass(n);if(null==p)throw"Class not found "+n;var r=t.createEmptyInstance(p);return this.cache.push(r),this.unserializeObject(r),r;case 119:var s=this.unserialize(),u=this.resolver.resolveEnum(s);if(null==u)throw"Enum not found "+s;var v=this.unserializeEnum(u,this.unserialize());return this.cache.push(v),v;case 106:var w=this.unserialize(),x=this.resolver.resolveEnum(w);if(null==x)throw"Enum not found "+w;this.pos++;var y=this.readDigits(),A=t.getEnumConstructs(x)[y];if(null==A)throw"Unknown enum index "+w+"@"+y;var B=this.unserializeEnum(x,A);return this.cache.push(B),B;case 108:var C=new k;this.cache.push(C);for(this.buf;104!=this.buf.charCodeAt(this.pos);)C.add(this.unserialize());return this.pos++,C;case 98:var D=new z.ds.StringMap;this.cache.push(D);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var E=this.unserialize();D.set(E,this.unserialize())}return this.pos++,D;case 113:var F=new z.ds.IntMap;this.cache.push(F);for(var G=(this.buf,this.get(this.pos++));58==G;){var H=this.readDigits();F.set(H,this.unserialize()),G=this.get(this.pos++)}if(104!=G)throw"Invalid IntMap format";return F;case 77:var I=new z.ds.ObjectMap;this.cache.push(I);for(this.buf;104!=this.buf.charCodeAt(this.pos);){var J=this.unserialize();I.set(J,this.unserialize())}return this.pos++,I;case 118:var K,L=i.substr(this.buf,this.pos,19);return K=i.strDate(L),this.cache.push(K),this.pos+=19,K;case 115:var M=this.readDigits(),N=this.buf;if(58!=this.get(this.pos++)||this.length-this.pos<M)throw"Invalid bytes length";var O=z.Unserializer.CODES;null==O&&(O=z.Unserializer.initCodes(),z.Unserializer.CODES=O);var P,Q=this.pos,R=3&M;P=3*(M>>2)+(R>=2?R-1:0);for(var S=Q+(M-R),T=z.io.Bytes.alloc(P),U=0;S>Q;){var V=O[q.fastCodeAt(N,Q++)],W=O[q.fastCodeAt(N,Q++)];T.set(U++,V<<2|W>>4);var X=O[q.fastCodeAt(N,Q++)];T.set(U++,W<<4|X>>2);var Y=O[q.fastCodeAt(N,Q++)];T.set(U++,X<<6|Y)}if(R>=2){var Z=O[q.fastCodeAt(N,Q++)],$=O[q.fastCodeAt(N,Q++)];if(T.set(U++,Z<<2|$>>4),3==R){var _=O[q.fastCodeAt(N,Q++)];T.set(U++,$<<4|_>>2)}}return this.pos+=M,this.cache.push(T),T;case 67:var aa=this.unserialize(),ba=this.resolver.resolveClass(aa);if(null==ba)throw"Class not found "+aa;var ca=t.createEmptyInstance(ba);if(this.cache.push(ca),ca.hxUnserialize(this),103!=this.get(this.pos++))throw"Invalid custom data";return ca}throw this.pos--,"Invalid char "+this.buf.charAt(this.pos)+" at position "+this.pos},__class__:z.Unserializer},z.ds={},z.ds.IntMap=function(){this.h={}},e["haxe.ds.IntMap"]=z.ds.IntMap,z.ds.IntMap.__name__=["haxe","ds","IntMap"],z.ds.IntMap.__interfaces__=[l],z.ds.IntMap.prototype={set:function(a,b){this.h[a]=b},get:function(a){return this.h[a]},remove:function(a){return this.h.hasOwnProperty(a)?(delete this.h[a],!0):!1},keys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(0|b);return i.iter(a)},__class__:z.ds.IntMap},z.ds.ObjectMap=function(){this.h={},this.h.__keys__={}},e["haxe.ds.ObjectMap"]=z.ds.ObjectMap,z.ds.ObjectMap.__name__=["haxe","ds","ObjectMap"],z.ds.ObjectMap.__interfaces__=[l],z.ds.ObjectMap.prototype={set:function(a,b){var c=a.__id__||(a.__id__=++z.ds.ObjectMap.count);this.h[c]=b,this.h.__keys__[c]=a},keys:function(){var a=[];for(var b in this.h.__keys__)this.h.hasOwnProperty(b)&&a.push(this.h.__keys__[b]);return i.iter(a)},__class__:z.ds.ObjectMap},z.ds.StringMap=function(){this.h={}},e["haxe.ds.StringMap"]=z.ds.StringMap,z.ds.StringMap.__name__=["haxe","ds","StringMap"],z.ds.StringMap.__interfaces__=[l],z.ds.StringMap.prototype={set:function(a,b){this.h["$"+a]=b},get:function(a){return this.h["$"+a]},exists:function(a){return this.h.hasOwnProperty("$"+a)},remove:function(a){return a="$"+a,this.h.hasOwnProperty(a)?(delete this.h[a],!0):!1},keys:function(){var a=[];for(var b in this.h)this.h.hasOwnProperty(b)&&a.push(b.substr(1));return i.iter(a)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var a=this.it.next();return this.ref["$"+a]}}},__class__:z.ds.StringMap},z.io={},z.io.Bytes=function(a,b){this.length=a,this.b=b},e["haxe.io.Bytes"]=z.io.Bytes,z.io.Bytes.__name__=["haxe","io","Bytes"],z.io.Bytes.alloc=function(a){return new z.io.Bytes(a,new Buffer(a))},z.io.Bytes.ofString=function(a){var b=new Buffer(a,"utf8");return new z.io.Bytes(b.length,b)},z.io.Bytes.ofData=function(a){return new z.io.Bytes(a.length,a)},z.io.Bytes.prototype={get:function(a){return this.b[a]},set:function(a,b){this.b[a]=b},blit:function(a,b,c,d){if(0>a||0>c||0>d||a+d>this.length||c+d>b.length)throw z.io.Error.OutsideBounds;b.b.copy(this.b,a,c,c+d)},sub:function(a,b){if(0>a||0>b||a+b>this.length)throw z.io.Error.OutsideBounds;var c=new Buffer(b),d=this.b.slice(a,a+b);return d.copy(c,0,0,b),new z.io.Bytes(b,c)},compare:function(a){var b,c=this.b,d=a.b;b=this.length<a.length?this.length:a.length;for(var e=0;b>e;){var f=e++;if(c[f]!=d[f])return c[f]-d[f]}return this.length-a.length},getString:function(a,b){if(0>a||0>b||a+b>this.length)throw z.io.Error.OutsideBounds;for(var c="",d=this.b,e=String.fromCharCode,f=a,g=a+b;g>f;){var h=d[f++];if(128>h){if(0==h)break;c+=e(h)}else if(224>h)c+=e((63&h)<<6|127&d[f++]);else if(240>h){var i=d[f++];c+=e((31&h)<<12|(127&i)<<6|127&d[f++])}else{var j=d[f++],k=d[f++];c+=e((15&h)<<18|(127&j)<<12|k<<6&127|127&d[f++])}}return c},readString:function(a,b){return this.getString(a,b)},toString:function(){return this.getString(0,this.length)},toHex:function(){for(var a=new p,b=[],c="0123456789abcdef",d=0,e=c.length;e>d;){var f=d++;b.push(i.cca(c,f))}for(var g=0,h=this.length;h>g;){var j=g++,k=this.b[j];a.b+=String.fromCharCode(b[k>>4]),a.b+=String.fromCharCode(b[15&k])}return a.b},getData:function(){return this.b},__class__:z.io.Bytes},z.io.BytesBuffer=function(){this.b=new Array},e["haxe.io.BytesBuffer"]=z.io.BytesBuffer,z.io.BytesBuffer.__name__=["haxe","io","BytesBuffer"],z.io.BytesBuffer.prototype={get_length:function(){return this.b.length},addByte:function(a){this.b.push(a)},add:function(a){for(var b=(this.b,a.b),c=0,d=a.length;d>c;){var e=c++;this.b.push(b[e])}},addBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw z.io.Error.OutsideBounds;for(var d=(this.b,a.b),e=b,f=b+c;f>e;){var g=e++;this.b.push(d[g])}},getBytes:function(){var a=new Buffer(this.b),b=new z.io.Bytes(a.length,a);return this.b=null,b},__class__:z.io.BytesBuffer},z.io.Input=function(){},e["haxe.io.Input"]=z.io.Input,z.io.Input.__name__=["haxe","io","Input"],z.io.Input.prototype={readByte:function(){throw"Not implemented"},readBytes:function(a,b,c){var d=c,e=a.b;if(0>b||0>c||b+c>a.length)throw z.io.Error.OutsideBounds;for(;d>0;)e[b]=this.readByte(),b++,d--;return c},set_bigEndian:function(a){return this.bigEndian=a,a},read:function(a){for(var b=z.io.Bytes.alloc(a),c=0;a>0;){var d=this.readBytes(b,c,a);if(0==d)throw z.io.Error.Blocked;c+=d,a-=d}return b},readFloat:function(){var a=[];a.push(this.readByte()),a.push(this.readByte()),a.push(this.readByte()),a.push(this.readByte()),this.bigEndian||a.reverse();var b=1-(a[0]>>7<<1),c=(a[0]<<1&255|a[1]>>7)-127,d=(127&a[1])<<16|a[2]<<8|a[3];return 0==d&&-127==c?0:b*(1+Math.pow(2,-23)*d)*Math.pow(2,c)},readDouble:function(){var a=[];a.push(this.readByte()),a.push(this.readByte()),a.push(this.readByte()),a.push(this.readByte()),a.push(this.readByte()),a.push(this.readByte()),a.push(this.readByte()),a.push(this.readByte()),this.bigEndian||a.reverse();var b=1-(a[0]>>7<<1),c=(a[0]<<4&2047|a[1]>>4)-1023,d=this.getDoubleSig(a);return 0==d&&-1023==c?0:b*(1+Math.pow(2,-52)*d)*Math.pow(2,c)},readInt8:function(){var a=this.readByte();return a>=128?a-256:a},readInt16:function(){var a,b=this.readByte(),c=this.readByte();return a=this.bigEndian?c|b<<8:b|c<<8,0!=(32768&a)?a-65536:a},readUInt16:function(){var a=this.readByte(),b=this.readByte();return this.bigEndian?b|a<<8:a|b<<8},readInt32:function(){var a=this.readByte(),b=this.readByte(),c=this.readByte(),d=this.readByte();return this.bigEndian?d|c<<8|b<<16|a<<24:a|b<<8|c<<16|d<<24},getDoubleSig:function(a){return 4294967296*((15&a[1])<<16|a[2]<<8|a[3])+2147483648*(a[4]>>7)+((127&a[4])<<24|a[5]<<16|a[6]<<8|a[7])},__class__:z.io.Input},z.io.BytesInput=function(a,b,c){if(null==b&&(b=0),null==c&&(c=a.length-b),0>b||0>c||b+c>a.length)throw z.io.Error.OutsideBounds;this.b=a.b,this.pos=b,this.len=c,this.totlen=c},e["haxe.io.BytesInput"]=z.io.BytesInput,z.io.BytesInput.__name__=["haxe","io","BytesInput"],z.io.BytesInput.__super__=z.io.Input,z.io.BytesInput.prototype=b(z.io.Input.prototype,{readByte:function(){if(0==this.len)throw new z.io.Eof;return this.len--,this.b[this.pos++]},readBytes:function(a,b,c){if(0>b||0>c||b+c>a.length)throw z.io.Error.OutsideBounds;if(0==this.len&&c>0)throw new z.io.Eof;this.len<c&&(c=this.len);for(var d=this.b,e=a.b,f=0;c>f;){var g=f++;e[b+g]=d[this.pos+g]}return this.pos+=c,this.len-=c,c},__class__:z.io.BytesInput}),z.io.Output=function(){},e["haxe.io.Output"]=z.io.Output,z.io.Output.__name__=["haxe","io","Output"],z.io.Output.prototype={writeByte:function(a){throw"Not implemented"},writeBytes:function(a,b,c){var d=c,e=a.b;if(0>b||0>c||b+c>a.length)throw z.io.Error.OutsideBounds;for(;d>0;)this.writeByte(e[b]),b++,d--;return c},set_bigEndian:function(a){return this.bigEndian=a,a},write:function(a){for(var b=a.length,c=0;b>0;){var d=this.writeBytes(a,c,b);if(0==d)throw z.io.Error.Blocked;c+=d,b-=d}},writeFloat:function(a){if(0==a)return this.writeByte(0),this.writeByte(0),this.writeByte(0),void this.writeByte(0);var b,c=Math.floor(Math.log(Math.abs(a))/z.io.Output.LN2),d=8388607&Math.floor(Math.abs(a)/Math.pow(2,c)*8388608);b=c+127>>1|(c>0?0>a?128:64:0>a?128:0);var e=c+127<<7&255|d>>16&127,f=d>>8&255,g=255&d;this.bigEndian?(this.writeByte(b),this.writeByte(e),this.writeByte(f),this.writeByte(g)):(this.writeByte(g),this.writeByte(f),this.writeByte(e),this.writeByte(b))},writeDouble:function(a){if(0==a)return this.writeByte(0),this.writeByte(0),this.writeByte(0),this.writeByte(0),this.writeByte(0),this.writeByte(0),this.writeByte(0),void this.writeByte(0);var b,c=Math.floor(Math.log(Math.abs(a))/z.io.Output.LN2),d=Math.floor(Math.abs(a)/Math.pow(2,c)*Math.pow(2,52)),e=34359738367&d,f=Math.floor(d/Math.pow(2,32));b=c+1023>>4|(c>0?0>a?128:64:0>a?128:0);var g=c+1023<<4&255|f>>16&15,h=f>>8&255,i=255&f,j=e>>24&255,k=e>>16&255,l=e>>8&255,m=255&e;this.bigEndian?(this.writeByte(b),this.writeByte(g),this.writeByte(h),this.writeByte(i),this.writeByte(j),this.writeByte(k),this.writeByte(l),this.writeByte(m)):(this.writeByte(m),this.writeByte(l),this.writeByte(k),this.writeByte(j),this.writeByte(i),this.writeByte(h),this.writeByte(g),this.writeByte(b))},writeInt8:function(a){if(-128>a||a>=128)throw z.io.Error.Overflow;this.writeByte(255&a)},writeInt16:function(a){if(-32768>a||a>=32768)throw z.io.Error.Overflow;this.writeUInt16(65535&a)},writeUInt16:function(a){if(0>a||a>=65536)throw z.io.Error.Overflow;this.bigEndian?(this.writeByte(a>>8),this.writeByte(255&a)):(this.writeByte(255&a),this.writeByte(a>>8))},writeInt32:function(a){this.bigEndian?(this.writeByte(a>>>24),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)):(this.writeByte(255&a),this.writeByte(a>>8&255),this.writeByte(a>>16&255),this.writeByte(a>>>24))},__class__:z.io.Output},z.io.BytesOutput=function(){this.b=new z.io.BytesBuffer},e["haxe.io.BytesOutput"]=z.io.BytesOutput,z.io.BytesOutput.__name__=["haxe","io","BytesOutput"],z.io.BytesOutput.__super__=z.io.Output,z.io.BytesOutput.prototype=b(z.io.Output.prototype,{writeByte:function(a){this.b.b.push(a)},writeBytes:function(a,b,c){return this.b.addBytes(a,b,c),c},getBytes:function(){return this.b.getBytes()},__class__:z.io.BytesOutput}),z.io.Eof=function(){},e["haxe.io.Eof"]=z.io.Eof,z.io.Eof.__name__=["haxe","io","Eof"],z.io.Eof.prototype={toString:function(){return"Eof"},__class__:z.io.Eof},z.io.Error=e["haxe.io.Error"]={__ename__:["haxe","io","Error"],__constructs__:["Blocked","Overflow","OutsideBounds","Custom"]},z.io.Error.Blocked=["Blocked",0],z.io.Error.Blocked.toString=f,z.io.Error.Blocked.__enum__=z.io.Error,z.io.Error.Overflow=["Overflow",1],z.io.Error.Overflow.toString=f,z.io.Error.Overflow.__enum__=z.io.Error,z.io.Error.OutsideBounds=["OutsideBounds",2],z.io.Error.OutsideBounds.toString=f,z.io.Error.OutsideBounds.__enum__=z.io.Error,z.io.Error.Custom=function(a){var b=["Custom",3,a];return b.__enum__=z.io.Error,b.toString=f,b},z.rtti={},z.rtti.Meta=function(){},e["haxe.rtti.Meta"]=z.rtti.Meta,z.rtti.Meta.__name__=["haxe","rtti","Meta"],z.rtti.Meta.getFields=function(a){var b=a.__meta__;return null==b||null==b.fields?{}:b.fields},w.Boot=function(){},e["js.Boot"]=w.Boot,w.Boot.__name__=["js","Boot"],w.Boot.getClass=function(a){return a instanceof Array&&null==a.__enum__?Array:a.__class__},w.Boot.__string_rec=function(a,b){if(null==a)return"null";if(b.length>=5)return"<...>";var c=typeof a;switch("function"==c&&(a.__name__||a.__ename__)&&(c="object"),c){case"object":if(a instanceof Array){if(a.__enum__){if(2==a.length)return a[0];var d=a[0]+"(";b+="	";for(var e=2,f=a.length;f>e;){var g=e++;d+=2!=g?","+w.Boot.__string_rec(a[g],b):w.Boot.__string_rec(a[g],b)}return d+")"}var h=a.length,i="[";b+="	";for(var j=0;h>j;){var k=j++;i+=(k>0?",":"")+w.Boot.__string_rec(a[k],b)}return i+="]"}var l;try{l=a.toString}catch(m){return"???"}if(null!=l&&l!=Object.toString){var n=a.toString();if("[object Object]"!=n)return n}var o=null,p="{\n";b+="	";var q=null!=a.hasOwnProperty;for(var o in a)(!q||a.hasOwnProperty(o))&&"prototype"!=o&&"__class__"!=o&&"__super__"!=o&&"__interfaces__"!=o&&"__properties__"!=o&&(2!=p.length&&(p+=", \n"),p+=b+o+" : "+w.Boot.__string_rec(a[o],b));return b=b.substring(1),p+="\n"+b+"}";case"function":return"<function>";case"string":return a;default:return String(a)}},w.Boot.__interfLoop=function(a,b){if(null==a)return!1;if(a==b)return!0;var c=a.__interfaces__;if(null!=c)for(var d=0,e=c.length;e>d;){var f=d++,g=c[f];if(g==b||w.Boot.__interfLoop(g,b))return!0}return w.Boot.__interfLoop(a.__super__,b)},w.Boot.__instanceof=function(a,b){if(null==b)return!1;switch(b){case E:return(0|a)===a;case G:return"number"==typeof a;case H:return"boolean"==typeof a;case String:return"string"==typeof a;case Array:return a instanceof Array&&null==a.__enum__;case F:return!0;default:if(null==a)return!1;if("function"==typeof b){if(a instanceof b)return!0;if(w.Boot.__interfLoop(w.Boot.getClass(a),b))return!0}return b==I&&null!=a.__name__?!0:b==J&&null!=a.__ename__?!0:a.__enum__==b}},w.Boot.__cast=function(a,b){if(w.Boot.__instanceof(a,b))return a;throw"Cannot cast "+o.string(a)+" to "+o.string(b)},w.NodeC=function(){},e["js.NodeC"]=w.NodeC,w.NodeC.__name__=["js","NodeC"];var A={};A.Decoder=function(a,b){var c=new z.io.BytesInput(a);c.set_bigEndian(!0),this.o=this.decode(c,b)},e["msgpack.Decoder"]=A.Decoder,A.Decoder.__name__=["msgpack","Decoder"],A.Decoder.prototype={decode:function(a,b){try{var c=a.readByte();switch(c){case 192:return null;case 194:return!1;case 195:return!0;case 202:return a.readFloat();case 203:return a.readDouble();case 204:return a.readByte();case 205:return a.readUInt16();case 206:return a.readInt32();case 207:return z.Int64.make(a.readInt32(),a.readInt32());case 208:return a.readInt8();case 209:return a.readInt16();case 210:return a.readInt32();case 211:return z.Int64.make(a.readInt32(),a.readInt32());case 218:case 219:return a.read(218==c?a.readUInt16():a.readInt32()).toString();case 220:case 221:return this.readArray(a,220==c?a.readUInt16():a.readInt32(),b);case 222:case 223:return this.readMap(a,222==c?a.readUInt16():a.readInt32(),b);default:if(128>c)return c;if(144>c)return this.readMap(a,15&c,b);if(160>c)return this.readArray(a,15&c,b);if(192>c)return a.read(31&c).toString();if(c>223)return-256|c}}catch(d){if(!w.Boot.__instanceof(d,z.io.Eof))throw d}return null},readArray:function(a,b,c){for(var d=[],e=0;b>e;){e++;d.push(this.decode(a,c))}return d},readMap:function(a,b,c){if(c){for(var d={},e=0;b>e;){var f=(e++,this.decode(a,c)),g=this.decode(a,c);d[f]=g}return d}for(var h=new z.ds.ObjectMap,i=0;b>i;){var j=(i++,this.decode(a,c)),k=this.decode(a,c);h.set(j,k)}return h},getResult:function(){return this.o},__class__:A.Decoder},A.Encoder=function(a){this.o=new z.io.BytesOutput,this.o.set_bigEndian(!0),this.encode(a)},e["msgpack.Encoder"]=A.Encoder,A.Encoder.__name__=["msgpack","Encoder"],A.Encoder.prototype={encode:function(a){var b=t["typeof"](a);switch(b[1]){case 0:this.o.writeByte(192);break;case 3:this.o.writeByte(a?195:194);break;case 1:this.writeInt(a);break;case 2:this.writeFloat(a);break;case 6:var c=b[2],d=t.getClassName(c);switch(d){case"String":this.writeRaw(z.io.Bytes.ofString(a));break;case"Array":this.writeArray(a);break;case"Hash":this.writeHashMap(a);break;case"haxe.Int64":this.writeInt64(a)}break;case 4:this.writeObjectMap(a);break;case 7:throw"Error: Enum not supported";case 5:throw"Error: Function not supported";case 8:throw"Error: Unknown Data Type"}},writeInt:function(a){-32>a?-32768>a?(this.o.writeByte(210),this.o.writeInt32(a)):-128>a?(this.o.writeByte(209),this.o.writeInt16(a)):(this.o.writeByte(208),this.o.writeInt8(a)):128>a?this.o.writeByte(255&a):256>a?(this.o.writeByte(204),this.o.writeByte(a)):65536>a?(this.o.writeByte(205),this.o.writeUInt16(a)):(this.o.writeByte(206),this.o.writeInt32(a))},writeInt64:function(a){this.o.writeByte(a.high<0?211:207),this.o.writeInt32(z.Int64.getHigh(a)),this.o.writeInt32(z.Int64.getLow(a))},writeFloat:function(a){var b=Math.abs(a);b>1.401298464324817e-45&&3.4028234663852886e38>b?(this.o.writeByte(202),this.o.writeFloat(a)):(this.o.writeByte(203),this.o.writeDouble(a))},writeRaw:function(a){var b=a.length;32>b?this.o.writeByte(160|b):65536>b?(this.o.writeByte(218),this.o.writeUInt16(b)):(this.o.writeByte(219),this.o.writeInt32(b)),this.o.write(a)},writeArray:function(a){var b=a.length;16>b?this.o.writeByte(144|b):65536>b?(this.o.writeByte(220),this.o.writeUInt16(b)):(this.o.writeByte(221),this.o.writeInt32(b));for(var c=0;c<a.length;){var d=a[c];++c,this.encode(d)}},writeMapLength:function(a){16>a?this.o.writeByte(128|a):65536>a?(this.o.writeByte(222),this.o.writeUInt16(a)):(this.o.writeByte(223),this.o.writeInt32(a))},writeHashMap:function(a){this.writeMapLength(j.count(a));for(var b=a.keys();b.hasNext();){var c=b.next();this.writeRaw(z.io.Bytes.ofString(c)),this.encode(a.get(c))}},writeObjectMap:function(a){var b=n.fields(a);this.writeMapLength(j.count(b));for(var c=0;c<b.length;){var d=b[c];++c,this.writeRaw(z.io.Bytes.ofString(d)),this.encode(n.field(a,d))}},getBytes:function(){return this.o.getBytes()},__class__:A.Encoder},A.MsgPack=function(){},e["msgpack.MsgPack"]=A.MsgPack,A.MsgPack.__name__=["msgpack","MsgPack"],A.MsgPack.encode=function(a){return new A.Encoder(a).getBytes()},A.MsgPack.decode=function(a,b){return null==b&&(b=!0),new A.Decoder(a,b).getResult()},u.interfaces.IController=function(){},e["puremvc.interfaces.IController"]=u.interfaces.IController,u.interfaces.IController.__name__=["puremvc","interfaces","IController"],u.interfaces.IController.prototype={__class__:u.interfaces.IController},u.core={},u.core.Controller=function(){u.core.Controller.instance=this,this.commandMap=new z.ds.StringMap,this.initializeController()},e["puremvc.core.Controller"]=u.core.Controller,u.core.Controller.__name__=["puremvc","core","Controller"],u.core.Controller.__interfaces__=[u.interfaces.IController],u.core.Controller.getInstance=function(){return null==u.core.Controller.instance&&(u.core.Controller.instance=new u.core.Controller),u.core.Controller.instance},u.core.Controller.prototype={initializeController:function(){this.view=u.core.View.getInstance()},executeCommand:function(a){var b=this.commandMap.get(a.getName());if(null!=b){var c=t.createInstance(b,[]);c.execute(a)}},registerCommand:function(a,b){this.commandMap.exists(a)||this.view.registerObserver(a,new u.patterns.observer.Observer(d(this,this.executeCommand),this)),this.commandMap.set(a,b)},hasCommand:function(a){return this.commandMap.exists(a)},removeCommand:function(a){this.hasCommand(a)&&(this.view.removeObserver(a,this),this.commandMap.remove(a))},__class__:u.core.Controller},u.interfaces.IModel=function(){},e["puremvc.interfaces.IModel"]=u.interfaces.IModel,u.interfaces.IModel.__name__=["puremvc","interfaces","IModel"],u.interfaces.IModel.prototype={__class__:u.interfaces.IModel},u.core.Model=function(){u.core.Model.instance=this,this.proxyMap=new z.ds.StringMap,this.initializeModel()},e["puremvc.core.Model"]=u.core.Model,u.core.Model.__name__=["puremvc","core","Model"],u.core.Model.__interfaces__=[u.interfaces.IModel],u.core.Model.getInstance=function(){return null==u.core.Model.instance&&(u.core.Model.instance=new u.core.Model),u.core.Model.instance},u.core.Model.prototype={initializeModel:function(){},registerProxy:function(a){this.proxyMap.set(a.getProxyName(),a),a.onRegister()},retrieveProxy:function(a){return this.proxyMap.get(a)},hasProxy:function(a){return this.proxyMap.exists(a)},removeProxy:function(a){var b=this.proxyMap.get(a);return null!=b&&(this.proxyMap.remove(a),b.onRemove()),b},__class__:u.core.Model},u.interfaces.IView=function(){},e["puremvc.interfaces.IView"]=u.interfaces.IView,u.interfaces.IView.__name__=["puremvc","interfaces","IView"],u.interfaces.IView.prototype={__class__:u.interfaces.IView},u.core.View=function(){u.core.View.instance=this,this.mediatorMap=new z.ds.StringMap,this.observerMap=new z.ds.StringMap,this.initializeView()},e["puremvc.core.View"]=u.core.View,u.core.View.__name__=["puremvc","core","View"],u.core.View.__interfaces__=[u.interfaces.IView],u.core.View.getInstance=function(){return null==u.core.View.instance&&(u.core.View.instance=new u.core.View),u.core.View.instance},u.core.View.prototype={initializeView:function(){},registerObserver:function(a,b){this.observerMap.exists(a)||this.observerMap.set(a,new k),this.observerMap.get(a).add(b)},notifyObservers:function(a){if(this.observerMap.exists(a.getName())){for(var b=this.observerMap.get(a.getName()),c=new k,d=b.iterator();d.hasNext();){var e=d.next();c.add(e)}for(var f=c.iterator();f.hasNext();){var g=f.next();g.notifyObserver(a)}}},removeObserver:function(a,b){for(var c=this.observerMap.get(a),d=c.iterator();d.hasNext();){var e=d.next();if(1==e.compareNotifyContext(b)){c.remove(e);break}}c.isEmpty()&&this.observerMap.remove(a)},registerMediator:function(a){if(!this.mediatorMap.exists(a.getMediatorName())){this.mediatorMap.set(a.getMediatorName(),a);var b=a.listNotificationInterests();if(b.length>0)for(var c=new u.patterns.observer.Observer(d(a,a.handleNotification),a),e=0,f=b.length;f>e;){var g=e++;this.registerObserver(b[g],c)}a.onRegister()}},retrieveMediator:function(a){return this.mediatorMap.get(a)},removeMediator:function(a){var b=this.mediatorMap.get(a);if(null!=b){for(var c=b.listNotificationInterests(),d=0,e=c.length;e>d;){var f=d++;this.removeObserver(c[f],b)}this.mediatorMap.remove(a),b.onRemove()}return b},hasMediator:function(a){return this.mediatorMap.exists(a)},__class__:u.core.View},u.interfaces.INotification=function(){},e["puremvc.interfaces.INotification"]=u.interfaces.INotification,u.interfaces.INotification.__name__=["puremvc","interfaces","INotification"],u.interfaces.INotification.prototype={__class__:u.interfaces.INotification},u.interfaces.IObserver=function(){},e["puremvc.interfaces.IObserver"]=u.interfaces.IObserver,u.interfaces.IObserver.__name__=["puremvc","interfaces","IObserver"],u.interfaces.IObserver.prototype={__class__:u.interfaces.IObserver},u.patterns.observer.Notification=function(a,b,c){this.name=a,null!=b&&(this.body=b),null!=c&&(this.type=c)},e["puremvc.patterns.observer.Notification"]=u.patterns.observer.Notification,u.patterns.observer.Notification.__name__=["puremvc","patterns","observer","Notification"],u.patterns.observer.Notification.__interfaces__=[u.interfaces.INotification],u.patterns.observer.Notification.prototype={getName:function(){return this.name},setBody:function(a){this.body=a},getBody:function(){return this.body},setType:function(a){this.type=a},getType:function(){return this.type},toString:function(){var a="Notification Name: "+this.getName();return a+="\nBody:"+(null==this.body?"null":this.body.toString()),a+="\nType:"+(null==this.type?"null":this.type)},__class__:u.patterns.observer.Notification},u.patterns.observer.Observer=function(a,b){this.setNotifyMethod(a),this.setNotifyContext(b)},e["puremvc.patterns.observer.Observer"]=u.patterns.observer.Observer,u.patterns.observer.Observer.__name__=["puremvc","patterns","observer","Observer"],u.patterns.observer.Observer.__interfaces__=[u.interfaces.IObserver],
u.patterns.observer.Observer.prototype={setNotifyMethod:function(a){this.notify=a},setNotifyContext:function(a){this.context=a},getNotifyMethod:function(){return this.notify},getNotifyContext:function(){return this.context},notifyObserver:function(a){this.getNotifyMethod()(a)},compareNotifyContext:function(a){return a==this.context},__class__:u.patterns.observer.Observer};var B=0,C={},D=require("events").EventEmitter;Array.prototype.indexOf&&(i.indexOf=function(a,b,c){return Array.prototype.indexOf.call(a,b,c)}),Math.NaN=Number.NaN,Math.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,Math.POSITIVE_INFINITY=Number.POSITIVE_INFINITY,e.Math=Math,Math.isFinite=function(a){return isFinite(a)},Math.isNaN=function(a){return isNaN(a)},String.prototype.__class__=e.String=String,String.__name__=["String"],e.Array=Array,Array.__name__=["Array"],Date.prototype.__class__=e.Date=Date,Date.__name__=["Date"];var E=e.Int={__name__:["Int"]},F=e.Dynamic={__name__:["Dynamic"]},G=e.Float=Number;G.__name__=["Float"];var H=e.Bool=Boolean;H.__ename__=["Bool"];var I=e.Class={__name__:["Class"]},J={};null==Array.prototype.map&&(Array.prototype.map=function(a){for(var b=[],c=0,d=this.length;d>c;){var e=c++;b[e]=a(this[e])}return b}),null==Array.prototype.filter&&(Array.prototype.filter=function(a){for(var b=[],c=0,d=this.length;d>c;){var e=c++,f=this[e];a(f)&&b.push(f)}return b});(function(a){function b(a){var b="POST",c=a.url,d=a.headers,e=a.data,f=a.files,g=a.complete,h=new FormData;for(var i in e)e.hasOwnProperty(i)&&h.append(i,e[i]);for(var i in f)f.hasOwnProperty(i)&&h.append(i,f[i]);var j=new XMLHttpRequest;j.open(b,c,!0);for(var i in d)d.hasOwnProperty(i)&&j.setRequestHeader(i,d[i]);return j.onload=function(a){4===j.readyState&&g(200===j.status,j)},j.onerror=function(a){g(!1,j)},j.send(h),j}return a.exports=null,a.exports={upload:b},a.exports})({});v.AppFacade.APP_STATE_CHANGED="app_state_changed",v.AppFacade.ACCESS_TOKEN_CHANGED="access_token_changed",v.AppFacade.CURRENT_USER_CHANGED="current_user_changed",v.AppFacade.CONFIGURATION_CHANGED="configuration_changed",v.AppFacade.DOMAIN_SELECTION_CHANGED="domain_selection_changed",v.AppFacade.TALK_SELECTION_CHANGED="talk_selection_changed",v.AppFacade.TALK_LIST_SCROLL_TO_TALK_TOP_NEEDED="talk_list_scroll_to_talk_top_needed",v.AppFacade.USER_SELECTION_NEEDED="user_selection_needed",v.AppFacade.USER_SELECTION_CHANGED="user_selection_changed",v.AppFacade.FRIEND_SELECTION_NEEDED="friend_selection_needed",v.AppFacade.STAMP_SET_CHANGED="stamp_set_changed",v.AppFacade.STAMP_SELECTION_CHANGED="stamp_selection_changed",v.AppFacade.PHONE_CALL_STARTED="phone_call_started",v.AppFacade.PHONE_CALL_ACCEPTED="phone_call_accepted",v.AppFacade.PHONE_CALL_CONNECTED="phone_call_connected",v.AppFacade.PHONE_CALL_HANGED_UP="phone_call_hangued_up",v.AppFacade.ACTION_SELECTION_CHANGED="action_selection_changed",v.AppFacade.CURRENT_PAGE_CHANGED="current_page_changed",v.AppFacade.CURRENT_PAGE_NOT_CHANGED="current_page_not_changed",v.AppFacade.FILEINFO_SELECTION_CHANGED="fileinfo_selection_changed",v.AppFacade.MESSAGE_FILEINFO_SELECTION_CHANGED="message_fileinfo_selection_changed",v.AppFacade.STAGED_FILEINFO_SELECTION_CHANGED="staged_fileinfo_selection_changed",v.AppFacade.ERROR_OCCURRED="error_occurred",v.AppFacade.UNREAD_COUNT_CHANGED="brand_badge_changed",v.AppFacade.SEND_FORM_TOP_CHANGED="send_form_top_changed",v.AppFacade.SOLUTIONS_LOADED="solutions_loaded",v.AppFacade.RIGHT_PANE_OPEN="right_pane_open",v.AppFacade.RIGHT_PANE_CLOSE="right_pane_close",v.AppFacade.RIGHT_PANE_OPENED="right_pane_opened",v.AppFacade.RIGHT_PANE_CLOSED="right_pane_closed",v.AppFacade.PASSWORD_EXPIRATION_OVERED="password_expiration_overed",v.AppFacade.PASSWORD_EXPIRATION_WARNED="password_expiration_warned",v.AppFacade.PHOTO_EDITOR_SAVED="photo_editor_saved",v.AppFacade.MC_AUTHENTICATED_USER_RECEIVED="mc_authenticated_user_received",v.AppFacade.DATA_RECOVERED="data_recovered",v.AppFacade.NOTIFY_UPDATE_USER="notify_update_user",v.AppFacade.NOTIFY_ADD_FRIEND="notify_add_friend",v.AppFacade.NOTIFY_ADD_ACQUAINTANCE="notify_add_acquaintance",v.AppFacade.NOTIFY_DELETE_FRIEND="notify_delete_friend",v.AppFacade.NOTIFY_DELETE_ACQUAINTANCE="notify_delete_acquaintance",v.AppFacade.NOTIFY_UPDATE_DOMAIN_USERS="notify_update_domain_users",v.AppFacade.GET_DOMAIN_USERS_RESPONSED="get_domain_users_responsed",v.AppFacade.GET_USERS_RESPONSED="get_users_responsed",v.AppFacade.GET_PROFILE_RESPONSED="get_profile_responsed",v.AppFacade.UPDATE_USER_RESPONSED="update_user_responsed",v.AppFacade.UPDATE_PROFILE_RESPONSED="update_profile_responsed",v.AppFacade.NOTIFY_ADD_DOMAIN_INVITE="notify_add_domain_invite",v.AppFacade.NOTIFY_ACCEPT_DOMAIN_INVITE="notify_accept_domain_invite",v.AppFacade.NOTIFY_DELETE_DOMAIN_INVITE="notify_delete_domain_invite",v.AppFacade.NOTIFY_JOIN_DOMAIN="notify_join_domain",v.AppFacade.NOTIFY_UPDATE_DOMAIN="notify_update_domain",v.AppFacade.NOTIFY_LEAVE_DOMAIN="notify_leave_domain",v.AppFacade.NOTIFY_CREATE_PAIR_TALK="notify_create_pair_talk",v.AppFacade.NOTIFY_CREATE_GROUP_TALK="notify_create_group_talk",v.AppFacade.NOTIFY_UPDATE_GROUP_TALK="notify_update_group_talk",v.AppFacade.NOTIFY_ADD_TALKERS="notify_add_talkers",v.AppFacade.NOTIFY_DELETE_TALKER="notify_delete_talker",v.AppFacade.NOTIFY_ADD_TALK_INVITE="notify_add_talk_invite",v.AppFacade.NOTIFY_ACCEPT_TALK_INVITE="notify_accept_talk_invite",v.AppFacade.NOTIFY_DELETE_TALK_INVITE="notify_delete_talk_invite",v.AppFacade.NOTIFY_DELETE_TALK="notify_delete_talk",v.AppFacade.NOTIFY_CREATE_MESSAGE="notify_create_message",v.AppFacade.NOTIFY_UPDATE_READ_STATUSES="notify_update_read_statuses",v.AppFacade.NOTIFY_UPDATE_TALK_STATUS="notify_update_talk_status",v.AppFacade.NOTIFY_UPDATE_LOCAL_TALK_STATUS="notify_update_local_talk_status",v.AppFacade.NOTIFY_GET_MESSAGES="notify_get_messages",v.AppFacade.NOTIFY_GET_MESSAGE_READ_STATUS="notify_get_message_status",v.AppFacade.CREATE_MESSAGE_START="create_message_start",v.AppFacade.CREATE_MESSAGE_COMPLETE="create_message_complete",v.AppFacade.CREATE_MESSAGE_FAIL="create_message_fail",v.AppFacade.NOTIFY_CREATE_ANNOUNCEMENT="notify_create_announcement",v.AppFacade.NOTIFY_UPDATE_ANNOUNCEMENT_STATUS="notify_update_announcement_status",v.AppFacade.NOTIFY_GET_ANNOUNCEMENTS="notify_get_announcements",v.AppFacade.CREATE_ANNOUNCEMENT_START="create_announcement_start",v.AppFacade.CREATE_ANNOUNCEMENT_COMPLETE="create_announcement_complete",v.AppFacade.CREATE_ANNOUNCEMENT_FAIL="create_announcement_fail",v.AppFacade.NOTIFY_UPDATE_QUESTION="notify_update_question",v.AppFacade.NOTIFY_GET_QUESTIONS="get_questions_responsed",v.AppFacade.NOTIFY_CREATE_ATTACHMENT="notify_create_attachment",v.AppFacade.NOTIFY_DELETE_ATTACHMENT="notify_delete_attachment",v.AppFacade.GET_FILE_RESPONSED="get_file_responsed",v.AppFacade.NOTIFY_SEARCH_MESSAGES="notify_search_messages",v.AppFacade.NOTIFY_SEARCH_ATTACHMENTS="notify_search_attachments",v.AppFacade.NOTIFY_SEARCH_MESSAGES_FAIL="notify_search_messages_fail",v.AppFacade.NOTIFY_SEARCH_ATTACHMENTS_FAIL="notify_search_attachments_fail",v.AppFacade.NOTIFY_SEARCH_PREPARE="notify_search_prepare",v.AppFacade.NOTIFY_SEARCH_CLEAR="notify_search_clear",v.AppFacade.NOTIFY_SEARCH_BOX_TEXT_CHANGED="notify_search_box_text_changed",v.AppFacade.NOTIFY_SEARCH_BOX_POPUP="notify_search_box_popup",v.AppFacade.NOTIFY_ADD_ACCOUNT_CONTROL_REQUEST="notify_add_account_control_request",v.AppFacade.NOTIFY_DELETE_ACCOUNT_CONTROL_REQUEST="notify_delete_account_control_request",v.AppFacade.NOTIFY_JOIN_ACCOUNT_CONTROL_GROUP="notify_join_account_control_group",v.AppFacade.NOTIFY_UPDATE_ACCOUNT_CONTROL_GROUP="notify_update_account_control_group",v.AppFacade.NOTIFY_LEAVE_ACCOUNT_CONTROL_GROUP="notify_leave_account_control_group",v.command.AccountControlRequestCommand.__meta__={fields:{api:{inject:null}}},v.command.AccountControlRequestCommand.NAME="AccountControlRequest",v.command.DeviceCommand.__meta__={fields:{api:{inject:null}}},v.command.DeviceCommand.NAME="Device",v.command.DomainCommand.__meta__={fields:{api:{inject:null}}},v.command.DomainCommand.NAME="Domain",v.command.FileCommand.__meta__={fields:{api:{inject:null},dataStore:{inject:null},fileService:{inject:null}}},v.command.FileCommand.NAME="File",v.command.LoadSolutionsCommand.__meta__={fields:{settings:{inject:null}}},v.command.LoadSolutionsCommand.NAME="LoadSolutions",v.command.LoadStampSetCommand.NAME="LoadStampSet",v.command.LoadStampSetCommand.TAB_URL="./json/app_ja.json",v.command.LoadStampSetCommand.TAB_PANE_URL="./json/illust_category_ja.json",v.command.ManageFriendsCommand.__meta__={fields:{api:{inject:null}}},v.command.ManageFriendsCommand.NAME="ManageFriends",v.command.ReadCommand.__meta__={fields:{api:{inject:null}}},v.command.ReadCommand.NAME="Read",v.command.ReloadDataCommand.__meta__={fields:{api:{inject:null}}},v.command.ReloadDataCommand.NAME="ReloadData",v.command.SearchCommand.__meta__={fields:{api:{inject:null},searchService:{inject:null}}},v.command.SearchCommand.NAME="Search",v.command.SelectTalkCommand.__meta__={fields:{dataStore:{inject:null},settings:{inject:null}}},v.command.SelectTalkCommand.NAME="SelectTalk",v.command.SendCommand.__meta__={fields:{api:{inject:null}}},v.command.SendCommand.NAME="Send",v.command.SignInCommand.__meta__={fields:{api:{inject:null},settings:{inject:null},accountLoader:{inject:null}}},v.command.SignInCommand.NAME="SignIn",v.command.SignOutCommand.__meta__={fields:{api:{inject:null},settings:{inject:null},dataStore:{inject:null}}},v.command.SignOutCommand.NAME="SignOut",v.command.TalkCommand.__meta__={fields:{api:{inject:null},dataStore:{inject:null}}},v.command.TalkCommand.NAME="Talk",v.command.UpdateProfileCommand.__meta__={fields:{api:{inject:null},dataStore:{inject:null}}},v.command.UpdateProfileCommand.NAME="UpdateProfile",v.command.UpdateUserCommand.__meta__={fields:{api:{inject:null}}},v.command.UpdateUserCommand.NAME="UpdateUser",v.command.UrlCommand.__meta__={fields:{routing:{inject:null}}},v.command.UrlCommand.NAME="Url",v.entity.Message.SORT_ORDER_ASC=1,v.entity.Message.SORT_ORDER_DESC=2,v.entity.Message.MAX_READ_USER_IDS_COUNT=16,v.entity.SearchParams.TEXT_DATE_NONE="指定なし",v.entity.SearchParams.TEXT_DATE_TODAY="今日",v.entity.SearchParams.TEXT_DATE_YESTERDAY="昨日",v.entity.SearchParams.TEXT_DATE_THREE_DAYS_BEFORE="3日前",v.entity.SearchParams.TEXT_DATE_CALENDER="カレンダー",v.entity.SearchParams.QUERY_DATE_TODAY="t",v.entity.SearchParams.QUERY_DATE_YESTERDAY="-1d",v.entity.SearchParams.QUERY_DATE_THREE_DAYS_BEFORE="-3d",v.entity.SearchParams.TEXT_TYPE_MESSAGES="メッセージ",v.entity.SearchParams.TEXT_TYPE_ATTACHMENTS="ファイル",w.Node.console=console,w.Node.process=process,w.Node.require=require,w.Node.setTimeout=setTimeout,w.Node.clearTimeout=clearTimeout,w.Node.setInterval=setInterval,w.Node.clearInterval=clearInterval,w.Node.setImmediate=function(a){var b,c=i.substr(w.Node.process.version,1,null).split(".").map(o.parseInt);return b=c[0]>0||c[1]>=9?w.Node.isNodeWebkit()?global.setImmediate:setImmediate:null}(this),w.Node.clearImmediate=function(a){var b,c=i.substr(w.Node.process.version,1,null).split(".").map(o.parseInt);return b=c[0]>0||c[1]>=9?w.Node.isNodeWebkit()?global.clearImmediate:clearImmediate:null}(this),w.Node.global=global,w.Node.module=w.Node.isNodeWebkit()?global.module:module,w.Node.stringify=JSON.stringify,w.Node.parse=JSON.parse,x.EMERGENCY=0,x.ALERT=1,x.CRITICAL=2,x.ERROR=3,x.WARNING=4,x.NOTICE=5,x.INFO=6,x.DEBUG=7,x.level=x.getLogLevel(w.Node.process.env.HUBOT_LOG_LEVEL),x._d=7<=x.level&&null!=console?console.log.bind(console):x._nop,x._i=6<=x.level&&null!=console?console.info.bind(console):x._nop,x._w=4<=x.level&&null!=console?console.warn.bind(console):x._nop,x._e=3<=x.level&&null!=console?console.error.bind(console):x._nop,v.js.TextCanonicalizer.HIRAGANA_SMALL_A=12353,v.js.TextCanonicalizer.HIRAGANA_NN=12435,v.js.TextCanonicalizer.KATAKANA_SMALL_A=12449,v.proxy.AccountLoaderProxyFactory.NAME="accountLoader",u.patterns.proxy.Proxy.NAME="Proxy",v.proxy.AlberoBroadcastProxy.__meta__={fields:{api:{inject:null},dataStore:{inject:null},settings:{inject:null}}},v.proxy.AlberoBroadcastProxy.NAME="broadcast",v.proxy.AlberoServiceProxy.__meta__={fields:{rpc:{inject:null},settings:{inject:null},dataStore:{inject:null},fileService:{inject:null},searchService:{inject:null}}},v.proxy.AlberoServiceProxy.NAME="api",v.proxy.AlberoServiceProxy.API_VERSION="1.76",v.proxy.AlberoServiceProxy.DELAY_FOR_DB_REPLICATION=1e3,v.proxy.AlberoServiceProxy.API_TRY_COUNT=3,v.proxy.AppStateProxy.NAME="appState",v.proxy.DataStoreProxy.NAME="dataStore",v.proxy.DataStoreProxy.TYPE_FRIEND=0,v.proxy.DataStoreProxy.TYPE_ACQUAINSTANCE=1,v.proxy.DataStoreProxy.TYPE_NONE=2,v.proxy.FileServiceProxy.__meta__={fields:{settings:{inject:null}}},v.proxy.FileServiceProxy.NAME="fileService",v.proxy.FileServiceProxy.THUMBNAIL_WIDTH=300,v.proxy.FileServiceProxy.THUMBNAIL_HEIGHT=300,v.proxy.FormatterProxy.__meta__={fields:{dataStore:{inject:null},fileService:{inject:null},settings:{inject:null}}},v.proxy.FormatterProxy.NAME="formatter",v.proxy.MsgPackRpcProxy.__meta__={fields:{broadcast:{inject:null}}},v.proxy.MsgPackRpcProxy.NAME="rpc",v.proxy.MsgPackRpcProxy.lastMsgId=0,v.proxy._MsgPackRpcProxy.ConnectionKeeper.PING_INTERVAL_ON_CONNECTED=45e3,v.proxy.RoutingProxy.__meta__={fields:{settings:{inject:null},dataStore:{inject:null}}},v.proxy.RoutingProxy.NAME="routing",v.proxy.SearchServiceProxy.__meta__={fields:{settings:{inject:null}}},v.proxy.SearchServiceProxy.NAME="searchService",v.proxy.SearchServiceProxy.LOAD_SIZE=20,v.proxy.SearchServiceProxy.DUMMY_VALUE_FOR_SET=1,v.proxy.SettingsProxy.NAME="settings",v.proxy.SettingsProxy.KEY_ACCESS_TOKEN="access_token",v.proxy.SettingsProxy.KEY_ACCESS_TOKEN_WITHOUT_MANAGEMENT_CONSOLE="access_token_without_management_console",v.proxy.SettingsProxy.KEY_SELECTED_DOMAIN_ID_H="selected_domain_id_h",v.proxy.SettingsProxy.KEY_SELECTED_DOMAIN_ID_L="selected_domain_id_l",v.proxy.SettingsProxy.COOKIE_KEY_SEND_BY_ENTER="send-by-enter",v.proxy.SettingsProxy.COOKIE_EXPIRES_SEND_BY_ENTER=31536e3,v.proxy.SettingsProxy.KEY_SELECTED_STAMP_TAB_ID="selected_stamp_tab_id",v.proxy.SettingsProxy.KEY_INPUT_TEXT="input_text",v.proxy.SettingsProxy.KEY_COPY_PROFILE_TO_ALL_DOMAINS="copy_profile_to_all_domains",v.proxy.SettingsProxy.KEY_SEARCH_HISTORIES="search_histories",v.proxy.SettingsProxy.KEY_RIGHT_PANEL_OPENED="right_panel_opened",v.proxy.SettingsProxy.KEY_PASSWORD_WARNING_SKIP_UNTIL="password_warning_skip_until",v.proxy.SettingsProxy.KEY_IDFV="idfv",v.proxy.BrowserSettings.NAME="browser_settings",v.proxy.StagedFileInfoStoreProxy.__meta__={fields:{fileService:{inject:null}}},v.proxy.StagedFileInfoStoreProxy.NAME="stagedFileInfoStore",u.patterns.mediator.Mediator.NAME="Mediator",y.mediator.CommandLineMediator.__meta__={fields:{dataStore:{inject:null},api:{inject:null},hubotObject:{inject:null},messageEvent:{inject:null},sendQueue:{inject:null}}},y.mediator.CommandLineMediator.NAME="commandline",y.mediator.CommandLineMediator.DATA_SAVE_SPAN=5e3,y.proxy.HubotObjectProxy.__meta__={fields:{dataStore:{inject:null}}},y.proxy.HubotObjectProxy.NAME="hubotObject",y.proxy.MessageEventProxy.__meta__={fields:{dataStore:{inject:null},hubotObject:{inject:null}}},y.proxy.MessageEventProxy.NAME="messageEvent",y.proxy.Emitter.minWaitMinute=1,y.proxy.Emitter.maxWaitMinute=1440,y.proxy.SendQueueProxy.__meta__={fields:{messageEvent:{inject:null}}},y.proxy.SendQueueProxy.NAME="sendQueue",y.proxy.SendQueueProxy.MIN_SEND_SPAN_MESSAGE=550,y.proxy.SendQueueProxy.MIN_SEND_SPAN_ANNOUNCE=5050,y.proxy.SendQueueProxy.MAX_TEXT_LENGTH=1024,y.proxy.SendQueueProxy.MAX_FIELD_COUNT=9,y.proxy.SendQueueProxy.MAX_FIELD_LENGTH=64,z.Serializer.USE_CACHE=!1,z.Serializer.USE_ENUM_INDEX=!1,z.Serializer.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",z.Unserializer.DEFAULT_RESOLVER=t,z.Unserializer.BASE64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789%:",z.ds.ObjectMap.count=0,z.io.Output.LN2=Math.log(2),w.NodeC.UTF8="utf8",w.NodeC.ASCII="ascii",w.NodeC.BINARY="binary",w.NodeC.BASE64="base64",w.NodeC.HEX="hex",w.NodeC.EVENT_EVENTEMITTER_NEWLISTENER="newListener",w.NodeC.EVENT_EVENTEMITTER_ERROR="error",w.NodeC.EVENT_STREAM_DATA="data",w.NodeC.EVENT_STREAM_END="end",w.NodeC.EVENT_STREAM_ERROR="error",w.NodeC.EVENT_STREAM_CLOSE="close",w.NodeC.EVENT_STREAM_DRAIN="drain",w.NodeC.EVENT_STREAM_CONNECT="connect",w.NodeC.EVENT_STREAM_SECURE="secure",w.NodeC.EVENT_STREAM_TIMEOUT="timeout",w.NodeC.EVENT_STREAM_PIPE="pipe",w.NodeC.EVENT_PROCESS_EXIT="exit",w.NodeC.EVENT_PROCESS_UNCAUGHTEXCEPTION="uncaughtException",w.NodeC.EVENT_PROCESS_SIGINT="SIGINT",w.NodeC.EVENT_PROCESS_SIGUSR1="SIGUSR1",w.NodeC.EVENT_CHILDPROCESS_EXIT="exit",w.NodeC.EVENT_HTTPSERVER_REQUEST="request",w.NodeC.EVENT_HTTPSERVER_CONNECTION="connection",w.NodeC.EVENT_HTTPSERVER_CLOSE="close",w.NodeC.EVENT_HTTPSERVER_UPGRADE="upgrade",w.NodeC.EVENT_HTTPSERVER_CLIENTERROR="clientError",w.NodeC.EVENT_HTTPSERVERREQUEST_DATA="data",w.NodeC.EVENT_HTTPSERVERREQUEST_END="end",w.NodeC.EVENT_CLIENTREQUEST_RESPONSE="response",w.NodeC.EVENT_CLIENTRESPONSE_DATA="data",w.NodeC.EVENT_CLIENTRESPONSE_END="end",w.NodeC.EVENT_NETSERVER_CONNECTION="connection",w.NodeC.EVENT_NETSERVER_CLOSE="close",w.NodeC.FILE_READ="r",w.NodeC.FILE_READ_APPEND="r+",w.NodeC.FILE_WRITE="w",w.NodeC.FILE_WRITE_APPEND="a+",w.NodeC.FILE_READWRITE="a",w.NodeC.FILE_READWRITE_APPEND="a+",A.Encoder.FLOAT_SINGLE_MIN=1.401298464324817e-45,A.Encoder.FLOAT_SINGLE_MAX=3.4028234663852886e38,A.Encoder.FLOAT_DOUBLE_MIN=5e-324,A.Encoder.FLOAT_DOUBLE_MAX=1.7976931348623157e308,g.main()}("undefined"!=typeof window?window:exports);